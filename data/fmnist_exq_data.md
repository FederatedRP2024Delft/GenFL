# with pretraining

# federated baseline IID with pre-training
Train losses per communication round:  [1.2236191836202286, 0.8974782796433338, 0.7910321411516892, 0.7388720633274705, 0.7104742358245792, 0.6888851547624761, 0.6700204616776232, 0.6629061050095855, 0.6515923936911941, 0.6394809122357142]
Test losses per communication round:  [9.370837700366973, 7.838391172885895, 7.162551289796829, 6.761318933963776, 6.529444992542267, 6.3387318551540375, 6.21994309425354, 6.127263331413269, 6.0132170855999, 5.952252417802811]
Test weighted accuracies per communication round:  [0.7200185185185185, 0.7409074074074075, 0.7527407407407408, 0.7612037037037038, 0.7661111111111112, 0.7710000000000001, 0.7741481481481483, 0.7771111111111112, 0.7804074074074074, 0.7805740740740741]
Test losses per communication round for each client:  [[9.43113065 7.85219431 7.24261045 6.85084653 6.58388102 6.36845636
  6.30739826 6.25761724 6.05008477 6.08590269]
 [9.06063205 7.67184186 6.98127133 6.59867299 6.43864566 6.16618913
  6.18021911 5.98603153 5.83432084 5.88033265]
 [9.39092189 7.85583717 7.28780174 6.82785988 6.5533632  6.43462902
  6.16509795 6.18063796 6.13008308 6.1026687 ]
 [9.04070216 7.57002193 6.80027646 6.43675059 6.28194219 6.09433693
  5.97338551 5.8691563  5.73903066 5.70761383]
 [9.60019934 8.04123724 7.41046703 6.94246447 6.65778446 6.51634771
  6.33653486 6.24882329 6.22971201 6.08556694]
 [9.03471804 7.65804303 6.96658003 6.69058549 6.33803642 6.25244468
  6.06745064 5.9965741  5.859851   5.86759889]
 [9.57783067 8.07837522 7.35482419 6.82902175 6.62947381 6.37319785
  6.36439961 6.24476737 6.06594473 5.90051627]
 [9.63898402 7.79770154 7.26443726 6.85305363 6.66708231 6.37976497
  6.32550079 6.16521734 6.06373346 6.01882142]
 [9.34282452 7.8995375  7.13910747 6.80525172 6.5927214  6.382348
  6.14824843 6.15357274 6.04447854 5.89481968]
 [9.59043366 7.95912194 7.17813694 6.77868229 6.55151945 6.41960388
  6.33119577 6.17023546 6.11493176 5.97868311]]
Test accuracies per communication round for each client:  [[0.71907407 0.74518519 0.75259259 0.75981481 0.76351852 0.77074074
  0.77203704 0.77314815 0.77944444 0.77944444]
 [0.72277778 0.73851852 0.75777778 0.77       0.77259259 0.77907407
  0.77907407 0.78685185 0.79092593 0.78703704]
 [0.72425926 0.74555556 0.75111111 0.76444444 0.76833333 0.77203704
  0.78055556 0.78166667 0.77981481 0.7787037 ]
 [0.72259259 0.74555556 0.76240741 0.77388889 0.77314815 0.77814815
  0.78296296 0.78574074 0.79148148 0.7912963 ]
 [0.71574074 0.73185185 0.74240741 0.75407407 0.76074074 0.76185185
  0.76481481 0.76833333 0.7712963  0.77185185]
 [0.73185185 0.74722222 0.7612963  0.76277778 0.77166667 0.77203704
  0.78148148 0.77981481 0.78444444 0.78481481]
 [0.71444444 0.73       0.74166667 0.7512963  0.75740741 0.76833333
  0.76425926 0.76814815 0.77296296 0.77685185]
 [0.71481481 0.74648148 0.75111111 0.75888889 0.76111111 0.77
  0.76944444 0.77777778 0.7762963  0.77722222]
 [0.72666667 0.74537037 0.75944444 0.76333333 0.77074074 0.77111111
  0.78018519 0.78018519 0.78240741 0.78222222]
 [0.70796296 0.73333333 0.74759259 0.75351852 0.76185185 0.76666667
  0.76666667 0.76944444 0.775      0.7762963 ]]


Train losses per communication round:  [1.1879652275158281, 0.8814534620244123, 0.7812920313174202, 0.735098255835694, 0.7041681056412367, 0.6867579263122476, 0.6711430022702415, 0.6615388223008644, 0.6498091392748102, 0.6387715390359862]
Test losses per communication round:  [9.016947412490845, 7.63865247964859, 7.066434997320175, 6.727288615703583, 6.479979741573334, 6.326952546834946, 6.182339602708817, 6.126992428302765, 6.028291541337967, 5.956145024299621]
Test weighted accuracies per communication round:  [0.7286111111111111, 0.7477037037037038, 0.7560000000000001, 0.7615370370370371, 0.7675185185185186, 0.769462962962963, 0.7744814814814815, 0.7751666666666667, 0.7785185185185186, 0.7814074074074074]
Test losses per communication round for each client:  [[8.86409384 7.57487941 6.99732065 6.6370517  6.44082856 6.29830158
  6.08692753 6.09659404 5.98561382 5.89873677]
 [8.84986109 7.49593872 6.88814116 6.7105934  6.46089607 6.26574898
  6.15367955 6.08243209 5.93713158 5.89098436]
 [9.11628395 7.68526709 7.18190992 6.74070066 6.49563313 6.40391731
  6.19322735 6.12596512 6.06389439 6.00900421]
 [9.06006491 7.67281133 7.09124327 6.73332262 6.3918913  6.33539188
  6.15401822 6.0994392  6.01544279 5.9211452 ]
 [8.71227503 7.31472707 6.88355201 6.52098864 6.36209184 6.16075623
  5.96638173 5.96819812 5.91755396 5.73254466]
 [9.0677461  7.65243572 6.9469341  6.63468564 6.37781644 6.22147
  6.10121018 6.05053729 5.9655782  5.81339321]
 [9.09919095 7.65894556 7.1243068  6.73964489 6.46435547 6.40595305
  6.24305874 6.13481653 6.10750228 6.06583083]
 [9.17731267 7.81921959 7.22662252 6.95443588 6.67851925 6.46712518
  6.38462621 6.28223687 6.15636194 6.12981534]
 [8.73706621 7.42538404 6.92631072 6.58015251 6.36536294 6.14637852
  6.06652862 6.06363535 5.85366404 5.91523707]
 [9.48557937 8.08691627 7.39800882 7.02131021 6.76240242 6.56448275
  6.4737379  6.36606967 6.28017241 6.1847586 ]]
Test accuracies per communication round for each client:  [[0.72851852 0.74314815 0.75111111 0.76018519 0.76351852 0.76703704
  0.77314815 0.77055556 0.77259259 0.78      ]
 [0.73111111 0.75018519 0.76166667 0.76296296 0.77092593 0.77333333
  0.77574074 0.77685185 0.77962963 0.78074074]
 [0.72611111 0.74962963 0.75462963 0.76462963 0.77185185 0.77333333
  0.78240741 0.78166667 0.78574074 0.79111111]
 [0.72814815 0.74648148 0.75203704 0.75685185 0.76666667 0.76074074
  0.77018519 0.77333333 0.7762963  0.77703704]
 [0.73685185 0.75740741 0.76611111 0.775      0.7787037  0.78296296
  0.78703704 0.78851852 0.78944444 0.79518519]
 [0.72037037 0.74277778 0.755      0.76111111 0.76611111 0.77166667
  0.77388889 0.77518519 0.77962963 0.78444444]
 [0.72462963 0.74796296 0.75685185 0.75981481 0.76796296 0.76333333
  0.76981481 0.77296296 0.77481481 0.77537037]
 [0.72833333 0.74074074 0.74537037 0.74851852 0.75462963 0.75703704
  0.76203704 0.76462963 0.76685185 0.7687037 ]
 [0.7362963  0.7587037  0.76703704 0.77444444 0.7762963  0.77851852
  0.78240741 0.78055556 0.79055556 0.7862963 ]
 [0.72574074 0.74       0.75018519 0.75185185 0.75851852 0.76666667
  0.76814815 0.76740741 0.76962963 0.77518519]]


Train losses per communication round:  [1.233078696459708, 0.8913879673112426, 0.787007845448848, 0.737780136257939, 0.7056365801385168, 0.6854480511205788, 0.6732279813016306, 0.6598526725402245, 0.6478751707050574, 0.6419875876967018]
Test losses per communication round:  [9.308971571922303, 7.754143565893173, 7.109943425655365, 6.71695573925972, 6.481470701098442, 6.330201071500778, 6.21105347275734, 6.088300681114196, 6.006514254212379, 5.96426807641983]
Test weighted accuracies per communication round:  [0.7154259259259259, 0.7402407407407408, 0.7528888888888889, 0.7608703703703704, 0.7664814814814815, 0.7691481481481482, 0.7719629629629631, 0.7756666666666667, 0.7780555555555556, 0.7790370370370371]
Test losses per communication round for each client:  [[9.45599759 7.73046213 7.14469045 6.73267639 6.54777467 6.31958348
  6.29720974 6.09536892 6.04812831 6.03899109]
 [9.44394201 7.97094566 7.27008611 6.94685656 6.64513552 6.51886779
  6.38742131 6.24374926 6.15031505 6.07057285]
 [9.31199551 7.75088781 7.0746327  6.67466086 6.47255486 6.20619053
  6.25005263 6.15654689 6.04277557 5.91726649]
 [9.32481837 7.82369703 7.18728    6.83111334 6.62675995 6.39714885
  6.22387064 6.16774189 6.09007847 6.03016078]
 [9.21622306 7.57341409 7.01762557 6.52133006 6.32483256 6.26990217
  6.13211018 6.02969038 5.86167771 5.82003826]
 [8.52334028 7.18020141 6.5680306  6.23821384 6.02763048 5.93857551
  5.81677455 5.70801955 5.61918366 5.54523319]
 [9.38654494 7.79385471 7.17787325 6.65424526 6.55761802 6.31488532
  6.2046839  6.04293978 5.9632763  5.94251209]
 [9.36204195 7.95360988 7.06243622 6.78188437 6.35651392 6.32775855
  6.15900379 5.97123063 5.93917328 5.97840536]
 [9.63564092 7.99608409 7.44762069 6.94421667 6.76823735 6.58629358
  6.33148456 6.29587001 6.2141723  6.19323117]
 [9.42917109 7.76827884 7.14915866 6.84436005 6.48764968 6.42280495
  6.30792344 6.17184949 6.1363619  6.10626948]]
Test accuracies per communication round for each client:  [[0.70759259 0.74037037 0.74833333 0.75574074 0.7612963  0.76407407
  0.76518519 0.77259259 0.76962963 0.77148148]
 [0.72037037 0.74314815 0.75407407 0.75685185 0.76462963 0.76666667
  0.77185185 0.77888889 0.77981481 0.78166667]
 [0.72555556 0.74333333 0.75685185 0.76407407 0.76759259 0.77703704
  0.77333333 0.77722222 0.77925926 0.78296296]
 [0.71925926 0.73981481 0.7537037  0.76074074 0.76407407 0.76851852
  0.7712963  0.77074074 0.77240741 0.77407407]
 [0.70833333 0.74185185 0.75462963 0.77092593 0.77314815 0.77222222
  0.77611111 0.78166667 0.78462963 0.78759259]
 [0.73296296 0.76       0.76907407 0.77722222 0.78259259 0.78444444
  0.78814815 0.7887037  0.79648148 0.79351852]
 [0.70314815 0.72962963 0.7412963  0.75555556 0.76018519 0.76759259
  0.76796296 0.77351852 0.77592593 0.77592593]
 [0.71111111 0.73351852 0.75574074 0.76018519 0.77185185 0.76796296
  0.77277778 0.77740741 0.78074074 0.77907407]
 [0.71462963 0.73555556 0.7462963  0.75537037 0.75851852 0.76222222
  0.77       0.76907407 0.7737037  0.77462963]
 [0.7112963  0.73518519 0.74888889 0.75203704 0.76092593 0.76074074
  0.76296296 0.76685185 0.76796296 0.76944444]]


Train losses per communication round:  [1.165119089477161, 0.84394837987758, 0.7509772602270341, 0.7093793431638613, 0.6812686869158194, 0.662942124418253, 0.6488760218156513, 0.6398161452682414, 0.6306750046320745, 0.6255818335703138]
Test losses per communication round:  [8.67337002158165, 7.3110703229904175, 6.784040141105652, 6.479665231704712, 6.294077289104462, 6.134379363059997, 6.0011181890964505, 5.897985020279885, 5.840413898229599, 5.788975632190704]
Test weighted accuracies per communication round:  [0.7302962962962963, 0.753462962962963, 0.7635185185185186, 0.7691296296296297, 0.7738518518518519, 0.7780185185185186, 0.7807222222222223, 0.7831481481481483, 0.7850555555555556, 0.786]
Test losses per communication round for each client:  [[8.88108593 7.49704212 6.9510445  6.67586678 6.39012128 6.26449198
  6.11568564 6.01624987 5.96380311 5.84248185]
 [8.81678981 7.33936548 6.91019505 6.53199327 6.32821333 6.17124462
  6.07993811 5.88091713 5.90308422 5.80685985]
 [8.51932657 7.22075152 6.63040024 6.35080308 6.19893444 6.02955574
  5.91295683 5.78536898 5.69740427 5.65809226]
 [8.56749517 7.29583961 6.79894352 6.58049911 6.36828703 6.20997852
  6.01954913 5.99781245 5.89468068 5.85507786]
 [8.85158348 7.47218442 6.88980067 6.62359595 6.43703991 6.20040911
  6.15507454 6.06470251 5.92429137 5.92092389]
 [8.73635638 7.33174235 6.93132764 6.45418537 6.41060293 6.17097014
  6.01164073 5.95456237 5.87726915 5.85607719]
 [8.66212928 7.27240926 6.59132594 6.33725065 6.14593375 6.0331502
  5.94619232 5.7582289  5.73991662 5.71972454]
 [8.64178538 7.19612038 6.80419654 6.45003003 6.2619735  6.12573481
  5.87720567 5.83112627 5.82919014 5.79201758]
 [8.36108702 7.13808078 6.61086762 6.28093272 6.08859468 6.00645083
  5.90703964 5.78673154 5.72314066 5.69260955]
 [8.69606119 7.34716731 6.7222997  6.51149535 6.31107205 6.13180768
  5.98589927 5.90415019 5.85135877 5.74589175]]
Test accuracies per communication round for each client:  [[0.72888889 0.75074074 0.76351852 0.76592593 0.77407407 0.77537037
  0.77981481 0.78444444 0.78462963 0.78685185]
 [0.72       0.74592593 0.75722222 0.7612963  0.76574074 0.76907407
  0.77240741 0.77685185 0.77518519 0.77814815]
 [0.74148148 0.7587037  0.76888889 0.77314815 0.78       0.78462963
  0.78944444 0.79240741 0.79518519 0.79222222]
 [0.7362963  0.7587037  0.76833333 0.76944444 0.77333333 0.77722222
  0.78296296 0.78462963 0.78444444 0.78611111]
 [0.72296296 0.74518519 0.75555556 0.76166667 0.76703704 0.77240741
  0.77203704 0.77277778 0.77759259 0.78      ]
 [0.72851852 0.75555556 0.76       0.7712963  0.77074074 0.7787037
  0.78185185 0.78018519 0.7862963  0.7837037 ]
 [0.73055556 0.75962963 0.76925926 0.77425926 0.77777778 0.78277778
  0.78111111 0.78759259 0.79018519 0.78962963]
 [0.725      0.7537037  0.76333333 0.76962963 0.7737037  0.77907407
  0.7812963  0.78314815 0.78444444 0.785     ]
 [0.73037037 0.74981481 0.76444444 0.77296296 0.7787037  0.78037037
  0.78111111 0.78222222 0.7862963  0.78907407]
 [0.73888889 0.75666667 0.76462963 0.77166667 0.77740741 0.78055556
  0.78518519 0.78722222 0.7862963  0.78925926]]


Train losses per communication round:  [1.1943858526514832, 0.8811501961267559, 0.7771493697351606, 0.7303209777943481, 0.7066640869312033, 0.6830789689746128, 0.6658415197488472, 0.6541184275372494, 0.6446822464554267, 0.63693866075496]
Test losses per communication round:  [8.799458104372025, 7.619509339332581, 7.03655070066452, 6.686244523525238, 6.481964242458344, 6.326924175024033, 6.1824680984020235, 6.064532077312469, 5.964753717184067, 5.906860238313675]
Test weighted accuracies per communication round:  [0.7246481481481482, 0.7461296296296297, 0.7558703703703704, 0.7632777777777778, 0.7675370370370371, 0.7722222222222223, 0.7760740740740741, 0.7781666666666667, 0.7817222222222222, 0.7834444444444445]
Test losses per communication round for each client:  [[8.67899328 7.41571844 6.86000478 6.52983636 6.38858539 6.23772347
  6.08643568 5.87173754 6.00805986 5.85236126]
 [8.94951713 7.68401927 7.14566046 6.75775069 6.48238242 6.32898593
  6.18050402 6.11452639 5.85113132 5.84698606]
 [8.64163452 7.56288767 7.00968999 6.63402385 6.44516063 6.34855819
  6.08804685 6.0924418  5.89745414 5.84909761]
 [8.64390785 7.58049947 6.97561586 6.59057611 6.38438421 6.19556296
  6.16166335 5.99388373 5.95932221 5.87870848]
 [8.600972   7.59855133 6.90806931 6.55520701 6.47497654 6.26008677
  6.0945648  5.99339908 5.89192277 5.86580849]
 [8.89513409 7.69952816 7.01135767 6.66857624 6.45809108 6.30755365
  6.08742827 6.04075283 5.92178506 5.86264306]
 [8.82254404 7.58345944 6.99165457 6.67911911 6.42106712 6.27922136
  6.07475787 5.98722517 5.86538434 5.85363865]
 [8.82571661 7.48669744 7.12863857 6.68138021 6.49926555 6.34506708
  6.27305794 6.05871695 6.02512872 5.91538119]
 [8.98115295 7.74419063 7.01349968 6.81519109 6.55072033 6.3590852
  6.24479783 6.16786557 6.01502711 5.96148932]
 [8.95500857 7.83954155 7.32131612 6.95078456 6.71500915 6.60739714
  6.53342438 6.3247717  6.21232164 6.18248826]]
Test accuracies per communication round for each client:  [[0.72611111 0.74740741 0.75592593 0.76277778 0.76314815 0.76962963
  0.77314815 0.77944444 0.7737037  0.78074074]
 [0.71259259 0.73592593 0.745      0.75481481 0.76203704 0.76722222
  0.77166667 0.7737037  0.78166667 0.78240741]
 [0.73666667 0.74981481 0.76074074 0.7687037  0.77037037 0.77277778
  0.78425926 0.78148148 0.78777778 0.79148148]
 [0.72925926 0.75222222 0.76314815 0.77       0.7762963  0.78240741
  0.78277778 0.78592593 0.78796296 0.78851852]
 [0.72944444 0.74740741 0.75944444 0.76796296 0.77018519 0.77481481
  0.77907407 0.78018519 0.78425926 0.78407407]
 [0.71925926 0.7412963  0.75351852 0.76111111 0.76925926 0.77537037
  0.77796296 0.77703704 0.78314815 0.78425926]
 [0.72333333 0.75111111 0.75777778 0.76462963 0.76925926 0.77444444
  0.78111111 0.78055556 0.78759259 0.78518519]
 [0.72703704 0.75333333 0.75796296 0.76537037 0.76833333 0.76962963
  0.77092593 0.77740741 0.77814815 0.78296296]
 [0.72037037 0.74055556 0.7562963  0.75907407 0.76555556 0.77148148
  0.77111111 0.77407407 0.7737037  0.77796296]
 [0.72240741 0.74222222 0.74888889 0.75833333 0.76092593 0.76444444
  0.7687037  0.77185185 0.77925926 0.77685185]]



# federated non-IID 0.01 with pre-training
Train losses per communication round:  [1.739920709681181, 1.39370013473842, 1.1623560102643606, 1.0645518955343898, 0.9535805416780756, 0.8675196263947692, 0.8154419158921573, 0.771131153422898, 0.7382643971270871, 0.6951935855150932]
Test losses per communication round:  [17.708611726760864, 16.293061964213848, 16.32995948791504, 16.078199738261173, 16.302380230062408, 16.422209968348035, 16.3272191772463, 16.729815251613037, 17.097901486945194, 16.979220754746347]
Test weighted accuracies per communication round:  [0.5182625450722215, 0.5647154434374266, 0.5815650926903912, 0.5829227278324883, 0.5785427819834296, 0.5821532301737746, 0.5794877141198437, 0.5818674331601424, 0.5734856803181623, 0.5755126971633072]
Test losses per communication round for each client:  [[29.7749064  29.02053136 30.48094827 28.56544924 27.61539006 26.958969
  25.96973324 24.56028795 25.78519177 24.63647163]
 [15.78710586 18.72052193 19.32375681 20.82284689 23.62610352 24.1132319
  24.69043756 25.38053012 30.45413303 28.01983976]
 [ 8.80545819  8.87530494 10.49306685 11.75600636 12.04318547 11.99810803
  12.76877606 13.63309669 13.65585613 14.93582702]
 [15.47027981 11.70812273  8.42072329  6.14050645  5.22742428  4.49048265
   3.72994509  3.22868584  2.90840569  2.6021842 ]
 [12.31566763 19.0817672  22.50631523 25.2726481  27.93409157 29.46733952
  30.30130219 32.65222692 32.64142013 34.44272995]
 [20.40694356 14.17165482 12.22220135 10.9483763   9.86097699  9.76971865
  10.04703659 11.13058072  9.32451707  8.36073755]
 [26.61235142 21.51228398 23.22324848 21.39116716 21.01068628 21.3555336
  20.14399946 20.50471878 19.7647357  19.51072586]
 [17.52503836 13.21910274 11.99164999 10.05172029  9.57677117 10.03372854
   9.08371761  9.54678315  9.16637397  8.85392165]
 [16.32229811 10.16476457  7.57530263  7.69004747  6.78710893  6.90754867
   6.84193482  5.67177042  6.80108693  6.65355366]
 [14.06606793 16.45656538 17.06238198 18.14322913 19.34206402 19.12743914
  19.69530916 20.98947191 20.47729445 21.77621627]]
Test accuracies per communication round for each client:  [[0.35416667 0.35416667 0.27083333 0.25       0.22916667 0.25
  0.25       0.3125     0.22916667 0.29166667]
 [0.48213955 0.43420322 0.37183046 0.29613178 0.24578938 0.19526189
  0.16139182 0.12641125 0.11067925 0.09531742]
 [0.74925926 0.76018519 0.71666667 0.67296296 0.65259259 0.62703704
  0.55944444 0.49296296 0.46648148 0.40166667]
 [0.59250116 0.68014195 0.73167721 0.77302885 0.79200741 0.8142262
  0.84184539 0.86236692 0.88859744 0.91513655]
 [0.66703704 0.53018519 0.42796296 0.35277778 0.27814815 0.23185185
  0.20851852 0.16388889 0.14574074 0.12222222]
 [0.43042071 0.54144193 0.6133585  0.64823804 0.6597447  0.67880259
  0.68716289 0.69408486 0.70963682 0.71548004]
 [0.42641148 0.3984689  0.3722488  0.36440191 0.35425837 0.33205742
  0.3230622  0.32       0.30755981 0.3077512 ]
 [0.4609375  0.55859375 0.62257179 0.64284206 0.671875   0.67103041
  0.68148226 0.68971706 0.68950591 0.69594595]
 [0.51851852 0.66666667 0.7962963  0.7962963  0.7962963  0.83333333
  0.83333333 0.85185185 0.83333333 0.81481481]
 [0.59633197 0.52556502 0.46646906 0.40329752 0.3584661  0.33345684
  0.29047795 0.25639126 0.24194146 0.21563542]]


Train losses per communication round:  [0.7582945251462109, 0.6303155602685612, 0.531490729207307, 0.4632817756281485, 0.40754445877741663, 0.3665211652237635, 0.3338120927146903, 0.3069149786102111, 0.2847720178509338, 0.26559430301026404]
Test losses per communication round:  [22.215665334463118, 20.78045595139265, 20.863156926631927, 20.03309705555439, 19.0511628434062, 18.51252894550562, 18.38187386393547, 18.086416178941725, 17.746698413044214, 17.681489937007427]
Test weighted accuracies per communication round:  [0.45580963338862956, 0.45192881195875373, 0.45257302870779836, 0.4496407002412326, 0.4576409057105653, 0.4559542848064333, 0.45593962622470113, 0.452611990574726, 0.4556790676782294, 0.4499780975265245]
Test losses per communication round for each client:  [[34.77021408 32.29772806 33.01464343 32.93394756 31.56551337 32.60435057
  34.62808132 32.40545201 33.14801979 34.02335835]
 [23.98677206 22.70408845 21.50032854 20.56834674 19.74621344 19.48194671
  19.62103939 19.25118423 19.33657396 19.24110138]
 [17.20366848 14.95743108 13.6820246  12.95168316 10.94103986 10.20047724
   9.85302252  9.79390585  8.73832942  9.37231159]
 [36.38719797 35.6859975  42.98817587 39.95904875 39.50101733 35.80256772
  33.83962607 35.3310864  33.88610029 33.84133291]
 [22.46878099 24.06217563 24.36276007 24.99739456 23.51600862 23.98147392
  23.36526561 23.62654054 23.42561436 22.2771827 ]
 [14.97280109 12.91757768 12.73865998 12.11771727 11.47867501 11.16983449
  10.98371506 10.07518542 10.43884593  9.43826425]
 [13.0791527  12.35257375 11.85325325 11.41385531 10.94158852 11.09187627
  10.57401145 10.74903625 10.16436762 10.40060484]
 [31.53121281 28.44772649 25.37252402 23.69616103 21.80670166 20.4993664
  20.66267633 19.7659924  18.7730692  18.81482095]
 [20.0943495  18.2894994  17.28400266 16.55934751 16.29247224 15.69802034
  15.46737182 15.40549338 15.06579125 15.072909  ]
 [ 7.66250366  6.08976147  5.83519685  5.13346866  4.72239839  4.59537579
   4.82392907  4.46028531  4.49027231  4.3330134 ]]
Test accuracies per communication round for each client:  [[0.21084783 0.19881525 0.18067382 0.16512403 0.16716031 0.15161051
  0.13569049 0.13532025 0.11717882 0.10644206]
 [0.23962963 0.22259259 0.21759259 0.21333333 0.21814815 0.21037037
  0.1862963  0.17907407 0.16648148 0.16203704]
 [0.5674786  0.60346719 0.64033355 0.65591398 0.67961378 0.69497476
  0.70375247 0.70331358 0.71121352 0.71604126]
 [0.48527218 0.43698732 0.37695749 0.3391126  0.30816555 0.27535421
  0.26342282 0.2313572  0.2287472  0.20022371]
 [0.44126074 0.3745395  0.34220221 0.31191158 0.33483422 0.28714695
  0.2771183  0.25624233 0.24048301 0.22492837]
 [0.59741084 0.61835258 0.64005584 0.65325549 0.67115116 0.68422389
  0.69310826 0.71252697 0.70516563 0.72103059]
 [0.61434783 0.61804348 0.62543478 0.62043478 0.63543478 0.63021739
  0.64369565 0.63934783 0.67586957 0.66413043]
 [0.28438662 0.28438662 0.30642592 0.31625066 0.34147637 0.36909187
  0.3629846  0.36510887 0.36086033 0.34917685]
 [0.26851852 0.28703704 0.29425926 0.30777778 0.30074074 0.32018519
  0.34296296 0.34944444 0.36555556 0.37462963]
 [0.79665036 0.8224396  0.84007707 0.84956277 0.84630206 0.8562324
  0.86038239 0.86927523 0.87772343 0.88113236]]


Train losses per communication round:  [1.503951141001399, 1.1158096199777634, 0.9498558918612812, 0.7966238252077222, 0.7097542311690882, 0.6361478320329793, 0.5756090928740143, 0.5291814783553229, 0.49101905647617683, 0.45367523062316345]
Test losses per communication round:  [18.952936907019467, 17.3026386577636, 15.797090328715422, 15.41224675050471, 14.671731153689326, 15.458195563405752, 15.421443724632264, 14.448546075075864, 14.535445865616202, 14.558988024387508]
Test weighted accuracies per communication round:  [0.5838438951211127, 0.5862932084693321, 0.5872105658052211, 0.5860531099862456, 0.5872667987361151, 0.5884954986756588, 0.5932800415049252, 0.5826631065667646, 0.5820396868019767, 0.5768383751472879]
Test losses per communication round for each client:  [[17.70557868 15.47036719 11.795506    9.91682518  9.20673604  9.03302276
  10.22092193  9.58298561  9.7895183   9.52615899]
 [11.62826632 13.37255192 11.82937664 13.78234273 11.22550219 10.79519176
  11.5009762  10.68489719  9.99414339  9.76660293]
 [21.49373853 18.753196   16.31912768 15.86414754 13.26956868 12.90194046
  12.29218739 13.975878   12.77591264 13.43680048]
 [15.98697639 11.92041659 10.73227582 10.77601617 10.37347003 15.57499242
  17.22009772  8.84389566 10.65281177  9.00867771]
 [19.82185602 19.01546776 19.13893175 20.02075648 20.86276817 21.75603938
  20.61362493 20.66119051 23.29485393 23.39428973]
 [12.64330936 13.08905675 12.3621392  12.51881269 12.25289291 11.33428588
  11.95491371 12.14290407 11.12336475 11.27036691]
 [26.04325223 23.34950662 23.8452785  23.61230707 22.63489747 23.84644651
  24.23798299 23.25073266 24.40517068 24.12730026]
 [28.1890347  25.44930744 22.72652292 20.07057697 18.79149705 20.68587542
  18.67186141 18.27325082 18.23174894 19.10030234]
 [22.37052572 22.35666192 21.03544354 20.47226274 20.26117718 21.59627521
  20.99951661 20.57902634 20.58929861 20.97870708]
 [13.64683112 10.24985439  8.18630122  7.08841994  7.8388018   7.05788583
   6.50235435  6.49069989  4.49763567  4.98067382]]
Test accuracies per communication round for each client:  [[0.60890302 0.64264264 0.6451157  0.67602897 0.68945416 0.71436142
  0.71047518 0.69687334 0.72972973 0.74721781]
 [0.74276958 0.73185214 0.73683202 0.74391879 0.7316606  0.73242674
  0.72112622 0.69316223 0.68990615 0.68262785]
 [0.43784745 0.48621303 0.52045808 0.55581499 0.56448744 0.58427841
  0.59328441 0.54247276 0.57505003 0.56659996]
 [0.66375214 0.65158715 0.66204144 0.66337198 0.68314009 0.67990876
  0.72343661 0.77190648 0.75917126 0.76259266]
 [0.50549451 0.48241758 0.45238095 0.40531136 0.38003663 0.35549451
  0.36556777 0.3514652  0.29194139 0.27289377]
 [0.84415584 0.80519481 0.79220779 0.76623377 0.76623377 0.77922078
  0.74025974 0.71428571 0.7012987  0.66233766]
 [0.24851962 0.21150999 0.19781643 0.1761658  0.16672835 0.13341969
  0.12305699 0.15673575 0.10325685 0.10066617]
 [0.39030326 0.4239985  0.42942718 0.43129914 0.44028454 0.44533882
  0.45563459 0.43504306 0.46181206 0.46274803]
 [0.41655862 0.38470087 0.37692165 0.38451565 0.37284682 0.34821263
  0.34321171 0.3165401  0.32394888 0.32580107]
 [0.68514135 0.7146637  0.73039967 0.73652695 0.75685838 0.77036624
  0.79000139 0.8164601  0.83303161 0.84138699]]


Train losses per communication round:  [1.3837821907337866, 1.1475533924805685, 0.9873151132922142, 0.8647161296067895, 0.8139254458168346, 0.7623642096901706, 0.719420063106017, 0.650212979065608, 0.6593012095652983, 0.62191849854183]
Test losses per communication round:  [20.505132949352266, 19.806069859862326, 20.317067810893057, 20.464473739266396, 20.89571904093027, 21.021979403495788, 20.408489960432053, 20.704768455028535, 20.90292590856552, 20.68802219033241]
Test weighted accuracies per communication round:  [0.49758415128210376, 0.4772912553879334, 0.4445374064474703, 0.42950312563414444, 0.3990930646504617, 0.37981218553114887, 0.3805204939315009, 0.36624472797449786, 0.3541173069029945, 0.35311285760435973]
Test losses per communication round for each client:  [[23.99466109 21.7216574  22.49310637 20.84357905 21.52179742 20.14257824
  19.54593432 19.74007583 19.87859511 19.46731579]
 [21.65528405 26.20029116 26.12762475 27.88619781 27.95886326 27.94500303
  25.48575258 27.67466664 25.12999451 26.58150601]
 [26.06881332 21.58929598 19.63695669 18.0168196  17.80809414 14.97377503
  15.06481838 14.05039847 13.54424083 12.57786453]
 [25.94487906 29.74653029 31.2615428  32.51470089 32.06960559 32.86184764
  31.48084974 33.3292594  30.82097769 32.35421157]
 [19.49630684 17.18875247 17.06477609 17.46491268 18.19061667 19.06255072
  18.42936987 19.13748157 19.84568542 18.95631862]
 [12.13449025 17.72847235 23.97496748 27.3510499  31.02561927 33.3935802
  34.22878337 32.85770988 37.7996819  36.74586511]
 [25.32370734 20.29518795 19.35833442 17.69222295 17.97595799 17.66344714
  17.86184549 17.41898    17.68029857 17.09851873]
 [15.91727459 14.94174552 16.08926344 16.66735613 16.62685335 18.22254622
  17.92278945 18.10943031 19.1899929  18.51548743]
 [10.34656245  7.39743629  6.88961762  6.79663467  6.2656482   6.93029028
   6.77857137  6.43953836  7.30557102  7.50850624]
 [24.1693505  21.25132918 20.27448845 19.4112637  19.51413453 19.02417552
  17.28618503 18.29014409 17.83422112 17.07462788]]
Test accuracies per communication round for each client:  [[0.29464286 0.25892857 0.22767857 0.23660714 0.22767857 0.22321429
  0.25892857 0.23660714 0.25       0.23660714]
 [0.59288468 0.53925692 0.47108307 0.41465124 0.37136348 0.32754995
  0.31440589 0.30757098 0.2723449  0.25955135]
 [0.36654431 0.41992659 0.45159937 0.50036707 0.52375459 0.53529103
  0.5688516  0.57241741 0.57818563 0.58982695]
 [0.42481481 0.34796296 0.3        0.2637037  0.25481481 0.23333333
  0.23722222 0.20166667 0.225      0.195     ]
 [0.55813953 0.55813953 0.51162791 0.51162791 0.41860465 0.37209302
  0.41860465 0.30232558 0.3255814  0.3255814 ]
 [0.68611111 0.57555556 0.47       0.42111111 0.36351852 0.33296296
  0.325      0.34518519 0.28759259 0.30296296]
 [0.26640844 0.31030773 0.31934581 0.34624489 0.32795352 0.33548526
  0.32816871 0.33699161 0.31870024 0.32537121]
 [0.55853994 0.51859504 0.47761708 0.45092975 0.40719697 0.37086777
  0.36449725 0.35313361 0.3262741  0.34073691]
 [0.73511161 0.7704918  0.79299806 0.79809206 0.79596184 0.79975919
  0.7927202  0.79642493 0.79299806 0.79151616]
 [0.32686637 0.31786435 0.30637902 0.30793109 0.32345181 0.32779761
  0.34238709 0.34099022 0.35526928 0.3577526 ]]


Train losses per communication round:  [1.171852204447989, 0.9602876738727648, 0.8198475910138411, 0.7068180369857563, 0.6435729795963745, 0.5994801651720798, 0.5506950098473746, 0.526932139293024, 0.5082363366935064, 0.46947662228111636]
Test losses per communication round:  [20.942710161209106, 18.61447192877531, 16.999605661630632, 15.71049469411373, 15.102738705277442, 14.873315259814262, 14.33416797965765, 14.222664555907249, 13.905458527803422, 13.871974748373031]
Test weighted accuracies per communication round:  [0.4708586152577253, 0.46601812153701916, 0.46068676030675015, 0.46255162070437505, 0.4642662653480151, 0.46994033300687527, 0.47316681125553123, 0.4764444973188111, 0.48317979980741077, 0.48681063542036684]
Test losses per communication round for each client:  [[22.3169713  19.10829592 17.42594993 17.00224054 16.76444006 17.0356189
  17.03160524 17.15242398 16.91372955 17.41860223]
 [17.69220555 18.83694363 18.49457014 18.36714149 18.82208061 18.57745183
  18.58926129 18.24747455 17.80519724 17.46579766]
 [28.77676988 26.60724032 21.4378078  19.24452603 18.14887822 16.95195377
  17.27849472 16.09761798 16.02238226 15.78532243]
 [22.90338373 21.72065091 20.71240163 20.10223234 19.47347331 18.85509789
  18.37625968 17.87361503 18.23112833 17.80758858]
 [ 9.15755922 10.56041735 11.87421477 12.73773551 13.03706694 12.95687473
  13.35050166 13.45131898 13.15511334 13.00823176]
 [31.03323209 21.43554662 18.40585208 14.71326804 13.07289144 12.05991977
  10.02468424 10.29959553  8.48063976  7.66914696]
 [ 7.36119789  5.82062125  5.17249614  4.75958464  4.40511832  4.30039063
   4.45300162  4.67997095  4.89266115  5.15650851]
 [29.10476232 23.73224986 21.10061836 16.76091915 14.94756129 14.73280418
  12.34023988 11.98903137 11.35264558 12.06348914]
 [26.4073329  23.3687427  20.75818789 19.24917269 18.72217977 17.94592464
  17.42680347 16.96848595 16.62021267 16.64597797]
 [14.67368674 14.95401073 14.61395788 14.16812652 13.63369709 15.31711626
  14.470828   15.46711123 15.5808754  15.69908226]]
Test accuracies per communication round for each client:  [[0.31537037 0.35388889 0.36351852 0.35611111 0.36074074 0.33740741
  0.33722222 0.32351852 0.33425926 0.31648148]
 [0.46574074 0.38388889 0.34537037 0.32981481 0.30907407 0.31814815
  0.31296296 0.3237037  0.3337037  0.34981481]
 [0.25163963 0.27856403 0.30652399 0.34345875 0.3693476  0.39247497
  0.39558164 0.40869865 0.41939938 0.42078012]
 [0.43555556 0.43981481 0.44574074 0.45240741 0.45407407 0.46203704
  0.46703704 0.46796296 0.45759259 0.46074074]
 [0.72185185 0.68888889 0.6487037  0.62055556 0.61055556 0.60851852
  0.59518519 0.58685185 0.58888889 0.59611111]
 [0.47440273 0.50170648 0.50853242 0.53924915 0.52559727 0.56313993
  0.58361775 0.60750853 0.63139932 0.66894198]
 [0.80787037 0.82861111 0.83601852 0.84175926 0.84694444 0.85222222
  0.84388889 0.83916667 0.83175926 0.81777778]
 [0.37317746 0.39537633 0.397478   0.42322343 0.43662157 0.46486273
  0.49835807 0.51858663 0.53894654 0.55996322]
 [0.29537037 0.33259259 0.36925926 0.38962963 0.40018519 0.42462963
  0.43592593 0.44796296 0.455      0.45314815]
 [0.59966685 0.58948732 0.56524153 0.54599297 0.54932445 0.51434388
  0.51341847 0.49602073 0.49583565 0.49157875]]


# federated non-IID 0.1 with pre-training
Train losses per communication round:  [0.8401816522182634, 0.6907311019600428, 0.6057142406402594, 0.5421393308270096, 0.5026116215665357, 0.4698229293090622, 0.44765051965796, 0.42779091092869026, 0.4115139576093889, 0.4030460602092235]
Test losses per communication round:  [12.818890661746263, 11.208767684569285, 10.973555878456683, 10.523683686554431, 9.741226017754524, 9.534312250837683, 9.254136628154082, 9.324429280031472, 9.570898300781845, 9.910527408495545]
Test weighted accuracies per communication round:  [0.6339886600650567, 0.6331476701409542, 0.6370812460674148, 0.6335794800044239, 0.6304003011073308, 0.6300249424509164, 0.6302820450355475, 0.6291329915536324, 0.624629664860663, 0.6285429021687853]
Test losses per communication round for each client:  [[20.55522263 11.88378679 11.57810974 12.78347301 10.96206814  9.53265394
  10.0819267   9.89501506  9.34078696 10.1750114 ]
 [11.72009295 10.3937903  10.76299286 10.18835223  9.56201971  9.18509918
   8.36679485  8.7443257   8.80834031  8.11407739]
 [17.07624912 15.02704775 12.67759138 12.09627408 11.4228031  11.32758582
  11.25467515 11.72371513 11.52606201 12.65225017]
 [ 8.91627121  7.42950761  6.42213522  6.14710028  5.94050059  6.37876302
   5.58823858  5.71323004  7.41258019  5.4853638 ]
 [15.50634438 15.92946625 13.79616427 12.74541008 12.51118362 12.23969007
  11.95470387 11.60283589 12.03650868 11.7312631 ]
 [ 9.97238165  9.71743803  8.42717802  9.3368023   8.24451876  7.57715761
   7.65049998  7.51339982  7.89477745 12.93250358]
 [10.27688718  8.44773049 12.38549626  7.57593262  5.95281995  6.56627542
   5.62610038  5.72423597  5.65886164  5.55773683]
 [17.96529067 18.06132877 17.60690665 17.79742837 17.70903349 17.79479182
  17.61026025 18.00637555 18.30968547 17.94282508]
 [11.54902732 11.76937687 11.87701273 12.11107159 12.26900625 12.17159009
  11.99883366 11.99216962 12.47121179 12.25629401]
 [ 4.65113951  3.42820398  4.20197165  4.45499229  2.83830658  2.56951555
   2.40933286  2.32899002  2.2501685   2.25794873]]
Test accuracies per communication round for each client:  [[0.60222179 0.6174235  0.6269733  0.62775287 0.63106607 0.63925161
  0.64159033 0.64646268 0.65289417 0.66049503]
 [0.66752093 0.67469674 0.68426448 0.68648556 0.69297796 0.70237485
  0.69912865 0.70647531 0.70784213 0.71416368]
 [0.54314947 0.5495255  0.5725089  0.58896797 0.59208185 0.60275801
  0.60409253 0.59475089 0.58392645 0.57236062]
 [0.76312136 0.8049153  0.81213552 0.81768953 0.82407665 0.82227159
  0.82490975 0.8250486  0.83296307 0.83171341]
 [0.54094293 0.53570444 0.53487731 0.52302178 0.51888613 0.52136752
  0.52026468 0.53405018 0.53763441 0.53873725]
 [0.72807974 0.72262887 0.73103878 0.72294035 0.71063697 0.69225977
  0.681981   0.67466127 0.65752998 0.66796449]
 [0.76002815 0.7705841  0.78606615 0.79521464 0.79591837 0.80365939
  0.80717804 0.80436312 0.80295567 0.81140042]
 [0.50802048 0.48191126 0.47610922 0.45358362 0.43890785 0.4221843
  0.41979522 0.40187713 0.3890785  0.39266212]
 [0.60465116 0.55953488 0.53697674 0.52069767 0.50325581 0.49651163
  0.50302326 0.50116279 0.47976744 0.49255814]
 [0.87128846 0.90151821 0.91522236 0.92153701 0.92744861 0.93322585
  0.93604729 0.93860003 0.94303372 0.94209324]]


Train losses per communication round:  [1.1171954294307451, 0.9200975749463007, 0.8176183228013759, 0.7435994990758521, 0.7030946083994942, 0.6662438712796952, 0.6440543424968722, 0.6217009096184356, 0.6012652243864101, 0.5885112026862471]
Test losses per communication round:  [11.57031883574091, 10.796378671377898, 10.227518099918962, 10.676482909917832, 9.787289314717054, 9.780881029367446, 9.302647989988326, 9.414410677552222, 9.16227214038372, 9.275858031213284]
Test weighted accuracies per communication round:  [0.6645579754856215, 0.6736325902710801, 0.6758749196406657, 0.6771095711248414, 0.6778236133992973, 0.6793521849338751, 0.6798543541644533, 0.6771830264525085, 0.677758993231485, 0.6751338558997911]
Test losses per communication round for each client:  [[15.57537901 14.3956809  13.21837234 12.43832469 12.20189691 12.12080872
  11.63195598 11.67313397 11.73768091 11.67849207]
 [13.07405892 12.4377774  11.33006287 11.0456382  11.37085998 10.60695475
  10.1461848  10.21553683 10.61688066 10.31473714]
 [14.45902514 12.33223382 12.46935427 12.43199408 13.15193915 11.8865031
  12.17185903 11.99550593 11.99402702 12.23199415]
 [13.37073314 13.07997268 12.39601845 10.99327117 10.52035731 11.04102188
  10.29125869 10.08742064  9.55032736 10.87402481]
 [13.68727338 12.11608148 12.52613747 12.19891369 11.03191534 15.52042449
  12.15910745 12.02880788 11.50145859 11.07923934]
 [ 6.83590096  7.46589828  5.53059343 11.96404707  7.65706065  5.54732558
   5.2444052   5.77036217  5.54700232  5.1647336 ]
 [ 8.230611    8.45802587  7.67275116  7.73836458  7.21983385  6.85000104
   7.38635862  7.84485811  6.97516695  7.12176037]
 [12.30588824 10.55199921  9.96049207  9.55414969  9.64885378  9.23314548
   8.36509855  9.29634899  8.65040141  8.75407052]
 [ 7.28969282  7.39856929  6.98972422  6.80896819  6.43661886  6.22598517
   6.15848154  6.13874215  6.20823723  6.31051177]
 [10.87462574  9.72754779 10.18167472 11.59115773  8.6335573   8.77664009
   9.47177005  9.09339011  8.84153897  9.22901654]]
Test accuracies per communication round for each client:  [[0.51480804 0.50786106 0.52888483 0.54296161 0.55191956 0.55246801
  0.57038391 0.5725777  0.55868373 0.56160878]
 [0.57736049 0.60565988 0.60698228 0.60711452 0.61451997 0.61478445
  0.63475271 0.63581063 0.64467072 0.64718328]
 [0.55537849 0.55670651 0.54661355 0.52695883 0.51819389 0.51022576
  0.49694555 0.49508632 0.50411687 0.50172643]
 [0.62095238 0.62349206 0.62539683 0.62984127 0.63492063 0.64571429
  0.65777778 0.66349206 0.65904762 0.65714286]
 [0.55395683 0.57314149 0.56195044 0.55715428 0.55315747 0.54596323
  0.54916067 0.53157474 0.5363709  0.54036771]
 [0.80452252 0.82769576 0.84208559 0.84619697 0.84320688 0.84713138
  0.85498038 0.85068212 0.85311157 0.85348533]
 [0.73734818 0.75379555 0.76821862 0.77492409 0.77505061 0.78972672
  0.78479251 0.78656377 0.78352733 0.78567814]
 [0.63595054 0.66775864 0.68043961 0.68487795 0.68794251 0.69195815
  0.69153545 0.69142978 0.69512839 0.69533974]
 [0.76426299 0.7466596  0.74814422 0.74432662 0.74973489 0.75100742
  0.74644751 0.74888653 0.7457052  0.73414634]
 [0.67980296 0.68069861 0.6789073  0.69368562 0.69592476 0.70040305
  0.70174653 0.69950739 0.69413345 0.6869682 ]]


Train losses per communication round:  [1.1634691156416093, 0.9588630905166529, 0.834281992173044, 0.7719070186996426, 0.7269794071923328, 0.6921037644528735, 0.6645626315797363, 0.6455742634912567, 0.630208804862934, 0.6086851216020244]
Test losses per communication round:  [10.68294223435223, 9.654576192796231, 8.96092655789107, 8.577092424035072, 8.52393722012639, 8.038719282858073, 8.10807883220259, 7.935686444863677, 8.169336849451065, 7.865736719220877]
Test weighted accuracies per communication round:  [0.6732034010093576, 0.6900644403843679, 0.699083734405519, 0.7042202630122183, 0.7085491699834456, 0.7120089293669001, 0.7095374018491132, 0.7148802488383604, 0.7168789907584227, 0.7169176051140596]
Test losses per communication round for each client:  [[ 5.18081617  4.50014044  5.12620273  3.99352174  4.36585763  4.29776448
   4.51446005  4.59455284  4.79019417  4.27242126]
 [11.8427186   9.97812539  8.40081009  8.18966079  6.58269063  6.90912643
   7.11784139  6.78217673  6.07606885  5.84099714]
 [12.98850432 11.35566223 10.43649298  9.81512421  9.29517841  8.81727949
   8.58687738  8.67327714  9.90250677  8.41490746]
 [ 9.13449109  7.52005869  6.22421044  5.77218884  5.05054945  5.13888851
   5.06005383  4.91632825  5.00726527  5.41515952]
 [15.2359947  13.69053209 12.3432228  11.65419316 12.44416928 11.97260094
  12.61958265 11.5140236  11.20807511 12.28632987]
 [10.76718444  9.04661345  9.31437701  8.2503528   8.85646468  7.67996216
   7.73374838  7.71480995  8.09854847  7.19651794]
 [14.34951675 13.22482872 11.86776012 11.98621327 10.9963814  10.47209758
  10.30798888  9.77172601  9.96126342  9.39822704]
 [11.93274188 11.12976134 11.14062554 11.44205159 11.97060966 10.94357401
  10.50390166 10.56806744 11.14533484 10.70672968]
 [12.31074512 12.92568004 11.74234694 11.7689532  12.2940467  11.18010548
  11.38879675 11.64393163 12.20741594 11.80683547]
 [ 3.08670928  3.17435953  3.01321693  2.89866464  3.38342434  2.97579376
   3.24753736  3.17797084  3.29669566  3.31924181]]
Test accuracies per communication round for each client:  [[0.8575826  0.86620152 0.86312333 0.8824133  0.86599631 0.86455982
  0.85409399 0.86640673 0.85840345 0.85983993]
 [0.68694097 0.71914132 0.76923077 0.77996422 0.81037567 0.81037567
  0.80322004 0.81753131 0.82110912 0.81753131]
 [0.58760108 0.62139747 0.63632594 0.64627825 0.6543645  0.66120672
  0.6788306  0.6840141  0.63445988 0.68919759]
 [0.75339835 0.78922872 0.81213061 0.8186318  0.83296395 0.84049941
  0.84485816 0.85254137 0.84500591 0.85638298]
 [0.58662614 0.58189801 0.57531239 0.57801418 0.55471125 0.55217832
  0.53833164 0.53850051 0.61195542 0.5376562 ]
 [0.6621078  0.70313757 0.72231161 0.72231161 0.7410834  0.74792169
  0.75046929 0.75864843 0.74242424 0.76454814]
 [0.58448643 0.604843   0.6172166  0.61322512 0.63677488 0.64928153
  0.65606706 0.65114423 0.66458222 0.66671102]
 [0.62416904 0.5968661  0.57573599 0.57502374 0.55603039 0.54819563
  0.53205128 0.52991453 0.5308642  0.52350427]
 [0.59633847 0.57847734 0.55101585 0.54789015 0.53449431 0.53159187
  0.51841929 0.5146238  0.49988837 0.51484706]
 [0.8974359  0.89262821 0.88942308 0.90705128 0.90064103 0.90705128
  0.90064103 0.91346154 0.90384615 0.90384615]]


Train losses per communication round:  [0.9769542486426508, 0.7876856560035893, 0.7238684359194272, 0.6043197086476495, 0.5655638844356632, 0.5371538610129204, 0.5176047485483207, 0.4943910003826839, 0.4807712879497214, 0.46597862975632154]
Test losses per communication round:  [10.406529937312007, 9.307098776102066, 8.823838172852993, 8.569729200005531, 8.45417937040329, 8.235334172844887, 8.132879878580571, 7.972686168551445, 8.08997664898634, 7.983938957750797]
Test weighted accuracies per communication round:  [0.6878774065744127, 0.6932958899704688, 0.688699571062519, 0.691472605297515, 0.6918808720694247, 0.6984676647126917, 0.7040595905820408, 0.7071913506149375, 0.7097811033055819, 0.7119203114833921]
Test losses per communication round for each client:  [[ 8.88041309  7.91642755  5.83730005  5.98345557  5.35852921  4.74669161
   4.78264768  4.88791367  4.3826402   4.7899949 ]
 [11.38087642 10.0125728   9.43216729  8.68132579  8.85364705 10.05316907
  10.120767    9.18510252  9.49950141  9.63889956]
 [14.10031736 11.65769204 11.63197756 10.83545727 10.1869958   9.80237615
   9.79365063  9.33773047  9.76608515  9.48291326]
 [11.5396038   9.66407597  9.63073754  9.17390484 10.30706328  8.56055868
   8.17740619  8.0786795   8.17798752  8.79277343]
 [ 9.58999836  8.24877828  8.07433254  7.89596182  7.61912251  7.29853386
   7.01998729  6.88976216  6.86376274  6.67058903]
 [ 9.99640071  8.36166114  7.85127926  6.94914603  6.83899912  6.80033851
   6.84373802  6.67346328  6.90221846  6.43222442]
 [ 9.26844555  9.15336382  7.93163127  8.15086502  7.82833958  7.90350896
   7.6941008   7.81055111  8.38348371  7.32392204]
 [ 7.44558221  6.7804907   6.82400376  6.70170993  6.67631233  6.50956917
   6.36587542  6.22626376  6.40414244  6.19142866]
 [ 8.67009209  7.7954976   7.56314939  7.43233758  6.46910426  6.05856627
   5.78940791  5.67242509  5.72595546  5.36244802]
 [13.19356978 13.48042786 13.46180308 13.89312816 14.40368056 14.62002945
  14.74121785 14.96497011 14.79398942 15.15419626]]
Test accuracies per communication round for each client:  [[0.7351528  0.76609648 0.79646358 0.80895637 0.82452431 0.83240438
  0.8372093  0.82740727 0.84412839 0.8374015 ]
 [0.62072662 0.64240619 0.65920191 0.67480643 0.671352   0.67051817
  0.66265634 0.66515783 0.66372841 0.66670637]
 [0.60529217 0.61379745 0.61300992 0.62671287 0.62592534 0.63710821
  0.63899827 0.6553788  0.6492361  0.65348874]
 [0.6540404  0.68181818 0.66919192 0.68560606 0.67929293 0.6969697
  0.7020202  0.71969697 0.71590909 0.70707071]
 [0.71240409 0.7258312  0.70575448 0.69782609 0.69245524 0.70383632
  0.71534527 0.72173913 0.72212276 0.73299233]
 [0.6547619  0.68809524 0.69285714 0.73809524 0.7547619  0.73809524
  0.74285714 0.73571429 0.72142857 0.73809524]
 [0.71126402 0.71508665 0.7341998  0.73955148 0.76783894 0.77471967
  0.78542304 0.78007136 0.79357798 0.79714577]
 [0.76790541 0.76013514 0.73108108 0.72702703 0.71283784 0.72195946
  0.72972973 0.74324324 0.73277027 0.75033784]
 [0.74777859 0.76799543 0.78421782 0.78845684 0.80133692 0.81323877
  0.82098313 0.82481454 0.83060243 0.83076547]
 [0.56235094 0.50511073 0.45741056 0.43083475 0.39318569 0.38057922
  0.37870528 0.37069847 0.37478705 0.3637138 ]]


Train losses per communication round:  [1.1863790917361134, 1.000484754142129, 0.8463794284527537, 0.760102154954543, 0.7212414424002941, 0.676319178621525, 0.639021434216264, 0.6174528627105015, 0.5999883197593852, 0.5719222672615066]
Test losses per communication round:  [12.135800096392632, 10.940048938989639, 9.822232669591903, 9.402062985301018, 10.581622920185328, 9.015947344899178, 8.981567414104939, 9.07225397527218, 8.73300763219595, 8.422882432490587]
Test weighted accuracies per communication round:  [0.6458958267002238, 0.673921034638195, 0.688606586666308, 0.6940125938579977, 0.644803282108378, 0.6973014598712626, 0.7034933845807855, 0.7062496201836493, 0.7119200175904034, 0.7155507614195372]
Test losses per communication round for each client:  [[14.58573496 12.53560436 11.67854172 10.18916094 14.03218198 10.34295809
   9.92810422  9.64935929  9.22368455  9.21700823]
 [16.63095629 12.08935893 10.07566792  8.65055388 10.08724433  7.74663854
   7.92065597  7.43480289  7.14589018  7.28585261]
 [10.28635377  8.73588622  7.20608905  7.12112963  8.16826138  7.02361375
   7.01693076  6.23187631  6.48777044  6.70264798]
 [11.63565618  9.95492959  8.92724496  8.31734186 10.14573771  8.59271753
   8.0375284   7.88351908  8.81077331  7.77416432]
 [13.81026757 12.05721074 10.71128827 10.9339081  13.01703212  9.32396156
   9.87164938 12.52721488  9.59631032  8.67549461]
 [10.29957181  9.04189241  7.05723417  5.99882776  7.99995577  5.41630536
   6.99237609  6.4410055   4.7966436   4.91201809]
 [ 9.78615874 12.28113055  9.42229417  9.7865532  12.50129551  9.43022496
   9.23800629  9.81309909  9.75579005  9.98227173]
 [ 8.90426734  9.08911461  9.06517905  8.65872359  6.37358356  7.69176447
   6.43675423  6.25496086  6.38059142  6.37530068]
 [11.39195472  9.70018393  8.58798695  8.58939871  8.81168565  8.09798029
   7.52737392  7.69094861  7.42384955  6.7489344 ]
 [14.02707958 13.91517806 15.49080044 15.77503216 14.67925119 16.4933089
  16.84629488 16.79575324 17.7087729  16.55513167]]
Test accuracies per communication round for each client:  [[0.57384295 0.60322413 0.6349454  0.64066563 0.52964119 0.6549662
  0.66978679 0.67706708 0.67836713 0.69032761]
 [0.49333333 0.59333333 0.64916667 0.69583333 0.625      0.72875
  0.72041667 0.74083333 0.75166667 0.74208333]
 [0.74232521 0.75876411 0.77609428 0.78282828 0.75351555 0.78263022
  0.80204001 0.80025748 0.7979798  0.79669241]
 [0.67970037 0.71041199 0.71610487 0.72029963 0.69018727 0.70516854
  0.69378277 0.68958801 0.6940824  0.7047191 ]
 [0.552589   0.60355987 0.62257282 0.62419094 0.50444984 0.63147249
  0.63228155 0.64037217 0.65291262 0.68446602]
 [0.67632748 0.73291728 0.76179395 0.78770891 0.76274593 0.81489317
  0.82674    0.83710599 0.83922149 0.84334673]
 [0.68169014 0.65881349 0.63952198 0.65215536 0.6388391  0.64088775
  0.63132736 0.62535211 0.61613316 0.59795134]
 [0.76908612 0.76871004 0.77472734 0.78901843 0.80218127 0.79315532
  0.80180519 0.80895073 0.81083114 0.81722452]
 [0.74235808 0.76855895 0.79039301 0.77729258 0.73799127 0.77292576
  0.79475983 0.79039301 0.80349345 0.79912664]
 [0.5694725  0.52210999 0.45319865 0.43075196 0.49180696 0.37261504
  0.34006734 0.32547699 0.33468013 0.31851852]]



# federated non-IID 1.0 with pre-training
Train losses per communication round:  [1.1194551599202238, 0.8462555050509375, 0.7345112182607919, 0.6857488978175611, 0.6583209218027621, 0.6333532892680589, 0.6166182602552394, 0.6044630708465073, 0.5901921934511988, 0.5808607628400088]
Test losses per communication round:  [10.209782922267914, 9.335446593910456, 7.88171481769532, 8.693755788356066, 7.240488250902854, 7.200266283750534, 6.971566624194383, 6.9612025916576385, 6.696477057039738, 6.684556484222412]
Test weighted accuracies per communication round:  [0.7091939365781949, 0.7344752914954179, 0.7467708399178138, 0.6975078923013853, 0.7594418373516066, 0.7621454977878314, 0.765284284445518, 0.7705593676921169, 0.7732700152013318, 0.7762588124276735]
Test losses per communication round for each client:  [[10.26536298  7.92035329  8.06576383  9.12433684  6.37860388  6.79149246
   6.72236127  6.0944716   5.99544737  6.11580175]
 [13.21556509 12.4585067  10.88376558 10.87055796 10.36276573  9.83639926
   9.71479481  9.44757921  9.25238365  9.26208216]
 [ 9.45487863  9.59861165  7.35176755  8.42423779  7.41524595  7.55008721
   6.48679696  8.85316372  6.70091844  7.26879281]
 [13.28972602 11.21029811 10.57750893 10.64701061 10.28973055  9.60800219
  10.6407671   8.98029566  9.02778286  8.79581571]
 [ 8.6461077   7.63165498  6.27096117  8.26299304  5.64756276  6.53161108
   6.43644106  5.69172502  5.34512751  5.91723379]
 [ 9.71319449  8.37468082  7.34635442  8.59513533  6.58546662  6.39545131
   6.34097397  6.16143322  6.00336444  6.0155924 ]
 [10.11099094  7.66612832  8.54577148  7.95927948  6.77066964  6.22933397
   5.96965776  6.31371343  6.24992913  6.35165614]
 [10.33788049  7.64242955  6.62516286  7.19789877  6.11846066  6.81205541
   6.13732979  6.80995494  7.30346447  6.20585304]
 [ 8.87787822 14.0327602   7.02353982  8.61451709  7.28523457  6.79026714
   6.00443319  6.21816668  5.89154443  5.99822295]
 [ 8.18624467  6.81904233  6.12655252  7.24159098  5.55114216  5.45796281
   5.26211032  5.04152244  5.19480827  4.91451409]]
Test accuracies per communication round for each client:  [[0.71235449 0.74483665 0.75873075 0.69695832 0.77806985 0.77619226
  0.78013519 0.78445362 0.79027413 0.79290274]
 [0.58851224 0.5913371  0.60282486 0.54482109 0.60301318 0.6079096
  0.59905838 0.61544256 0.6180791  0.62071563]
 [0.73005319 0.73309271 0.74544073 0.71143617 0.74791033 0.7543693
  0.75702888 0.76576748 0.76481763 0.76918693]
 [0.63210702 0.65121835 0.65886288 0.58337315 0.66889632 0.67367415
  0.66555184 0.67892977 0.68227425 0.68800764]
 [0.73452915 0.77823074 0.78915614 0.71015084 0.80660416 0.8101916
  0.81296372 0.81785569 0.82128007 0.81997554]
 [0.69920844 0.72849604 0.74116095 0.68456464 0.75949868 0.76266491
  0.7621372  0.76992084 0.77585752 0.77572559]
 [0.73392988 0.75785245 0.77045289 0.75511322 0.78305332 0.78597516
  0.78889701 0.79163623 0.79766253 0.79821037]
 [0.73999455 0.77212088 0.78627825 0.76803703 0.79880207 0.79934658
  0.80860332 0.80588075 0.81214266 0.80778655]
 [0.74915431 0.75956284 0.77101223 0.73900598 0.77907884 0.78272183
  0.79260994 0.79547229 0.79339058 0.7996357 ]
 [0.74542587 0.78611987 0.80063091 0.7511041  0.81388013 0.81987382
  0.83438486 0.83312303 0.82555205 0.8362776 ]]


Train losses per communication round:  [1.0581071859998183, 0.7986374090511535, 0.7020126056027836, 0.6473333015220473, 0.6157213299112454, 0.5944485539099278, 0.5817446431453055, 0.5686975378328184, 0.5587303566886249, 0.5478060343427297]
Test losses per communication round:  [10.023142240343441, 8.55232799090445, 8.144923270493745, 7.300544361636275, 7.116036663949489, 6.7775999933481215, 6.850230056047439, 6.93518545255065, 6.693603640794754, 6.475672754331026]
Test weighted accuracies per communication round:  [0.7106502859554967, 0.7352836500504656, 0.7458835122290626, 0.7549550689819813, 0.7601072858922776, 0.7642995716129106, 0.7683787155001058, 0.7727373915292893, 0.7715497114124432, 0.774529887835113]
Test losses per communication round for each client:  [[ 8.37310482  7.29818031  6.27710474  6.56048095  5.73835346  5.9485521
   5.42077976  5.85711077  5.80689597  5.29843685]
 [ 8.26922017  7.16424984  6.44759989  6.20188355  5.87941676  5.74435616
   5.61586592  5.44559693  5.50494057  5.43985358]
 [10.21881384  8.62408906  7.8054769   7.43795872  6.98368776  6.69627434
   6.59997153  6.45922989  6.31373483  6.30947912]
 [10.9597522   9.21198732  8.57634598  8.08208734  7.88523191  7.70029783
   7.66712999  7.30910254  7.34786987  7.35506338]
 [11.49217039  8.72078788  8.22185314  8.22172499  8.01470757  7.27299127
   7.50342447  8.46599388  7.37474602  7.04340464]
 [10.38047695  9.03632867  7.91233355  8.55997944  7.80347729  6.77819598
   6.7939468   6.36343106  6.89932227  6.71965927]
 [ 8.12275284  6.59913829  7.73653948  5.9298242   5.96968284  5.90530574
   5.4511551   6.25297716  5.7683734   4.76816585]
 [10.74016702  9.88236111  9.03677726  8.36806446  8.46804249  8.60842597
   8.11708763  8.22349602  8.92594069  9.40038759]
 [10.79363704  8.36661041  8.52827287  6.07072881  6.92306381  5.75961113
   6.86980173  6.3579278   5.8443644   5.21761143]
 [10.88132712 10.61954701 10.9069289   7.57271115  7.49470274  7.36198941
   8.46313763  8.61698848  7.14984837  7.20466584]]
Test accuracies per communication round for each client:  [[0.73209599 0.75084364 0.763967   0.7664042  0.77671541 0.77877765
  0.78552681 0.7872141  0.784027   0.78646419]
 [0.74851852 0.77203704 0.78185185 0.79       0.79888889 0.80074074
  0.805      0.81351852 0.80666667 0.81074074]
 [0.69613527 0.73043478 0.74903382 0.75772947 0.76425121 0.77439614
  0.77753623 0.78405797 0.78429952 0.78502415]
 [0.65643777 0.67360515 0.67639485 0.68025751 0.68648069 0.68583691
  0.68776824 0.69914163 0.69463519 0.69420601]
 [0.69464985 0.72161809 0.72901261 0.74010439 0.74032188 0.74510657
  0.75206612 0.74989126 0.75315355 0.75119617]
 [0.70838941 0.73366233 0.75056079 0.75385076 0.75654255 0.76312248
  0.76028114 0.7662629  0.76880514 0.77209511]
 [0.74900292 0.77293273 0.78117522 0.79898963 0.80670035 0.81175219
  0.81866525 0.81893114 0.81414517 0.82291944]
 [0.66454314 0.68456498 0.68820531 0.69384783 0.69257372 0.68984347
  0.69275573 0.695668   0.69694212 0.6989443 ]
 [0.74287645 0.77137065 0.78443518 0.79952697 0.80425724 0.81146526
  0.81473139 0.81856065 0.82250253 0.82633179]
 [0.6683825  0.69293209 0.70619679 0.71075035 0.714314   0.71965947
  0.72579687 0.73153831 0.72579687 0.73094437]]


Train losses per communication round:  [1.0637113852889235, 0.7939602401320831, 0.6892237847920539, 0.6393736747399208, 0.6092666969708687, 0.5881820825294396, 0.5732526916550564, 0.5625618067270859, 0.5500647389172448, 0.5435717718686137]
Test losses per communication round:  [10.73879849622026, 8.534240593016147, 7.397145534760784, 7.2000451646745205, 7.160045175999403, 6.899183216469828, 6.93421899676323, 6.7410927065182475, 6.994131139013916, 6.74760941984132]
Test weighted accuracies per communication round:  [0.7205781721170477, 0.7416038085707115, 0.7520875099011224, 0.7578988224579568, 0.7633149517464554, 0.7691320674008473, 0.7689606874055508, 0.770868381653, 0.7734026731230135, 0.7756732168171705]
Test losses per communication round for each client:  [[ 8.31233515  7.42841733  6.73266524  6.11371866  6.06981105  5.85629669
   5.91865909  6.16523075  6.20553854  5.85394651]
 [10.45661509  7.16169209  6.38130484  6.70233411  5.96963903  5.64853574
   6.4883281   5.35801872  5.44183113  5.1443147 ]
 [12.97014761  9.14686853  8.98771381  8.45808578  8.03785205  7.02963576
   7.4568792   6.94830309  7.31187743  7.08168963]
 [10.7008242   8.0922358   6.88768685  6.60534753  7.71018916  6.55718118
   6.03827436  6.18515539  6.75027633  5.78343506]
 [ 9.11854715  8.54192823  7.75930977  7.14351969  8.15358001  6.90891723
   6.83256491  8.07308638  6.79622887  7.27244449]
 [10.15944285 11.11553478  7.88212586  8.50244886  7.70614377  9.43748039
   7.86801422  7.84043241 10.95553881  9.27149016]
 [12.93254226 11.04494554  9.73535582  9.55831224  9.4021686   9.05317459
   9.17299002  8.88142046  8.58548191  9.1087172 ]
 [14.44757038  6.45032317  5.8572428   5.72198731  5.34140264  5.69993213
   5.7527318   4.78360763  4.88251039  4.85669656]
 [ 9.53235281  7.5074836   6.73421077  6.49415547  6.38694462  6.42512649
   7.02069059  5.93891042  6.08076262  6.41344425]
 [ 8.75760746  8.85297686  7.01383957  6.70054202  6.82272083  6.37555197
   6.79305768  7.23676181  6.93126535  6.68991566]]
Test accuracies per communication round for each client:  [[0.74369069 0.78124369 0.79063194 0.80294771 0.81061983 0.81576822
  0.81809005 0.82010902 0.82323844 0.8272764 ]
 [0.73548689 0.76708801 0.77879213 0.78534644 0.79190075 0.80009363
  0.79822097 0.80337079 0.79985955 0.80383895]
 [0.67337755 0.69824728 0.71530081 0.72501184 0.73756514 0.74727617
  0.74182852 0.74514448 0.75248697 0.7565135 ]
 [0.73581414 0.74856086 0.75904605 0.76377467 0.76644737 0.77220395
  0.77631579 0.77508224 0.78166118 0.77652138]
 [0.70752089 0.70659239 0.71247292 0.71959146 0.72191272 0.72346023
  0.72516249 0.72949551 0.73336428 0.74373259]
 [0.68069916 0.701871   0.7080256  0.7080256  0.7267356  0.72624323
  0.73067454 0.73559823 0.73338257 0.74076809]
 [0.65076551 0.66285254 0.6715552  0.66349718 0.66027397 0.67445608
  0.66623691 0.65302176 0.66091861 0.65656728]
 [0.76866942 0.80150815 0.81367064 0.82850888 0.83094138 0.83142788
  0.83410362 0.84067137 0.84237412 0.84407687]
 [0.74994689 0.76991714 0.77905248 0.78648821 0.791587   0.79774803
  0.79498619 0.7928617  0.80220948 0.80008498]
 [0.72977658 0.73632512 0.7498074  0.75231125 0.75308166 0.75751156
  0.75828197 0.76540832 0.76309707 0.76598613]]


Train losses per communication round:  [1.0703698079705017, 0.802782314415665, 0.7002631642298739, 0.6501704508781976, 0.6211399012567985, 0.6021109371896346, 0.5978663900839398, 0.5686160690715586, 0.5594917162067488, 0.5556104440009595]
Test losses per communication round:  [9.904367804781213, 8.20098946434373, 7.980704392492771, 7.367521139979362, 6.991204755404032, 6.82487688884139, 6.570459045469761, 6.790769995003939, 6.675600582407787, 6.297303832262696]
Test weighted accuracies per communication round:  [0.7107426604949219, 0.7386085935034973, 0.750127822071513, 0.7594012561828601, 0.765401732212004, 0.7692180163663002, 0.7728919290404189, 0.7746199465352401, 0.7773487156688256, 0.7781614058935898]
Test losses per communication round for each client:  [[10.08877364  8.26942681  7.62966941  7.48022985  6.89645453  7.01412034
   7.09272909  6.86128524  6.64814144  6.34096554]
 [ 9.57446319  8.13446248  7.08509368  6.71653873  6.46770275  6.20828068
   6.11753923  6.05817395  5.96914577  6.01897109]
 [ 9.40624743  7.74608023  7.5894776   6.73136631  6.06808312  7.29084408
   6.58370656  5.77254345  7.8382802   5.5425543 ]
 [10.51459542  9.24100339  9.13415289  8.69649267  8.0472613   6.92284795
   6.96034876  7.39212441  7.63087291  6.81664011]
 [11.31563962  8.55028069  8.33116305  8.57315928  7.97030294  7.28011253
   7.09049505  6.98030008  7.29225916  7.30741364]
 [10.79912186  8.91263694  8.08716184  7.73797739  8.13125336  7.33122879
   7.06766099  7.13376391  7.0904122   6.60000482]
 [ 6.60145963  5.40682544  5.30843565  5.60625279  4.65983018  4.86679119
   4.53190424  4.8115598   4.22165129  4.22154096]
 [ 9.87825543  8.982822   10.17797893  7.04402155  7.58821929  7.65036464
   7.04122907  6.92443395  6.92116943  6.67601764]
 [10.22625047  8.58049476  8.12447989  7.76117176  7.17606509  6.71938822
   6.7004317   6.60580945  6.46557009  6.37068102]
 [10.63887137  8.1858619   8.33943099  7.32800108  6.90687501  6.96479046
   6.51854577  9.3677057   6.67850333  7.07824922]]
Test accuracies per communication round for each client:  [[0.69654927 0.72465315 0.7451085  0.7568481  0.76663109 0.76752046
  0.77854856 0.77516898 0.77659196 0.77392387]
 [0.71174551 0.7314845  0.75040783 0.75807504 0.76166395 0.76688418
  0.76721044 0.76867863 0.7721044  0.76933116]
 [0.71700393 0.76094835 0.77136817 0.78178798 0.7846572  0.78888553
  0.79130172 0.79568106 0.79326487 0.80202356]
 [0.68890574 0.71038666 0.71556735 0.72024261 0.72757139 0.73136214
  0.73666919 0.74197624 0.74045994 0.74323983]
 [0.69677419 0.71612903 0.72534562 0.72940092 0.73585253 0.74359447
  0.74304147 0.74156682 0.75225806 0.74857143]
 [0.71035941 0.72467068 0.741584   0.74532444 0.75280533 0.75557001
  0.7589852  0.76061148 0.76402667 0.7641893 ]
 [0.80323873 0.8323176  0.8392826  0.84729236 0.85025248 0.84990423
  0.85443148 0.85599861 0.85948111 0.85965523]
 [0.70917874 0.74202899 0.75201288 0.76618357 0.77165862 0.78357488
  0.78582931 0.78679549 0.79066023 0.79033816]
 [0.71307779 0.74154453 0.75676437 0.77367531 0.77564825 0.77621195
  0.78325817 0.78635851 0.79143179 0.79058625]
 [0.70745391 0.74512423 0.75046754 0.76275715 0.77130644 0.77397809
  0.77531392 0.77825274 0.7793214  0.78279455]]


Train losses per communication round:  [0.999135966346018, 0.7708197869822835, 0.6782886682617402, 0.629591909033891, 0.6016572135468639, 0.5825532198768022, 0.5621327633701708, 0.5552852524664023, 0.5472484362537822, 0.5368945708794699]
Test losses per communication round:  [11.079659205675124, 8.34741964861314, 8.029402434825897, 7.551717698574066, 6.992204777896404, 6.788435902446508, 6.613186567918456, 6.327309223636985, 6.219939467590303, 6.27733256984502]
Test weighted accuracies per communication round:  [0.6896616284537495, 0.7395216261855038, 0.7509686508389671, 0.7599507782958105, 0.7632468320864302, 0.7685179455101895, 0.771546466211387, 0.7749741610920161, 0.7786456123542363, 0.7804616781856433]
Test losses per communication round for each client:  [[10.92057759  6.67747486  5.86916161  5.53877437  4.9647879   5.00551224
   4.90488708  4.57324043  4.59434244  4.40224519]
 [11.45984298  7.91971397 11.57029754  6.7240234   6.2793382   5.84400257
   6.15945274  5.6344189   5.7127016   5.56079247]
 [ 9.98657757  8.39499563  7.56270248  7.13952917  7.25146371  6.73021561
   6.59821898  6.63469195  6.50927842  6.47739202]
 [11.22200334  9.46504301  7.85163665  8.02108544  7.35954714  7.43932247
   7.59255028  6.92058241  6.83978525  6.97315931]
 [13.52982783  9.46313584  8.90439868  8.43048811  7.74387383  7.88883972
   7.67510706  7.51920807  7.5145911   7.31178421]
 [ 7.68287987  7.78850216  7.07761025  7.09060371  7.5917604   7.56519669
   6.97681653  6.26958119  6.81288135  6.32486376]
 [14.83699322  9.14024776  8.62231785  8.0662725   6.72706398  7.32599145
   7.08739573  6.04591699  6.16345504  7.48528624]
 [11.53761715  7.32664543  8.14027756 10.81537586  8.09490114  6.07358452
   5.93931395  6.37008116  5.83836921  5.74376839]
 [11.79490894 10.89461941  8.75051582  8.0129053   8.38947439  8.63986462
   7.8429997   8.08097631  7.08864066  7.32656026]
 [ 7.82536358  6.40381843  5.94510591  5.67811912  5.51983708  5.37182912
   5.35512364  5.22439483  5.12534961  5.16747385]]
Test accuracies per communication round for each client:  [[0.69850746 0.78251599 0.79509595 0.80234542 0.81876333 0.81428571
  0.81855011 0.82857143 0.82921109 0.83560768]
 [0.72047918 0.75641757 0.76996577 0.77837992 0.78137479 0.78793497
  0.79321164 0.79820308 0.80019966 0.80162578]
 [0.67772926 0.71484716 0.73755459 0.74497817 0.73253275 0.75480349
  0.75676856 0.75262009 0.7569869  0.75938865]
 [0.65985998 0.71849475 0.73045508 0.7403734  0.74824971 0.74445741
  0.74533256 0.75525088 0.75670945 0.75554259]
 [0.58415546 0.67698057 0.68161435 0.69312407 0.71390135 0.7064275
  0.71136024 0.71405082 0.71554559 0.72212257]
 [0.76341682 0.7450805  0.75447227 0.76207513 0.75268336 0.76788909
  0.77347943 0.76923077 0.77437388 0.77862254]
 [0.6425162  0.73900443 0.74855097 0.75656325 0.77378111 0.76832595
  0.77344016 0.77940675 0.78571429 0.78588476]
 [0.73960442 0.75035041 0.75533406 0.76872761 0.75377667 0.76903909
  0.77168665 0.77184239 0.77869491 0.7830556 ]
 [0.65095805 0.71707233 0.73226308 0.74244778 0.74434663 0.75539444
  0.76160884 0.7621267  0.76730537 0.76471604]
 [0.7570297  0.78415842 0.79267327 0.7990099  0.80217822 0.80712871
  0.8049505  0.80990099 0.81405941 0.81188119]]


# federated non-IID 10.0 with pre-training
Train losses per communication round:  [1.2163450246078824, 0.8835064991032878, 0.7854918354209144, 0.7349207656591267, 0.7071086816900942, 0.6861916329182243, 0.6749377386167114, 0.6593128907285808, 0.6508911782068851, 0.6407612282073888]
Test losses per communication round:  [10.852269506454467, 8.150018239207565, 7.6225997395813465, 7.121725017204881, 7.2130646231235005, 6.888873843243346, 6.794529248401522, 6.511766782402992, 6.433518607914448, 6.516112807393074]
Test weighted accuracies per communication round:  [0.7214868839660178, 0.740509220777203, 0.7505541467325157, 0.759106130253642, 0.7635123129556213, 0.7665215938523398, 0.7705330853005532, 0.7731294721037008, 0.7751878603473202, 0.7767127251795887]
Test losses per communication round for each client:  [[10.6062507   8.68236005  7.72680295  7.12887925  6.95034152  8.19358075
   6.64494526  6.42180055  6.70351797  6.21993928]
 [ 8.46850526  6.95766377  6.46686089  6.1398682   5.95506698  5.77045971
   5.7061978   5.53883547  5.44658026  5.44674647]
 [ 9.43424749  7.69093537  7.11838704  6.78839821  6.51663131  6.2859714
   6.21700495  6.1915971   6.07570404  5.9716019 ]
 [11.66194844  7.88863882  7.61376739  7.34732383  6.95001265  6.64326219
   7.29972601  6.63420796  6.28282717  6.62416464]
 [ 9.59289306  7.77961695  7.09625304  6.7532934   6.56590426  6.42739958
   6.26975328  6.19946975  6.12295032  6.01114255]
 [12.87698728  8.16554627  9.61665243  7.71683228  9.91507691  6.85127885
   8.60491163  6.6139091   7.20619404  7.31234765]
 [ 9.49203789  8.4460153   7.17386068  6.79405598  6.46816772  6.83979487
   6.20661383  6.53752571  5.96615617  5.82628398]
 [11.45505637  9.32528979  7.65078732  7.60376114  7.21865758  7.27823287
   7.41204429  7.59263301  6.63426307  6.92941231]
 [11.93834555  8.49378783  8.45113474  8.14682901  7.45872557  8.26031256
   7.39399123  7.13648489  7.52082568  7.05629367]
 [12.99642301  8.07032824  7.31149092  6.79800889  8.13206172  6.33844565
   6.19010421  6.25120428  6.37616736  7.76319563]]
Test accuracies per communication round for each client:  [[0.72984045 0.74622682 0.75571367 0.76627857 0.76326003 0.76735662
  0.7753342  0.7774903  0.77878396 0.7796464 ]
 [0.75283993 0.76626506 0.77177281 0.78020654 0.78399312 0.79018933
  0.7908778  0.79776248 0.79879518 0.79862306]
 [0.7182266  0.73793103 0.74794745 0.75320197 0.76190476 0.77175698
  0.77389163 0.77586207 0.77684729 0.77799672]
 [0.72264355 0.74485374 0.75297941 0.76381365 0.77157819 0.76652221
  0.77356446 0.77735645 0.78259299 0.77807873]
 [0.72286213 0.7460733  0.7582897  0.76300175 0.76980803 0.77277487
  0.77556719 0.77678883 0.77591623 0.77993019]
 [0.70618361 0.73235964 0.74127466 0.75417299 0.75151745 0.75796662
  0.76251897 0.7642261  0.76460546 0.76669196]
 [0.72172988 0.74388515 0.75487416 0.76462247 0.76621765 0.7731301
  0.77809287 0.78216944 0.78447359 0.79032258]
 [0.71749897 0.7294676  0.74494428 0.74659513 0.75484936 0.75257945
  0.75815105 0.75711927 0.76557986 0.76805613]
 [0.70265882 0.72315811 0.73249442 0.74000406 0.74568703 0.74426629
  0.74690481 0.74954333 0.74913741 0.75035519]
 [0.7245509  0.73979314 0.74904736 0.76410815 0.76882598 0.772818
  0.77481401 0.77789875 0.77898748 0.78098349]]


Train losses per communication round:  [1.3321907794558734, 0.9095415282870295, 0.7944965023735974, 0.7370570906829346, 0.7079568080014195, 0.6846704029451082, 0.6647154270936989, 0.6539851147343091, 0.6422994870482462, 0.6360120015371076]
Test losses per communication round:  [10.940156486630439, 8.677604461461305, 7.9344874426722525, 7.615883589535952, 7.142777098715305, 6.852618356049061, 6.624462434649468, 6.603749958425761, 6.4604846552014354, 6.524951016902923]
Test weighted accuracies per communication round:  [0.7216170325052625, 0.7432808025705661, 0.7561262653013693, 0.7635266519153942, 0.7674979382181981, 0.7707320290875128, 0.7737495276952625, 0.777137388445419, 0.779538802359785, 0.7801408331175113]
Test losses per communication round for each client:  [[10.18995941  8.46452838  8.51997262  7.12217543  7.0636462   6.80783093
   6.94206035  6.22474089  6.20500699  6.4758321 ]
 [ 9.26151145  8.74917448  7.65642637  7.11416185  5.99355565  5.94422957
   5.9926879   6.18017152  6.05961928  5.89604092]
 [12.79221511  8.43022585  7.91778255  8.1028955   6.77982917  6.70128313
   6.51637399  6.46705562  7.00715178  6.64867783]
 [10.17095339  8.28435028  7.55407345  7.15240151  6.85697389  6.63419122
   6.51495939  6.41994762  6.37171513  6.18819916]
 [ 9.80094808  8.67506826  7.23043652  7.03686422  7.15247256  6.50454265
   6.28828833  7.33875912  6.53938931  6.53222978]
 [11.20068255  9.49734694  9.55940956  8.15555996  7.74053323  8.78986019
   7.77870387  7.22609812  7.26657587  7.15022936]
 [10.67125362  8.54383746  7.92443642  8.57987905  7.80898839  7.27841222
   6.72677514  7.0152123   6.67500502  6.5658325 ]
 [11.69023162  9.19132262  8.27763438  8.53520775  7.4498421   6.73273164
   6.93289477  6.54628617  6.55726859  6.57643354]
 [13.40901768  9.02619368  7.30618641  6.68839423  6.95276225  6.23383214
   6.41013542  6.02203057  5.84663502  7.06250018]
 [10.21479195  7.91399667  7.39851615  7.67129642  7.62916756  6.89926988
   6.14174519  6.59719765  6.07647956  6.1535348 ]]
Test accuracies per communication round for each client:  [[0.72088313 0.74296131 0.75592465 0.76119101 0.76929309 0.77131861
  0.77739518 0.77800284 0.77921815 0.77881304]
 [0.74278677 0.7624912  0.7770936  0.7885292  0.79152006 0.79539057
  0.79451091 0.79802956 0.80242787 0.80348346]
 [0.7251462  0.74427059 0.75343765 0.76813656 0.76750435 0.77382646
  0.77556504 0.78078078 0.78062273 0.78315157]
 [0.71381119 0.73199301 0.74772727 0.75017483 0.75262238 0.75716783
  0.76223776 0.76573427 0.76765734 0.7701049 ]
 [0.73758865 0.75795599 0.7668667  0.7739589  0.77995999 0.78450627
  0.78923441 0.78505183 0.78723404 0.7881433 ]
 [0.69282169 0.70313097 0.71496754 0.72508591 0.72890416 0.73844979
  0.73997709 0.74551355 0.74684994 0.74684994]
 [0.71372985 0.74596998 0.76005188 0.76394293 0.76950157 0.77524551
  0.77561608 0.780063   0.780063   0.78506578]
 [0.70724223 0.7346563  0.74897709 0.75347791 0.76247954 0.75572831
  0.75797872 0.76718494 0.77045827 0.76800327]
 [0.73122209 0.75720666 0.77365002 0.78034917 0.78075518 0.78095818
  0.78278522 0.78765733 0.79354446 0.78989038]
 [0.73110492 0.75246054 0.7630455  0.76935933 0.77233055 0.77307335
  0.7814299  0.781987   0.78681523 0.78662953]]


Train losses per communication round:  [1.213741134361532, 0.8697975762090129, 0.7738081275629891, 0.7257083380923559, 0.6952588324468534, 0.6728957990046246, 0.6549083193852727, 0.6434876977918902, 0.6316249635018211, 0.6321377979258169]
Test losses per communication round:  [10.983299856446683, 8.36545700605493, 7.565948138386011, 7.300408360891742, 6.816094560921192, 6.800284203514456, 6.8834797568619255, 6.484227629002726, 6.212077761441333, 6.268821095830935]
Test weighted accuracies per communication round:  [0.7265824382430782, 0.7491246481337149, 0.7577991516826141, 0.7662589152348892, 0.770752516842099, 0.7749857196542906, 0.7763722788401621, 0.7799192086954292, 0.7815903120562834, 0.7822466715428802]
Test losses per communication round for each client:  [[ 8.85271529 11.16650087  6.81757011  8.56588876  6.26203862  6.10216156
   6.04947584  5.79075575  5.75527522  5.80904889]
 [10.96586555  8.11912778  7.68601292  8.12336099  8.13271803  6.86664152
   6.5109553   6.37819171  6.48193738  6.38301721]
 [12.80060846  8.03051459  9.19603932  7.16577137  7.71152693  6.91068201
   6.80622716  6.88581994  6.46697972  7.93134665]
 [ 9.75243843  8.21420658  7.5415014   7.20508301  6.96219873  6.69577599
   6.63252604  6.56486166  6.44051892  6.42700011]
 [ 9.82786989  8.31655318  7.84739757  7.32249671  6.5640828   6.09739674
   7.52656847  6.78853583  6.21251091  6.04818252]
 [ 9.56450466  8.2225183   7.44922213  7.18076795  6.78936543  6.70380238
   6.53047326  7.11650389  6.54354024  6.37842309]
 [ 8.47413024  7.96659821  6.60567462  6.37901443  5.85956186  6.25475806
   5.92293996  5.95093417  5.75596708  5.46297713]
 [11.25470352  8.60871336  8.17109311  7.52822226  7.12973842  6.98923615
   7.2788676   6.74080619  6.61352816  6.39420751]
 [ 9.73566729  7.60752895  7.41002446  7.05623209  6.45753473  8.22924781
   6.37931138  5.97983189  5.89321573  5.97211611]
 [18.60449523  7.40230825  6.93494573  6.47724601  6.29218006  7.15313983
   9.19745255  6.64603525  5.95730425  5.88189173]]
Test accuracies per communication round for each client:  [[0.74163979 0.7618401  0.77491088 0.77966389 0.78526566 0.78866067
  0.78900017 0.79273468 0.79103718 0.79290443]
 [0.7222709  0.74469949 0.75363589 0.76082005 0.76239706 0.76782898
  0.77273524 0.7739618  0.77834239 0.77974417]
 [0.7204731  0.74479427 0.74762619 0.75262369 0.75428952 0.75778777
  0.76245211 0.76428452 0.76811594 0.76545061]
 [0.70928962 0.73132969 0.73752277 0.74790528 0.74863388 0.75737705
  0.75318761 0.75865209 0.76284153 0.76429872]
 [0.73364226 0.75532901 0.76533828 0.77312326 0.78609824 0.78202039
  0.78535681 0.78813716 0.78980538 0.8       ]
 [0.71178034 0.73728964 0.74348981 0.75535872 0.76031887 0.76669619
  0.76705049 0.77077059 0.76970771 0.77183348]
 [0.74514752 0.77348602 0.78299689 0.79328416 0.80298913 0.80590062
  0.81036491 0.81075311 0.81638199 0.81055901]
 [0.71554252 0.72825024 0.73939394 0.75092864 0.74956012 0.7544477
  0.75464321 0.7659824  0.76500489 0.76441838]
 [0.72878373 0.75361752 0.76300352 0.76965194 0.77571373 0.77962456
  0.77962456 0.7821666  0.78314431 0.78431756]
 [0.73947896 0.76263638 0.77243376 0.78089512 0.78334447 0.79091516
  0.79113783 0.79336451 0.79336451 0.78980183]]


Train losses per communication round:  [1.1911921712135454, 0.8825465131551397, 0.7808299855064297, 0.7236333199880024, 0.6938208072742362, 0.6793198166374066, 0.6565467243429828, 0.6457995355135072, 0.6373395075086923, 0.6307960864456973]
Test losses per communication round:  [10.66374446451664, 8.397574757784605, 7.654462759569287, 7.5354209370911125, 7.231375701725483, 6.6626568883657455, 6.9097558677196504, 6.615642303042113, 6.630892473459244, 6.460257817804814]
Test weighted accuracies per communication round:  [0.7229631128958137, 0.7438662109318634, 0.7551843952492209, 0.7622985528743985, 0.7667843730562774, 0.771691165074867, 0.7746635928010049, 0.7766520888979854, 0.7792431774918702, 0.7821721233525865]
Test losses per communication round for each client:  [[10.80931681  8.95726728  7.87517685  7.88906652  7.34126276  6.52615064
   7.82179481  7.24953002  6.39989358  5.96028677]
 [10.76807594  8.5218339   7.05958335  7.24314588  7.58234382  6.51708996
   7.29200184  6.7096929   6.53011638  6.03622928]
 [ 9.88568968  8.63021505  7.54254103  6.52946307  6.67126411  6.1501462
   6.01080388  5.88801162  6.01861325  6.90150398]
 [10.34569603  9.16827887  7.52333003  7.33286631  6.56382258  6.49333017
   6.51743779  6.2678518   6.24379411  6.05086178]
 [12.48450726  8.45089118  8.60192573  8.36685354  7.49248046  7.40543324
   6.91770622  7.11594695  6.70025897  6.5574065 ]
 [ 8.83821684  7.50106949  6.88679177  6.55532569  6.38966304  6.23799801
   6.11761892  5.99304962  5.83102733  5.77136558]
 [ 8.79113421  7.30708425  7.05127269  8.63150126  6.95087743  6.77593195
   6.81995076  6.72832882  7.65161639  7.41715878]
 [12.52162826  8.67779434  8.4540019   6.89915734  7.18714142  6.89379376
   6.83370101  7.0744108   6.98042858  6.77869785]
 [10.81704026  8.13391156  7.5959211   8.28423464  8.4203245   6.66326234
   8.05866933  6.36099495  7.54358232  6.40152878]
 [11.37613934  8.62740165  7.95408314  7.62259513  7.7145769   6.96343261
   6.70787412  6.76860556  6.40959382  6.72753888]]
Test accuracies per communication round for each client:  [[0.7321832  0.74779215 0.75888273 0.76730335 0.76627644 0.77387554
  0.77592935 0.77777778 0.78229616 0.78434997]
 [0.72839506 0.74537037 0.75405093 0.76099537 0.76253858 0.76813272
  0.77256944 0.77391975 0.77584877 0.77719907]
 [0.74299322 0.77120352 0.78384319 0.79007144 0.79483422 0.80197838
  0.80344385 0.80600843 0.80619161 0.80893937]
 [0.72259295 0.74528122 0.75729266 0.7729266  0.78036225 0.78436606
  0.78913251 0.79370829 0.79428027 0.79447092]
 [0.69988345 0.71969697 0.73504274 0.74184149 0.74747475 0.7488345
  0.75330225 0.754662   0.75602176 0.76165501]
 [0.73590734 0.753861   0.76312741 0.76795367 0.77220077 0.77335907
  0.77915058 0.77741313 0.78552124 0.78861004]
 [0.73549281 0.75714533 0.7680582  0.7706565  0.77654599 0.78191582
  0.78278192 0.79092326 0.78797852 0.79334835]
 [0.71485562 0.73651216 0.74677052 0.75322948 0.75816869 0.76329787
  0.76272796 0.76519757 0.76861702 0.76785714]
 [0.70818091 0.73461922 0.74908547 0.75257732 0.75773196 0.76504822
  0.76737612 0.76587961 0.76737612 0.77469238]
 [0.70995228 0.72869802 0.73773006 0.74744376 0.75357873 0.75852079
  0.76261077 0.7639741  0.76976823 0.77249489]]


Train losses per communication round:  [1.2070579262220067, 0.8819670041297065, 0.78048265139326, 0.7354570665435569, 0.7057397859138763, 0.683069768763608, 0.6702074141338348, 0.6514608450702594, 0.6466294361931315, 0.6349764453184364]
Test losses per communication round:  [9.928992311656476, 8.472815516218542, 7.762131323665381, 7.444151728523866, 7.377729484252631, 7.082732682675124, 6.794846711978607, 6.435655266372487, 6.789611070975662, 6.79290854781866]
Test weighted accuracies per communication round:  [0.7241440132078614, 0.7445784467468104, 0.7538207727663782, 0.761500933784327, 0.7647872160130254, 0.7673893138359419, 0.7724287302723407, 0.7749975428459779, 0.7765171780339537, 0.7789755934602477]
Test losses per communication round for each client:  [[ 9.75864464  8.54770291  7.51966748  7.46283454  7.53570664  6.87624425
   6.41974599  6.83501726  6.88138551  6.39382944]
 [ 9.23552322  7.57772135  7.44905263  6.79505288  7.32880229  7.62972224
   7.19456166  6.47586976  6.83690685  6.24590597]
 [ 9.32350184  8.72328055  7.80888182  7.30775702  7.81635004  7.13134921
   6.63810223  6.18097645  6.81151569  6.49815542]
 [ 9.20994318  8.92979264  8.26280963  7.14030457  6.97665954  6.56212029
   6.34053242  6.24225771  6.56428656  6.26556614]
 [ 9.89978313  8.31586233  8.63264859  7.49012464  7.21044466  6.57092011
   6.4258312   6.75353891  7.61748201  7.49209154]
 [11.27831048  9.77467573  8.10000271  8.13445818  8.00544536  7.28306279
   7.64495534  6.85160136  7.43043154  6.91997039]
 [ 9.16456518  7.69430503  6.93955261  6.58551157  6.75768769  6.26509374
   7.46851295  6.07563679  6.38135058  7.89177203]
 [11.2125836   8.59823477  7.61759251  7.24134868  7.69225687  6.38431539
   6.46943954  6.47585964  6.32701823  6.52182651]
 [ 9.98171896  8.12716272  7.69181424  9.25545526  7.60618961  6.44065675
   6.01439041  6.07684292  5.98132366  7.49720305]
 [10.22534889  8.43941712  7.59929102  7.02866995  6.84775215  9.68384206
   7.33239537  6.38895186  7.06441009  6.202765  ]]
Test accuracies per communication round for each client:  [[0.72052571 0.73869347 0.7481639  0.75492849 0.75763433 0.76014689
  0.76149981 0.76594511 0.77019714 0.77464244]
 [0.72557095 0.7499064  0.75758143 0.76544365 0.77311868 0.77405466
  0.78210408 0.78154249 0.78322726 0.78378884]
 [0.72745239 0.74487963 0.75889328 0.76536112 0.76607977 0.770212
  0.77326626 0.77811714 0.78081207 0.78099174]
 [0.73763148 0.75808337 0.76431632 0.76879626 0.77463966 0.77580834
  0.78262563 0.78554733 0.78593689 0.78710557]
 [0.71122011 0.73124872 0.74412426 0.7561823  0.75556918 0.75720417
  0.76088289 0.76905784 0.76987533 0.77273656]
 [0.70316479 0.71771553 0.72499091 0.73863223 0.74208803 0.74336122
  0.74954529 0.74990906 0.74790833 0.75081848]
 [0.74687382 0.77207275 0.7768094  0.78211444 0.78817734 0.79215612
  0.79442971 0.79234559 0.79575597 0.79897689]
 [0.71485149 0.73735374 0.75049505 0.75409541 0.76147615 0.7659766
  0.76957696 0.7729973  0.77407741 0.77947795]
 [0.73781572 0.75524724 0.77090004 0.77516898 0.77445749 0.77676983
  0.78406261 0.78833155 0.78922092 0.78886517]
 [0.71536778 0.73943781 0.74145767 0.75391348 0.75441845 0.75795321
  0.7663693  0.76586433 0.76771587 0.77158727]]


# federated non-IID 100.0 with pre-training
Train losses per communication round:  [1.251040668763657, 0.9026540519209598, 0.7934110796143395, 0.7443799155010444, 0.7089402530652433, 0.6859179328811408, 0.6706661516318594, 0.6605998994464557, 0.6468365753382765, 0.6408595381123272]
Test losses per communication round:  [11.129372471570969, 10.011794062145054, 7.544358377903694, 7.255034548044205, 7.1699503286567055, 7.4585545882582664, 7.12245212495327, 6.84143087156117, 6.440408459161335, 6.552118034719024]
Test weighted accuracies per communication round:  [0.7291620430021221, 0.7488499824478386, 0.7565518661504559, 0.7634271036969237, 0.7672313315082886, 0.770872302118393, 0.7751037483324676, 0.7769188179020106, 0.7797998388063913, 0.7814725481382561]
Test losses per communication round for each client:  [[12.47365636  8.55199558  7.43421417  7.19540143  7.15538692  6.75601763
   7.57758588  6.1681137   6.4574188   6.16527838]
 [ 9.65363243  7.76461462  7.55088362  6.88620931  7.32563001  6.92254764
   6.78279537  6.69047868  7.14804864  6.62659836]
 [11.66166228  9.03783363  7.48446588  7.46737313  7.14291856  7.76424843
   6.64371747  7.33368891  6.82637364  6.68877757]
 [10.12035871 11.44485629  7.33945711  6.92475551  6.63243621 10.82724345
   9.63545144  8.24680662  6.09669018  6.67699566]
 [ 9.90239695  9.02782267  7.50026324  7.35711798  7.40197253  7.26010931
   6.58108473  6.70165804  6.39518428  6.89702028]
 [13.11563301 20.17461455  6.93374515  6.76339319  7.38507378  6.74395579
   6.35491073  6.29847071  6.1745688   5.84574898]
 [12.69860339  9.16213965  7.5311307   7.72440189  6.67995336  7.25478774
   6.366359    7.31467396  6.8902691   6.18628556]
 [11.26580012  7.59449325  8.24930823  6.96293533  7.42815429  6.94282514
   6.44403389  6.71965176  5.89280976  6.29328027]
 [10.03762203  9.48538792  7.51384339  7.42043757  7.42764014  6.41999088
   8.35198104  6.61928481  5.96089222  7.02764565]
 [10.36435944  7.87418246  7.90627229  7.84832013  7.12033749  7.69381988
   6.48660171  6.32148153  6.56182918  7.11354965]]
Test accuracies per communication round for each client:  [[0.73586269 0.75501355 0.76314363 0.76856369 0.77289973 0.77579042
  0.77958446 0.78139115 0.78410117 0.78807588]
 [0.73170262 0.7546225  0.75866718 0.76348228 0.769453   0.778698
  0.78197227 0.78409091 0.78447612 0.78274268]
 [0.72158218 0.74539171 0.7515361  0.75806452 0.76459293 0.76324885
  0.76593702 0.76440092 0.76900922 0.76824117]
 [0.72843628 0.74123539 0.74680022 0.75922834 0.76126878 0.76831757
  0.77091449 0.77109998 0.77555185 0.77814877]
 [0.7238422  0.74023251 0.7493806  0.75890985 0.76253097 0.76901086
  0.77320374 0.76786735 0.77282257 0.77358491]
 [0.72812921 0.74504903 0.75447029 0.76177658 0.7642761  0.7675447
  0.77254374 0.77850413 0.77658143 0.7800423 ]
 [0.71979837 0.74326438 0.75212932 0.75664871 0.76064662 0.75612724
  0.7667304  0.76916391 0.77333565 0.77976708]
 [0.72949513 0.75465013 0.76669619 0.7741364  0.77395926 0.77785651
  0.78246236 0.78405669 0.78848539 0.79061116]
 [0.73541336 0.75268817 0.76079676 0.77084435 0.77560374 0.78212586
  0.78283095 0.78618015 0.78935308 0.79023444]
 [0.7373522  0.75557279 0.7615817  0.76332623 0.76739678 0.77088583
  0.77534406 0.78251599 0.78445435 0.78367901]]


Train losses per communication round:  [1.2049060424564355, 0.8857334834035553, 0.7755240725541014, 0.7251117347664092, 0.6950856366809822, 0.6687061857399058, 0.6578026926399685, 0.6445234819956586, 0.6345283841781134, 0.6262616069871001]
Test losses per communication round:  [9.924403814785183, 8.191589077934623, 7.999686568975449, 7.279619603604078, 7.127203162014484, 6.722827660292387, 6.76513330489397, 6.958726489543915, 6.521866916120052, 6.291596225649118]
Test weighted accuracies per communication round:  [0.7360253322391336, 0.7508788459018181, 0.7595397780921455, 0.7659834902473153, 0.7723468413732468, 0.7760494932423367, 0.7802714350542116, 0.781886363979389, 0.7840569551461899, 0.784111778464038]
Test losses per communication round for each client:  [[ 9.97164977  7.88072529  8.98258078  8.11771309  6.51233517  7.01407087
   7.49808657  6.87939596  7.06023073  6.38107407]
 [ 9.37498963  7.90363446  7.17795801  6.98924482  6.48504159  6.89053935
   6.43328997  7.31650478  6.45514846  6.34454328]
 [10.02088028  8.50148493  7.30670005  7.57984561  6.73175067  6.9099369
   6.31813982  6.73976886  6.40325755  6.29878116]
 [ 9.85713542  8.51838696  8.24956876  7.20102727  8.17557263  7.38980955
   7.9356854   8.13143092  7.50187922  6.58378759]
 [10.70454419  8.11009195  8.57256389  6.53754821  6.9389677   6.12666247
   6.23246025  6.36655501  6.14179721  6.03462419]
 [ 9.87309766  7.80722751  8.90489358  7.00201541  6.94050074  7.20916581
   7.1431942   6.66652927  6.20393354  6.08921447]
 [ 8.830689    7.7748794   7.24448496  7.60625327  6.80839574  6.13892549
   6.21448156  6.57915366  5.79226308  6.51021203]
 [10.93042147  8.58433145  7.65371621  7.70016265  7.07705402  6.68107386
   6.9359864   7.21521038  7.05025756  6.582129  ]
 [ 9.78227359  7.68750415  8.0793426   7.16909859  8.4740544   6.50176167
   6.82193589  6.93508792  6.4408277   6.04299868]
 [ 9.89835715  9.14762467  7.82505685  6.89328712  7.12835896  6.36633062
   6.11807299  6.75762814  6.16907412  6.04859778]]
Test accuracies per communication round for each client:  [[0.73343431 0.74649754 0.74801212 0.76126467 0.76524044 0.77148807
  0.77205604 0.77243468 0.77205604 0.77413858]
 [0.74058577 0.75523013 0.76740205 0.77158615 0.77843286 0.78242678
  0.78680107 0.787752   0.79079498 0.78756181]
 [0.73576875 0.75137436 0.76041851 0.76556127 0.77283206 0.77371874
  0.7769108  0.77531477 0.78560028 0.77850683]
 [0.73606435 0.74298541 0.75140292 0.75589226 0.76487093 0.76281332
  0.77291433 0.77609428 0.77478489 0.77478489]
 [0.74248516 0.75722765 0.76986406 0.77484204 0.78441509 0.78766992
  0.79149914 0.79513689 0.79743442 0.79800881]
 [0.73401826 0.75342466 0.76369863 0.76788432 0.77473364 0.7749239
  0.78272451 0.78405632 0.7859589  0.78253425]
 [0.7454741  0.76160602 0.77003047 0.78365298 0.78562466 0.79386987
  0.79673777 0.79888869 0.79691701 0.80068113]
 [0.7192294  0.73813771 0.74955405 0.74901891 0.75686764 0.76435961
  0.76667856 0.76774884 0.76864074 0.77292187]
 [0.73212942 0.74868322 0.75470278 0.76072235 0.76787058 0.77219714
  0.77445448 0.77501881 0.78235515 0.78386005]
 [0.7400873  0.75227355 0.75882139 0.76755184 0.77082575 0.77519098
  0.78010186 0.78446708 0.78410331 0.78610404]]


Train losses per communication round:  [1.1827688824621734, 0.8682961645616905, 0.773677735031384, 0.7236219895607401, 0.6930037852491383, 0.6705169175320397, 0.6602977757819207, 0.6456947797099005, 0.6335040876213539, 0.6275383058828616]
Test losses per communication round:  [9.806870490312576, 8.53123607635498, 7.382187835872173, 7.430737808346748, 7.001038776338101, 6.852809891104698, 6.822148633003235, 6.432530198991299, 6.376900091767311, 6.41641926318407]
Test weighted accuracies per communication round:  [0.7278917273233979, 0.7502757029354502, 0.7604272587995505, 0.7655944099891213, 0.7702487071869945, 0.7745889938623608, 0.7766633719579091, 0.7811197459300268, 0.7832254450514123, 0.7839918546099248]
Test losses per communication round for each client:  [[ 9.18805966  8.63343161  7.40275788  7.61874282  6.70654011  6.40047637
   6.83170485  6.20011169  6.0448885   6.81399995]
 [ 9.11159095  8.51941758  7.40105724  7.12999302  6.73426175  6.8636837
   7.22892696  6.32880449  6.60423321  6.40096283]
 [ 9.35411817  8.58575368  7.06971827  6.90060353  7.47147447  6.4519406
   7.39478135  6.26125434  6.47511238  6.34881514]
 [ 9.95366734  8.27429873  7.65206617  8.23981261  7.38302827  7.29908955
   7.43004644  6.34025604  7.24502057  7.0705002 ]
 [ 9.75433329  8.75484413  7.86810863  7.34620684  7.17965794  7.07350916
   6.68290773  7.07344973  6.25676684  6.2924805 ]
 [11.41966933  8.86908758  7.04110925  6.87494847  6.35935551  6.32963902
   6.41190112  6.02799828  5.95448656  6.35384691]
 [ 9.06178647  7.41049969  6.82325035  6.48479187  6.27113611  6.09489685
   6.03088766  5.87667245  5.7842409   5.76055324]
 [ 9.48000541  9.02163613  7.49264652  8.21478814  7.49766684  7.44431102
   6.85620415  6.52671093  6.46522838  6.34122369]
 [10.43072456  7.82983035  7.44608366  7.70875263  6.68164246  6.96046734
   6.90976536  7.09806633  6.61806589  6.59276181]
 [10.31474972  9.41356128  7.62508038  7.78873813  7.72562432  7.61008531
   6.4443607   6.59197772  6.32095769  6.18904836]]
Test accuracies per communication round for each client:  [[0.7305313  0.75090975 0.76328239 0.76491994 0.7680131  0.77729258
  0.77565502 0.78256914 0.77965793 0.78129549]
 [0.73265592 0.75840925 0.77207428 0.7789068  0.78521374 0.78749124
  0.78941836 0.79169587 0.79747722 0.79309741]
 [0.73989996 0.76221624 0.7783763  0.77779915 0.78645633 0.78510966
  0.78876491 0.79492112 0.79819161 0.79395922]
 [0.72737535 0.74825964 0.75277516 0.76124177 0.76331138 0.76857949
  0.77591722 0.77779868 0.78099718 0.78212606]
 [0.7151667  0.74079784 0.75274619 0.75640779 0.76199653 0.76565812
  0.76989786 0.77433031 0.77722104 0.77953363]
 [0.72992155 0.74617109 0.75756444 0.76503549 0.77082555 0.77213298
  0.7751214  0.77997759 0.78277923 0.78184535]
 [0.73411978 0.75517241 0.7646098  0.76969147 0.77568058 0.78275862
  0.78076225 0.78602541 0.78947368 0.79019964]
 [0.72275192 0.74331651 0.75434661 0.75827257 0.7638811  0.77005048
  0.77042438 0.77509815 0.77285474 0.78257618]
 [0.72592175 0.75620767 0.75507901 0.76354402 0.7648608  0.76937547
  0.77389014 0.77878104 0.77840482 0.77990971]
 [0.72072557 0.74155891 0.75395115 0.76059626 0.76311063 0.76760057
  0.76724138 0.77047414 0.77586207 0.77586207]]


Train losses per communication round:  [1.1355308629732792, 0.8568642471911572, 0.7653535724623229, 0.7210223615216148, 0.6905849840889008, 0.6732006174668117, 0.6618166681393542, 0.6490515738972891, 0.643059350813376, 0.6292361986954104]
Test losses per communication round:  [10.126469996385277, 8.13364864885807, 7.834419867396354, 7.10823086835444, 7.0052528403699394, 6.953751353174448, 6.931350244022906, 6.409161246567964, 6.4929999314248565, 6.318986164033413]
Test weighted accuracies per communication round:  [0.7316184725475429, 0.7535401598772078, 0.761200587334287, 0.7684861686829936, 0.7743119073303723, 0.775389805807116, 0.7782788833787359, 0.7827194908290637, 0.7844360533147875, 0.7845933792230365]
Test losses per communication round for each client:  [[ 9.28228539  7.86643142  7.44533622  6.87729973  6.56547821  6.95372993
   6.50179526  6.62515372  6.52415133  6.36207014]
 [15.72102433  8.12410426  7.57699201  6.74161287  7.25255424  7.94805318
   6.2461325   6.88788038  6.36562911  6.5840292 ]
 [ 9.08810351  8.16281006  7.83422709  6.98980434  7.11120796  6.73822033
   6.98472613  6.29603754  6.14078166  6.19630039]
 [10.2999295   8.27702755  7.84151208  7.30346531  6.74119286  6.59130485
   7.32949543  6.4643319   7.26837468  6.63397807]
 [ 9.63759795  8.38945699  7.60409772  7.96866888  7.34144431  7.49601722
   8.35645854  6.39391613  6.25982808  6.47398016]
 [ 9.00994436  8.94246858  7.72646493  7.52127028  6.92121065  7.04860252
   6.44638059  6.56762844  6.88702488  6.23918533]
 [ 9.578677    7.56157565  8.95375043  6.74806994  8.02698439  6.28411209
   7.1870231   6.06304133  6.22912666  6.09374548]
 [10.70269871  8.25061762  7.39593548  7.00256503  6.27153621  6.8661654
   6.23220405  5.94274344  7.08447665  6.13615221]
 [ 9.02957973  7.43939751  8.24913526  6.71438199  6.75165999  7.06162262
   7.68971717  6.8249169   6.06982309  6.15342575]
 [ 8.91485948  8.32259685  7.71674746  7.21517032  7.06925958  6.54968539
   6.33956966  6.02596268  6.10078318  6.31699491]]
Test accuracies per communication round for each client:  [[0.7325315  0.75925926 0.76555937 0.77281405 0.77835052 0.78216877
  0.78655976 0.78789614 0.79247805 0.79152348]
 [0.72931251 0.75175013 0.76126369 0.76772572 0.77382876 0.77634177
  0.77688027 0.7822653  0.78513732 0.79052235]
 [0.72220128 0.74557105 0.75537128 0.76366378 0.76950622 0.76894082
  0.76912929 0.77987184 0.77949491 0.78137957]
 [0.72802149 0.74431513 0.75022381 0.7561325  0.76418979 0.76472695
  0.76705461 0.77296329 0.77851388 0.7733214 ]
 [0.73085339 0.74580598 0.75273523 0.76367615 0.76622903 0.76513494
  0.77188184 0.77115244 0.77425237 0.77954048]
 [0.72995461 0.75491679 0.76096823 0.76872163 0.78025719 0.77912254
  0.78158094 0.78876702 0.78914523 0.7806354 ]
 [0.73423091 0.75857617 0.76171155 0.7713021  0.77554408 0.77683512
  0.77775729 0.7821837  0.78310586 0.78421247]
 [0.74135394 0.75202355 0.76894776 0.77465048 0.77998528 0.78219279
  0.78458425 0.78899926 0.78899926 0.78458425]
 [0.73243045 0.76207906 0.76647145 0.77177892 0.77635432 0.77525622
  0.78092972 0.78239385 0.78312592 0.78953148]
 [0.73568959 0.76219746 0.76968882 0.77506723 0.7796773  0.78409527
  0.78736074 0.79158663 0.79081829 0.79139454]]


Train losses per communication round:  [1.1985999142075046, 0.8868368492575801, 0.7952690382091303, 0.7440121829259027, 0.7108851767611126, 0.6895408123009531, 0.6724751356352986, 0.6604069622337503, 0.64851249787504, 0.6394677737027791]
Test losses per communication round:  [9.806332641158951, 8.250952829048037, 7.555243335664272, 7.061063688993454, 7.089338317513466, 6.65566258566505, 6.687802618457499, 6.359610338517632, 6.273242948134429, 6.44261280708015]
Test weighted accuracies per communication round:  [0.7217154732139504, 0.7439043355330013, 0.7546972335201572, 0.7632927023316446, 0.7686336393099251, 0.7704807751930027, 0.774402342986184, 0.7785477942648276, 0.780328815475918, 0.7816037088556901]
Test losses per communication round for each client:  [[ 9.12611555  8.26916701  8.17094356  7.05611992  6.79433286  6.37108089
   6.15636688  6.25096342  6.39150017  6.73215216]
 [10.14577866  8.3151229   8.20754081  7.47881132  7.08833176  6.73010045
   6.2760593   6.49292529  6.0619036   5.90294883]
 [ 9.53812671  8.30565828  8.15185994  6.93754447  6.76464781  8.19490921
   6.63351274  6.36751375  6.16739786  7.13208842]
 [ 9.1203317   7.70633501  7.11697531  6.68205655  6.55350244  6.39248711
   6.10174561  6.1020323   6.01973855  5.95764977]
 [11.3997606   8.7942394   7.57927462  7.31462011  7.22165507  6.73288257
   6.84830752  6.73052508  6.36733661  6.22159739]
 [ 9.99073535  9.07936156  6.94826797  6.96435186  6.62815747  6.20161861
   6.27684331  5.91775256  6.8987937   7.74106365]
 [ 9.78697741  8.44530416  7.51330864  7.11848396  6.92393857  6.78164464
   6.57464349  6.43424112  6.31772786  6.18999511]
 [10.47743881  7.90227777  7.38091967  6.95998371  9.71861976  6.21711856
   6.93490183  7.08943903  6.41274413  5.91905432]
 [ 9.14087057  7.84190047  7.12535244  6.82764608  6.6397813   6.42814243
   6.17346191  6.12747955  6.01545709  5.98714638]
 [ 9.33719105  7.85016174  7.3579904   7.27101892  6.56041613  6.50664139
   8.90218359  6.08323129  6.07982989  6.64243203]]
Test accuracies per communication round for each client:  [[0.7223386  0.74595315 0.75852219 0.76156922 0.77071034 0.7733765
  0.77642354 0.77604266 0.77661398 0.78023234]
 [0.7305313  0.75272926 0.76601164 0.7687409  0.77529112 0.77310771
  0.77911208 0.78293304 0.78657205 0.78548035]
 [0.72720682 0.75022657 0.7565706  0.76871488 0.7690774  0.77397136
  0.77650897 0.7806779  0.78176545 0.782853  ]
 [0.72807339 0.74899083 0.75541284 0.7666055  0.77100917 0.76770642
  0.77724771 0.78073394 0.78036697 0.78458716]
 [0.71985881 0.74177968 0.74939625 0.75887052 0.76240015 0.76723017
  0.76945941 0.77558982 0.77410366 0.77763329]
 [0.71904673 0.7406442  0.75144293 0.7581456  0.77080618 0.7743437
  0.77881214 0.78495625 0.78719047 0.7855148 ]
 [0.70735849 0.72867925 0.7454717  0.75226415 0.75490566 0.7590566
  0.76018868 0.76641509 0.76886792 0.77245283]
 [0.72686189 0.74638467 0.75686913 0.77078814 0.7780188  0.77838033
  0.78163413 0.7818149  0.78904555 0.78651482]
 [0.71868132 0.74377289 0.75787546 0.76465201 0.76593407 0.77069597
  0.77582418 0.77728938 0.78003663 0.78260073]
 [0.71703873 0.73974432 0.74966609 0.76244991 0.76817401 0.76683839
  0.76855562 0.77866819 0.77847739 0.77790498]]


# no-pretraining

# federated baseline IID with no pre-training
Train losses per communication round:  [1.8617424040503756, 1.3825908636729394, 1.1907275355602862, 1.0921186695261116, 1.0295082769979387, 0.9700031790331269, 0.9262218143636659, 0.8910606280939113, 0.8578058067334474, 0.8322067967004324]
Test losses per communication round:  [15.457569301128387, 12.520052897930146, 10.996551561355592, 10.200759756565095, 9.613864493370055, 9.134196549654007, 8.635843819379806, 8.308832210302352, 8.071184307336807, 7.7440041363239285]
Test weighted accuracies per communication round:  [0.5072222222222222, 0.5626296296296297, 0.6037592592592593, 0.6268148148148148, 0.6503888888888889, 0.6668148148148149, 0.6822222222222223, 0.6954074074074075, 0.7046666666666667, 0.7173703703703704]
Test losses per communication round for each client:  [[15.27734935 12.3860321  10.85385239 10.01954091  9.46618652  9.04339129
   8.57088953  8.19489217  7.99152982  7.61366135]
 [15.48167706 12.50737858 11.06393969 10.28488088  9.66614908  9.18754381
   8.78798705  8.42211235  8.11123711  7.88127536]
 [15.38964403 12.40556479 10.8886795  10.01160967  9.46721673  9.01076281
   8.4334473   8.09430611  7.92002356  7.59544665]
 [15.47592223 12.59938502 10.9912852  10.36663055  9.73569787  9.19202757
   8.5809406   8.35271031  8.17182845  7.77734339]
 [15.5435195  12.61750817 11.14854825 10.32121801  9.80231982  9.30195427
   8.77322358  8.45243001  8.22929817  7.90133238]
 [15.42011583 12.51006174 10.99449682 10.22162914  9.5816161   9.04592776
   8.56043756  8.26253593  8.04495287  7.80206889]
 [15.46641958 12.58026922 11.04172397 10.24444067  9.67993313  9.16911721
   8.72988784  8.28727478  8.02615058  7.73312974]
 [15.57873678 12.57170284 11.0325985  10.27224702  9.64554209  9.29730999
   8.79168671  8.49333549  8.2376644   7.8295384 ]
 [15.47688866 12.54710615 10.96837223 10.14891475  9.55875164  9.04039073
   8.59720838  8.27469391  7.99555367  7.57811666]
 [15.46542001 12.47552037 10.98201907 10.11648595  9.53523195  9.05354005
   8.53272963  8.25403106  7.98360443  7.72812855]]
Test accuracies per communication round for each client:  [[0.51185185 0.56574074 0.61018519 0.63148148 0.65481481 0.665
  0.68185185 0.69814815 0.70203704 0.72111111]
 [0.50333333 0.56259259 0.59833333 0.62074074 0.64981481 0.66203704
  0.6762963  0.68851852 0.70574074 0.71259259]
 [0.50574074 0.56611111 0.60703704 0.6337037  0.65518519 0.66962963
  0.68759259 0.70018519 0.71185185 0.72314815]
 [0.51296296 0.56574074 0.60648148 0.6212963  0.64518519 0.66222222
  0.68574074 0.69611111 0.69888889 0.71814815]
 [0.49962963 0.55833333 0.59277778 0.6137037  0.63222222 0.65333333
  0.67       0.68240741 0.69314815 0.70574074]
 [0.51666667 0.57111111 0.61185185 0.63518519 0.66       0.68314815
  0.695      0.70740741 0.71425926 0.72203704]
 [0.51092593 0.56092593 0.60425926 0.62888889 0.65       0.66666667
  0.67814815 0.69574074 0.70648148 0.71703704]
 [0.49851852 0.5587037  0.59666667 0.61518519 0.64296296 0.65574074
  0.67666667 0.68648148 0.69944444 0.71462963]
 [0.51240741 0.55962963 0.60259259 0.63407407 0.65759259 0.67481481
  0.68740741 0.70203704 0.71351852 0.7262963 ]
 [0.50018519 0.55740741 0.60740741 0.63388889 0.65611111 0.67555556
  0.68351852 0.69703704 0.7012963  0.71296296]]


Train losses per communication round:  [1.909343246313242, 1.4402839486944605, 1.209989945281892, 1.092807855144055, 1.0177876909632655, 0.9554221709804421, 0.9180554301428371, 0.8784873196006526, 0.8446015696289271, 0.8220040944553691]
Test losses per communication round:  [16.36095223426819, 12.68209594488144, 11.096969246864319, 10.154249411821365, 9.556611132621764, 8.933231729269028, 10.907848358154297, 8.196153539419175, 8.419651007652282, 7.718149554729462]
Test weighted accuracies per communication round:  [0.4961666666666667, 0.5634629629629629, 0.6072962962962963, 0.6330555555555556, 0.6529444444444444, 0.6739259259259259, 0.6168333333333333, 0.6978888888888889, 0.6886666666666666, 0.7106851851851852]
Test losses per communication round for each client:  [[16.36412394 12.68130064 11.02497721 10.12088305  9.4921748   8.93170112
  10.82459307  8.12606138  8.35902405  7.77877462]
 [16.29115033 12.58740282 11.02821434 10.08753252  9.49138105  8.81807655
  10.84103501  8.0715037   8.28764993  7.63080066]
 [16.44283152 12.71246254 11.11146021 10.22944897  9.60052568  9.01471043
  10.90124869  8.21825314  8.41227579  7.68123078]
 [16.40505457 12.72315836 11.19635355 10.11567616  9.56617349  8.93214923
  10.91153204  8.18769318  8.4283995   7.61374438]
 [16.32273483 12.59700871 10.97911644  9.99099761  9.38814449  8.80592412
  10.61057031  8.08725709  8.25103521  7.62011969]
 [16.26015234 12.53827155 10.92671812 10.02276355  9.46882254  8.72911024
  10.69968963  8.07428759  8.2550512   7.55485338]
 [16.42738378 12.72102273 11.16937292 10.20183247  9.66753411  8.99604791
  11.08510602  8.3434943   8.58246356  7.83710498]
 [16.37376142 12.79558229 11.23025429 10.34538496  9.71090913  9.14510834
  11.05406904  8.37771904  8.63532966  7.87606847]
 [16.37117028 12.7303648  11.15725899 10.24938613  9.60469699  8.93593174
  11.13600826  8.21636117  8.44751203  7.79912299]
 [16.35115933 12.73438501 11.14596641 10.17858869  9.57574904  9.0235576
  11.01463151  8.25890481  8.53776914  7.78967559]]
Test accuracies per communication round for each client:  [[0.49944444 0.56314815 0.60925926 0.63722222 0.65351852 0.67481481
  0.62       0.7062963  0.69055556 0.70722222]
 [0.4962963  0.56833333 0.61462963 0.635      0.65611111 0.67777778
  0.62314815 0.70814815 0.7        0.71611111]
 [0.48814815 0.56666667 0.60833333 0.63444444 0.65611111 0.67351852
  0.62759259 0.69685185 0.69222222 0.71166667]
 [0.49592593 0.56611111 0.60796296 0.64074074 0.65296296 0.68203704
  0.61814815 0.7037037  0.68685185 0.71740741]
 [0.50185185 0.56962963 0.61314815 0.63777778 0.65740741 0.67833333
  0.62666667 0.70018519 0.69759259 0.7162963 ]
 [0.50666667 0.56611111 0.61555556 0.63351852 0.64907407 0.67962963
  0.61722222 0.69740741 0.68925926 0.71592593]
 [0.48277778 0.55703704 0.60277778 0.63277778 0.6512963  0.66833333
  0.61018519 0.68740741 0.68185185 0.70425926]
 [0.49407407 0.55722222 0.59722222 0.6187037  0.64481481 0.66
  0.60462963 0.68222222 0.67296296 0.7012963 ]
 [0.49462963 0.55796296 0.6        0.62462963 0.65111111 0.66796296
  0.60888889 0.69351852 0.68814815 0.70648148]
 [0.50185185 0.56240741 0.60407407 0.63574074 0.65703704 0.67685185
  0.61185185 0.70314815 0.68722222 0.71018519]]


Train losses per communication round:  [1.8837147105374985, 1.4273819185220278, 1.1967429626446504, 1.0866089589673387, 1.0183315692392327, 0.9647379275257066, 0.9252602208119173, 0.8892927324013596, 0.859738286686014, 0.8350783550880365]
Test losses per communication round:  [15.988197684288025, 12.461476075649262, 11.00607979297638, 10.182369118928909, 9.556981843709945, 9.089730370044709, 8.670315796136856, 8.396941643953323, 8.061928910017013, 7.8715092718601225]
Test weighted accuracies per communication round:  [0.4987037037037037, 0.572962962962963, 0.6098888888888889, 0.6338703703703704, 0.6548148148148148, 0.669462962962963, 0.6836481481481482, 0.6930185185185186, 0.7044814814814815, 0.7092037037037038]
Test losses per communication round for each client:  [[15.93386805 12.40228486 10.94905305 10.07798535  9.4675805   8.98889607
   8.63277376  8.35492533  8.00279754  7.84406853]
 [16.12915528 12.51292741 11.08285046 10.37285841  9.6943754   9.29748726
   8.80044818  8.63766783  8.33626974  8.08222067]
 [16.0572356  12.50321555 11.07340062 10.2709406   9.62800908  9.17088807
   8.73038602  8.45972967  8.20480335  7.98112285]
 [15.88265264 12.44244421 10.97637737 10.12457925  9.51969957  9.05157506
   8.65025604  8.34461927  7.95538586  7.77931285]
 [15.91956806 12.31972313 10.8636632   9.94757825  9.32626694  8.86314934
   8.41218024  8.11820388  7.76881588  7.58749133]
 [16.00118887 12.46581542 11.04159832 10.17652303  9.55708045  9.103872
   8.69852793  8.38210231  8.07589138  7.87404579]
 [15.8202194  12.33644748 10.9296124  10.20673263  9.58728486  9.06636649
   8.65350968  8.32779533  8.04126304  7.84425563]
 [16.07163584 12.57064784 11.02781272 10.25876319  9.59246206  9.09006929
   8.69994164  8.40817356  8.07897663  7.88953882]
 [16.14515662 12.6319313  11.13126111 10.23393941  9.65146464  9.17420042
   8.784509    8.55938506  8.1885488   8.02522874]
 [15.92129648 12.42932355 10.9851687  10.15379107  9.54559493  9.09079969
   8.64062548  8.37681419  7.96653688  7.80780751]]
Test accuracies per communication round for each client:  [[0.50333333 0.57537037 0.6087037  0.63444444 0.65444444 0.67055556
  0.68796296 0.69685185 0.70685185 0.70814815]
 [0.4887037  0.57018519 0.60833333 0.625      0.64703704 0.65666667
  0.67851852 0.67796296 0.69       0.69907407]
 [0.48888889 0.5662963  0.59851852 0.62185185 0.64666667 0.6612963
  0.67722222 0.69037037 0.69648148 0.70148148]
 [0.50722222 0.57777778 0.61648148 0.64092593 0.65537037 0.67314815
  0.68407407 0.69407407 0.70962963 0.71351852]
 [0.51296296 0.58296296 0.61833333 0.64703704 0.66666667 0.68037037
  0.69185185 0.70333333 0.71574074 0.72037037]
 [0.50462963 0.56722222 0.60222222 0.63111111 0.65166667 0.6637037
  0.67851852 0.68981481 0.70074074 0.70388889]
 [0.51092593 0.57962963 0.62       0.63814815 0.66037037 0.67296296
  0.68240741 0.69333333 0.705      0.70814815]
 [0.48833333 0.56685185 0.60592593 0.63037037 0.64944444 0.67092593
  0.68240741 0.69555556 0.70555556 0.71203704]
 [0.48351852 0.56666667 0.61074074 0.63592593 0.66037037 0.67259259
  0.68648148 0.69240741 0.70611111 0.70962963]
 [0.49851852 0.57666667 0.60962963 0.63388889 0.65611111 0.67240741
  0.68703704 0.69648148 0.7087037  0.71574074]]


Train losses per communication round:  [1.9432258442661468, 1.5224040277434523, 1.2523429744518721, 1.1020741187785503, 1.0117153310211453, 0.9490423560847898, 0.9035546779103534, 0.8707376416530129, 0.838829526278747, 0.819145654282979]
Test losses per communication round:  [17.279287767410278, 13.436629283428193, 11.408086788654327, 10.183552014827729, 9.85398222208023, 9.330091774463654, 8.829774254560471, 8.658596915006637, 8.310935467481613, 8.097992795705796]
Test weighted accuracies per communication round:  [0.5078703703703704, 0.5664074074074075, 0.6079444444444445, 0.641962962962963, 0.644962962962963, 0.6595, 0.6734074074074075, 0.6745, 0.6907592592592593, 0.6997037037037037]
Test losses per communication round for each client:  [[17.21512341 13.38281643 11.33347535 10.13071603  9.75935912  9.23238724
   8.83924532  8.68645138  8.2957505   8.06423831]
 [17.16943419 13.34120858 11.34768927 10.12370026  9.8224625   9.2159574
   8.71479362  8.53467274  8.201258    7.95521367]
 [17.34729135 13.56156397 11.55719149 10.31655747 10.091268    9.52309245
   9.01267868  8.78654212  8.46849793  8.24441767]
 [17.27386677 13.45459402 11.40453076 10.21760464  9.91255713  9.33137125
   8.86657983  8.66213685  8.30602968  8.01997566]
 [17.30346692 13.41900599 11.37538588 10.04493946  9.73563093  9.1978274
   8.71051884  8.54439628  8.10345584  8.07366461]
 [17.24765933 13.39790416 11.39846253 10.12268555  9.79101068  9.3001101
   8.77660239  8.59738702  8.29413563  7.98884398]
 [17.43661714 13.55990875 11.56741166 10.37918842  9.99234426  9.54321426
   9.05077684  8.8873052   8.58374172  8.38452065]
 [17.29169285 13.45062566 11.42603445 10.21872014  9.80371946  9.29143631
   8.77410644  8.64185488  8.29255664  8.14742917]
 [17.24300051 13.4504894  11.47662318 10.22656345  9.9138962   9.43028611
   8.90042013  8.70484877  8.36156362  8.17109156]
 [17.26472521 13.34817588 11.19406331 10.05484474  9.71757394  9.23523521
   8.65202045  8.54037392  8.2023651   7.93053269]]
Test accuracies per communication round for each client:  [[0.50814815 0.56333333 0.60333333 0.63759259 0.64092593 0.65740741
  0.66722222 0.66962963 0.68851852 0.69944444]
 [0.51888889 0.57333333 0.61944444 0.65166667 0.65092593 0.66555556
  0.68407407 0.68740741 0.69685185 0.70611111]
 [0.49833333 0.55611111 0.59944444 0.63166667 0.63037037 0.6487037
  0.66277778 0.66388889 0.68314815 0.69018519]
 [0.50648148 0.56518519 0.60592593 0.64055556 0.64111111 0.6587037
  0.66907407 0.67222222 0.68759259 0.70240741]
 [0.50888889 0.57759259 0.61222222 0.65166667 0.65537037 0.66648148
  0.68166667 0.68351852 0.7        0.6962963 ]
 [0.50703704 0.56166667 0.60462963 0.64259259 0.65185185 0.66759259
  0.68240741 0.67981481 0.70074074 0.71481481]
 [0.50185185 0.55240741 0.59703704 0.62777778 0.63833333 0.65
  0.65796296 0.66111111 0.67759259 0.6862963 ]
 [0.50518519 0.56648148 0.60981481 0.6387037  0.64462963 0.65851852
  0.67518519 0.67555556 0.69166667 0.70074074]
 [0.51351852 0.57111111 0.60796296 0.64481481 0.63907407 0.65407407
  0.66944444 0.675      0.6862963  0.69148148]
 [0.51037037 0.57685185 0.61962963 0.65259259 0.65703704 0.66796296
  0.68425926 0.67685185 0.69518519 0.70925926]]


Train losses per communication round:  [1.9035934081444374, 1.4158597509889208, 1.173964814621316, 1.0423357245837443, 0.959777537252776, 0.90145196567273, 0.8581674229992917, 0.8249731488040919, 0.8004926003824325, 0.7799064740185907]
Test losses per communication round:  [15.946229100227356, 12.377698576450348, 10.592203724384309, 9.584869259595871, 8.914426463842393, 8.342032653093337, 7.983343136310578, 7.711997181177139, 7.514527058601379, 7.30950317978859]
Test weighted accuracies per communication round:  [0.5293518518518519, 0.5902962962962963, 0.6352222222222222, 0.6598518518518519, 0.6832777777777778, 0.6988703703703704, 0.708962962962963, 0.7164259259259259, 0.7237037037037037, 0.7304259259259259]
Test losses per communication round for each client:  [[15.87679434 12.33326709 10.50225401  9.43223232  8.8595224   8.24249059
   7.851946    7.58337736  7.39138013  7.1699698 ]
 [15.84487247 12.17363    10.40239507  9.3766467   8.62981659  7.98715836
   7.67786515  7.38178825  7.13913471  7.02051234]
 [15.89566839 12.29278886 10.59947491  9.53824997  8.90027267  8.34449005
   7.95125681  7.71644497  7.46317822  7.29877156]
 [16.02601147 12.5165745  10.66540587  9.71762908  8.98264092  8.41768706
   8.00979024  7.86468285  7.6401971   7.42876595]
 [15.93516791 12.3636483  10.55264664  9.59324419  8.91793215  8.38926554
   8.0313834   7.68852299  7.56999105  7.27247262]
 [16.02724099 12.55776477 10.80217373  9.86672193  9.04608864  8.58628547
   8.21044976  7.93828624  7.72283298  7.52948689]
 [16.04941308 12.45029211 10.6873883   9.70780891  9.05412251  8.44519418
   8.06903791  7.85705453  7.68901592  7.48947543]
 [15.96065366 12.4460603  10.56282997  9.60605437  8.94477642  8.28260118
   7.98856461  7.64146829  7.47557443  7.23999262]
 [15.96100259 12.4063158  10.5434745   9.57515323  8.95455414  8.32942671
   8.02255553  7.69341958  7.48403728  7.2922321 ]
 [15.8854661  12.23664403 10.60399425  9.4349519   8.8545382   8.3957274
   8.02058196  7.75492674  7.56992877  7.35335249]]
Test accuracies per communication round for each client:  [[0.53796296 0.59296296 0.63425926 0.66       0.67888889 0.69759259
  0.71166667 0.71722222 0.72555556 0.73240741]
 [0.5412963  0.60240741 0.64759259 0.67185185 0.69962963 0.72203704
  0.72444444 0.73425926 0.74240741 0.74351852]
 [0.53407407 0.59240741 0.63333333 0.66092593 0.68148148 0.69648148
  0.70703704 0.715      0.72277778 0.72777778]
 [0.52592593 0.58722222 0.63444444 0.65518519 0.67648148 0.69611111
  0.70333333 0.70277778 0.71222222 0.72314815]
 [0.52703704 0.59240741 0.63685185 0.66       0.68759259 0.70074074
  0.70796296 0.71944444 0.72185185 0.72925926]
 [0.51777778 0.57666667 0.62185185 0.64407407 0.675      0.6862963
  0.69703704 0.70888889 0.71314815 0.72296296]
 [0.52111111 0.58314815 0.6312963  0.65648148 0.67574074 0.69240741
  0.71185185 0.71537037 0.71814815 0.72722222]
 [0.52703704 0.58814815 0.64148148 0.66333333 0.69259259 0.705
  0.71259259 0.72555556 0.73351852 0.73518519]
 [0.52759259 0.59203704 0.63703704 0.66277778 0.68333333 0.70166667
  0.71037037 0.71759259 0.72796296 0.73074074]
 [0.5337037  0.59555556 0.63407407 0.66388889 0.68203704 0.69037037
  0.70333333 0.70814815 0.71944444 0.73203704]]


# federated baseline non-IID 100.0 with no pre-training
Train losses per communication round:  [1.9274827181350318, 1.4831998331011056, 1.2195245645204327, 1.079605012503714, 0.9973285991150312, 0.9443918962276306, 0.898630356805311, 0.8669115932966841, 0.8385300574466467, 0.8154207756239213]
Test losses per communication round:  [18.147996747493742, 14.568912315368653, 12.001955246925354, 10.88776766359806, 10.232846215367317, 11.460848397016525, 9.510367304086685, 9.109776075184346, 8.900782692432404, 8.44891285225749]
Test weighted accuracies per communication round:  [0.5097549406528967, 0.5677918919960488, 0.6204155407776402, 0.6415341748297172, 0.6618889449824602, 0.6393230313493662, 0.6913304896661329, 0.6956852017067097, 0.7058038373835602, 0.7081827878517094]
Test losses per communication round for each client:  [[18.26019371 15.39934361 12.06798559 10.69912606 10.26233464 11.39950222
   9.38807172  9.44090766  8.48801029  8.08055699]
 [17.94781315 15.05517924 12.14333045 10.71747452 10.7946319  11.53855348
   9.08633262  8.75580975  8.85562932  8.20384878]
 [16.73812878 13.49283683 11.24783659 10.33686411  9.51346278 10.71412694
   8.62910777  8.58412981  8.24004322  7.99463308]
 [18.46102202 14.6770823  12.14829564 11.31655771 10.05427557 11.47316039
   9.1142863   8.8953625   8.80501956  8.0226129 ]
 [18.41648793 14.31012332 11.79333925 10.75051504 10.13922799 11.72192049
   9.24767262  9.30171978  8.78719789  8.43105632]
 [18.76932228 14.62586808 12.29133189 11.19859689 10.47845542 12.36802721
   8.96444881  9.03971744  8.81766748  8.86874068]
 [17.90302765 14.62568784 12.30203712 11.48066419 10.24424565 11.46658635
  10.55909675  8.75751831  9.15203959 10.11516321]
 [18.12339687 14.3466115  12.13440561 10.23851916  9.95463365 11.09384972
   9.97047669  8.71447298  9.53102303  8.4632659 ]
 [18.4614321  14.00183547 11.60349494 10.37618208 10.9903571  11.03203708
  11.42152673 10.4806388   9.37223238  7.75733837]
 [18.39914298 15.15455496 12.28749537 11.76317686  9.89683744 11.8007201
   8.72265303  9.12748373  8.95896417  8.55191231]]
Test accuracies per communication round for each client:  [[0.49563765 0.55689623 0.61072953 0.63523297 0.65435307 0.63857435
  0.68888064 0.69593466 0.70410247 0.70577316]
 [0.51776738 0.58034321 0.63355868 0.64881262 0.6651066  0.65019934
  0.69301439 0.69630785 0.71000173 0.71537528]
 [0.50054152 0.55758123 0.61389892 0.63393502 0.66046931 0.63086643
  0.69097473 0.70144404 0.70415162 0.70541516]
 [0.51347574 0.57077261 0.62826912 0.64324216 0.66440407 0.63026552
  0.69435017 0.70273508 0.7087243  0.70932322]
 [0.51262626 0.57381507 0.62490287 0.65034965 0.66938617 0.64763015
  0.69638695 0.7024087  0.71037296 0.71872572]
 [0.51004318 0.56467055 0.61310306 0.64051061 0.6634128  0.63825793
  0.69326075 0.69513798 0.70133283 0.7084663 ]
 [0.49793698 0.5540135  0.60802701 0.62228057 0.64234809 0.6204051
  0.67554389 0.68210803 0.69429857 0.69186047]
 [0.52073149 0.57523085 0.62303096 0.64493934 0.66648561 0.64276661
  0.68785081 0.6911099  0.7074054  0.70613797]
 [0.52358405 0.57494081 0.62811874 0.64960845 0.66782007 0.6490621
  0.69750501 0.69076671 0.70934256 0.70952468]
 [0.50538813 0.56986301 0.62100457 0.64584475 0.66429224 0.64456621
  0.69479452 0.69844749 0.70794521 0.71105023]]

Train losses per communication round:  [1.888240487200333, 1.406786701596856, 1.1754138550985023, 1.0580153304646116, 0.9847652692564667, 0.9268446705112859, 0.8862532370735254, 0.8555103386011069, 0.8299774374212214, 0.8047364034071982]
Test losses per communication round:  [17.458491373062134, 13.707551431655883, 12.085937857627869, 10.968123769760131, 10.097204113006592, 9.602219259738922, 9.424377363920211, 8.794733160734177, 8.579760970175267, 8.22498785853386]
Test weighted accuracies per communication round:  [0.5294284261311156, 0.581232642355372, 0.6185332665154081, 0.6502837811655613, 0.6709016791837897, 0.6824335084769623, 0.694568882298765, 0.7049286741474083, 0.713935070239258, 0.7205569762395673]
Test losses per communication round for each client:  [[17.34922028 13.48573852 11.9996413  10.69465417 10.40571618  9.96399492
   9.90383893  9.38545716  8.73838133  8.99893141]
 [17.70573676 14.56549811 12.1482296  10.96579432  9.87170669  9.52127498
   9.23269123  8.80189314  9.9480446   8.41251957]
 [17.83333898 13.56148779 12.42190552 10.90091324 10.77562314 10.3319506
   9.83869183  8.79208428  8.86345768  8.06309059]
 [17.6930238  13.8289721  11.65192837 11.83663619 11.19323611  9.41504368
   9.33488321  8.92082137  8.07895947  8.14632455]
 [17.50337791 13.92922783 12.57826579 11.71569401  9.32066211  9.4391641
   9.40920889  8.58083242  7.94649015  8.50010872]
 [17.575091   13.2941519  12.18331158 10.46998221 10.19322717  9.73070949
   9.01009101  8.98311096  8.45880401  7.68046653]
 [16.97700632 13.70084417 12.23272073 10.64638478  9.7689122   8.98363647
   9.42357218  8.30976918  8.05669248  8.4286626 ]
 [17.54624772 13.67865205 11.71313441 10.89202577  9.67525047  9.5759396
   9.28882611  8.75991464  7.992632    7.71196049]
 [17.04016304 13.4152534  11.88022071 10.62619889 10.14749742  9.57166308
   9.06076366  8.51775485  8.87347454  7.88310087]
 [17.36170793 13.61568844 12.05002058 10.93295413  9.62020963  9.48881567
   9.74120659  8.8956936   8.84067345  8.42471325]]
Test accuracies per communication round for each client:  [[0.51762762 0.56812339 0.60613294 0.64230628 0.65956665 0.66911495
  0.68031583 0.6852736  0.69831069 0.7071245 ]
 [0.5191448  0.57356657 0.60602527 0.64159378 0.66044704 0.67696793
  0.68726919 0.69135083 0.70748299 0.71311953]
 [0.52299606 0.57386897 0.61685752 0.642951   0.66510231 0.67899381
  0.69082035 0.71109442 0.72329641 0.72817721]
 [0.52282158 0.57459859 0.61753563 0.64513801 0.66877142 0.67779181
  0.69709544 0.70665704 0.71387335 0.72253292]
 [0.52849935 0.58157354 0.61894973 0.65071949 0.67239768 0.68435806
  0.6957578  0.7075313  0.70921323 0.71481966]
 [0.53772719 0.586745   0.62089223 0.65687534 0.67064439 0.68826877
  0.69616303 0.71250229 0.71892785 0.72094731]
 [0.52590674 0.58197631 0.61713546 0.64914878 0.66876388 0.67801628
  0.69189489 0.7011473  0.70836417 0.71373057]
 [0.53967411 0.59263195 0.63071201 0.65834219 0.67959617 0.69128587
  0.70598654 0.71448813 0.72174991 0.72848034]
 [0.54676128 0.59716157 0.63537118 0.66466521 0.69232169 0.69796215
  0.70614993 0.72034207 0.72725619 0.73580786]
 [0.53444958 0.58352579 0.61701309 0.65223249 0.67301771 0.68283295
  0.69515012 0.69996151 0.71150885 0.72151655]]


Train losses per communication round:  [1.9159693474544137, 1.488689006676922, 1.2508203659498602, 1.1210879585638283, 1.0396128521679664, 0.9815277722461107, 0.9302184181686648, 0.8906533175790798, 0.8574841592230635, 0.8300550271956452]
Test losses per communication round:  [18.210154342651368, 14.404057037830352, 12.519115763157606, 11.396987971663474, 10.780874904990196, 9.975315889716148, 9.54531416296959, 9.375087314844132, 9.08409125804901, 8.440245759300888]
Test weighted accuracies per communication round:  [0.5078409515172788, 0.5651029786907676, 0.6012259206383733, 0.6321940711194951, 0.6541819929630227, 0.6684684791585056, 0.6862248046030619, 0.6968333244722755, 0.7085741334453374, 0.7143547700073165]
Test losses per communication round for each client:  [[18.20560563 14.89661813 12.93563175 11.78701377 10.4915598   9.81836843
   9.36404276  9.00687236  8.73956108  8.20341596]
 [18.5367794  14.42846906 11.29861604 10.4196721  11.41480917  9.24625754
   8.65162516  9.47193962  9.10695034  7.67029843]
 [18.39567411 14.38936818 13.19842792 11.57839859 10.41018718 10.15186036
   9.29925615  9.44174755  9.31519037  8.46120769]
 [17.99317312 14.08277345 12.51307452 11.43306553 11.15757394 10.40797246
   9.69915372  9.57391149  9.08238977  8.66087717]
 [18.19433308 14.62428987 12.63000453 11.1577307  10.50381476 10.39881349
   9.92375851  9.23932034  8.62809104  8.36692059]
 [18.10150838 14.82661188 12.4242205  11.02184051  9.93368235 10.14027947
   9.14761442  9.50267458  9.44513512  8.28416353]
 [17.94850039 14.2657367  13.11307847 11.96762252 11.46455961  9.76782343
   9.94351256 10.53667361  9.43327457  8.8555845 ]
 [18.15392089 14.3353734  12.49835348 11.36957204 10.73233825 10.46568698
   9.59992689  9.0551945   8.82462656  8.31662977]
 [17.92097616 14.24733198 12.76186037 11.34506112 11.17458791  9.66717368
   9.61068189  9.02421093  9.5744012   8.73870051]
 [18.65107226 13.94399774 11.81789005 11.88990283 10.52563608  9.68892306
  10.21356958  8.89832819  8.69129252  8.84465945]]
Test accuracies per communication round for each client:  [[0.49907647 0.5585519  0.59512375 0.62615441 0.65238271 0.67233099
  0.68341337 0.69375693 0.70336165 0.71001108]
 [0.51947111 0.57489585 0.61709835 0.64988227 0.6650969  0.68013041
  0.69262815 0.70512588 0.71291433 0.72178953]
 [0.50108976 0.55854963 0.59124232 0.61977412 0.64929661 0.66118486
  0.67980979 0.69011294 0.70120864 0.7057658 ]
 [0.49858507 0.55535904 0.59727626 0.62398302 0.64856739 0.66024054
  0.67916519 0.69225327 0.70374956 0.71117793]
 [0.50841555 0.56142387 0.60088992 0.63513252 0.65235055 0.6655059
  0.68311085 0.69433159 0.70613271 0.71290385]
 [0.50562627 0.56188895 0.59546209 0.62442354 0.64785095 0.66094816
  0.68511345 0.69064748 0.70669618 0.7146283 ]
 [0.48413156 0.54914407 0.58684362 0.61627236 0.63993076 0.65762647
  0.6762839  0.69032506 0.69878823 0.70494326]
 [0.51180393 0.57019283 0.60154983 0.63921427 0.6566949  0.67273383
  0.6909353  0.70066679 0.71580465 0.71706614]
 [0.51776293 0.57439325 0.60517059 0.63717904 0.66373549 0.67235315
  0.69539219 0.70137179 0.71122054 0.72036581]
 [0.53248455 0.58621981 0.62160644 0.64931661 0.66560569 0.68095862
  0.69574986 0.70941771 0.7257068  0.72458341]]


Train losses per communication round:  [1.9302660824510962, 1.5008828141262436, 1.2373843219407217, 1.1016828805059204, 1.0204357213821527, 0.9649417320765412, 0.9236657932817355, 0.8917093311393639, 0.8593891274893812, 0.8377956785288279]
Test losses per communication round:  [18.014862728118896, 14.220712262392045, 11.995684817433357, 10.935778871178627, 10.270459660887719, 9.633621907234192, 9.312767231464386, 8.81424508690834, 8.792026326060295, 8.493869933485986]
Test weighted accuracies per communication round:  [0.4865075252610817, 0.5675241628688092, 0.6073137826461317, 0.6337777877255649, 0.6546802875096105, 0.6677491391387683, 0.6788545218524238, 0.6920989088664742, 0.6979853779489893, 0.70434482390565]
Test losses per communication round for each client:  [[18.15146446 14.9683944  11.96177864 11.45332152 10.76751322  9.66985148
   9.28672367  9.21393269  8.94308311  8.77211624]
 [18.22846401 14.71550131 11.55534455 10.9076786  10.4106943   9.77490044
   9.37011623  8.85434812  9.02691555  8.32196873]
 [18.58237016 14.47422683 12.07257456 11.39498442 10.77054805  9.80997187
   9.48668063  9.08226848  8.6215533   9.0823276 ]
 [18.5299356  14.04673362 12.02622962 10.76770896 10.32653975 10.18785125
   9.75853187  8.92759377  9.13210911  8.62822127]
 [16.62178183 13.06500697 11.12516868 10.09930378  9.3406502   9.00427926
   8.47972965  8.23040116  7.99617666  7.81704998]
 [18.02838278 14.66872513 12.35800815 11.67431951 10.53857976  9.81839031
   9.35230422  8.68821913  9.07541734  8.38773954]
 [18.59008718 14.72362185 12.82343018 11.09986663 10.33767051  9.39875615
   9.52648842  9.02842265  8.35607293  8.70239013]
 [18.33674788 13.97530717 12.21791804 10.71512315  9.91536281  9.75188428
   9.43893623  8.92030737  9.4066788   8.37951121]
 [18.54842281 14.60103202 12.72944963 11.15468884 10.96072942  9.94683456
   9.88140601  8.99459526  9.47166377  9.06513351]
 [16.53097057 12.96857333 11.08694613 10.09079331  9.3363086   8.97349948
   8.54675537  8.20236224  7.89059269  7.78224111]]
Test accuracies per communication round for each client:  [[0.47650765 0.5639964  0.60540054 0.62952295 0.65256526 0.66624662
  0.67650765 0.69108911 0.69684968 0.70657066]
 [0.48479159 0.56496433 0.61209163 0.64232069 0.66090875 0.67761923
  0.69188885 0.70540744 0.71160345 0.71817499]
 [0.47657271 0.56076162 0.5951092  0.61937652 0.63935038 0.65559082
  0.67145791 0.68097816 0.68527161 0.68844503]
 [0.4944413  0.57772753 0.61277558 0.63953269 0.656303   0.67156586
  0.68249482 0.7047296  0.70736763 0.71660072]
 [0.49213483 0.56779026 0.61460674 0.63520599 0.65861423 0.66385768
  0.68483146 0.69400749 0.7005618  0.70636704]
 [0.47259508 0.55219985 0.59694258 0.62826249 0.6536167  0.66349739
  0.67114094 0.68195377 0.68941089 0.69500373]
 [0.48873265 0.57057869 0.60681449 0.64214891 0.65909501 0.67261583
  0.67874527 0.69641248 0.70146025 0.71317829]
 [0.49294245 0.56967065 0.6087586  0.63282664 0.65743757 0.67372421
  0.67788636 0.68964893 0.69363011 0.7034021 ]
 [0.48835109 0.56619108 0.60140871 0.62687376 0.6461983  0.6573957
  0.66534224 0.67744266 0.68683403 0.68882066]
 [0.49844358 0.58151751 0.61964981 0.64280156 0.66361868 0.67626459
  0.68891051 0.70038911 0.7077821  0.70836576]]


Train losses per communication round:  [1.8709613803007052, 1.4121073740835224, 1.192023557776737, 1.076369094904619, 0.9969442085078855, 0.9387176346367146, 0.9000671352019756, 0.8604742689259336, 0.8252585526143348, 0.8037003960699348]
Test losses per communication round:  [17.744055497646332, 14.374838387966156, 14.087897208333015, 12.73250925540924, 10.688268872350454, 12.40868400633335, 10.134155395627023, 10.206334763765335, 9.170350638806122, 10.082843652367592]
Test weighted accuracies per communication round:  [0.5005805031596862, 0.5374332936668561, 0.5538439483412728, 0.5964128522259988, 0.6462475342327656, 0.5975321378512709, 0.6727910150494177, 0.6701248250488543, 0.6782266756270172, 0.6655493477636283]
Test losses per communication round for each client:  [[17.42467582 14.63226676 14.34120488 12.43814969 10.44975829 12.58355522
  10.03938651 10.30386329  9.00533861 10.80479288]
 [17.68368876 13.60387865 13.02485177 12.34379101 10.87535775 11.69954225
  10.06201959  9.79234481  9.55531067 10.14691842]
 [17.90689027 14.75792158 13.55552346 13.09572613 10.79130864 12.11914831
  10.04822707 10.31819272  9.37462801  9.78098708]
 [17.99607861 13.68797466 15.80631709 12.00657403  9.94423722 12.95728958
  10.43298709 10.54303306  8.18131367  9.63619512]
 [18.11044705 14.83486485 14.15782225 12.94990194 11.07569486 12.20646751
  10.48956513 10.44669229  9.68793577 10.4012059 ]
 [17.46265054 14.14554834 14.30405438 12.70136571 10.87596333 12.86412489
  10.85376227 10.30347836  9.04327428 10.2294035 ]
 [17.56351519 14.0246377  13.78255165 12.87906611 11.05196661 12.24004591
   9.73974448 10.14232999  8.95334178 10.21298367]
 [17.81956124 14.36089599 13.93954563 12.79976821 10.79305613 12.20181441
  10.1945737   9.89430994  9.22116536  9.32367423]
 [17.4643594  15.03546321 13.86547685 12.71647954 10.51769605 12.6924181
   9.90406287 10.39997232  9.16451722 10.37823838]
 [18.00868809 14.66493213 14.10162413 13.39427018 10.50764984 12.52243388
   9.57722524  9.91913086  9.51668102  9.91403735]]
Test accuracies per communication round for each client:  [[0.50557029 0.54465075 0.56162688 0.59876216 0.65587975 0.60194518
  0.67798408 0.67267905 0.6801061  0.66401415]
 [0.50204161 0.5323741  0.55590122 0.59517791 0.6389267  0.58856698
  0.66653704 0.66614816 0.67781451 0.67023138]
 [0.49231895 0.52907827 0.54059985 0.58266277 0.63405267 0.59528164
  0.661485   0.66843453 0.67099488 0.66349671]
 [0.50899451 0.54989585 0.55974247 0.60708199 0.65252793 0.59893959
  0.68149972 0.66862337 0.69570157 0.66464685]
 [0.48219717 0.52352836 0.5410628  0.58776167 0.64000716 0.59384505
  0.67257112 0.67078189 0.67292897 0.66863482]
 [0.5019414  0.54041652 0.55665372 0.60218849 0.65495941 0.60060007
  0.67666784 0.67737381 0.67790328 0.66872573]
 [0.51142292 0.54578162 0.55927325 0.60514481 0.65065659 0.60298615
  0.68321641 0.67260299 0.67386221 0.66972477]
 [0.50863061 0.53720752 0.55926352 0.59915612 0.65228232 0.60260836
  0.67337936 0.67203682 0.67721519 0.66647488]
 [0.48469484 0.5256338  0.53802817 0.58422535 0.63849765 0.5885446
  0.65971831 0.65596244 0.67793427 0.64732394]
 [0.50744514 0.54525862 0.56524295 0.60109718 0.64498433 0.6020768
  0.67398119 0.67633229 0.67731191 0.67104232]]


# federated baseline non-IID 10.0 with no pre-training
Train losses per communication round:  [1.8476103012134568, 1.398443775308915, 1.183768702424244, 1.0750336078256653, 1.0057174294306876, 0.9515934352151149, 0.9094119606545913, 0.8775537592303226, 0.8412034792194193, 0.8183192237191909]
Test losses per communication round:  [17.87848880290985, 14.382111054658889, 11.698402827978134, 11.633683031797409, 10.821281623840331, 9.86128677725792, 9.447130212187767, 9.91483719944954, 8.585736618936062, 8.471720439195632]
Test weighted accuracies per communication round:  [0.5151882613483757, 0.5692726909197615, 0.6161082423297629, 0.6097035704704381, 0.641021351135665, 0.6685063952593554, 0.6850786858098614, 0.6743873586376153, 0.7082534803911971, 0.7125228254264283]
Test losses per communication round for each client:  [[17.63015521 14.00259399 11.46456289 11.92228007 10.85481602  9.86089474
   9.00321943  9.6594739   8.28759408  8.78546518]
 [16.46190071 13.40932846 11.06581366 10.91228426 10.22376102  9.38603097
   8.95022309  9.302948    8.16639906  8.0582931 ]
 [17.6489141  14.8889302  11.9843756  11.07657689 11.13476634  9.42807198
   9.56643736 10.38983476  8.57780373  8.6882115 ]
 [16.47366786 13.00085509 10.64128923 10.69755816  9.56853932  8.81434399
   8.40408921  8.64586985  7.61666304  7.51103038]
 [18.30357015 15.32684052 11.92917109 12.35054338 11.43099213 10.39167881
   9.82898659 11.32767463  9.81483716  8.6025537 ]
 [18.85874736 15.2919389  12.58792388 12.35278404 11.7291863  10.72361213
   9.95512241  9.90163702  8.55425663  9.22104281]
 [18.34655809 14.03133172 11.91466331 11.77759218 10.6821574  10.04505676
   9.70016485 10.01243615  8.88617665  8.55623984]
 [17.82798207 14.4271493  11.38659918 11.2740885  10.34048003  9.67931598
   9.03448358 10.15631056  8.33181196  8.41693628]
 [19.00281405 15.13399649 11.81178862 12.05298316 11.004628    9.8839137
  10.18729544  9.88017595  9.25636357  8.04888573]
 [18.23057842 14.30814588 12.19784081 11.92013967 11.24348968 10.39994872
   9.84128016  9.87201118  8.36546031  8.82854587]]
Test accuracies per communication round for each client:  [[0.53795192 0.59435927 0.63259512 0.61461291 0.66439523 0.68748817
  0.70584895 0.6967632  0.72704903 0.72950975]
 [0.51581109 0.56468172 0.6174538  0.6110883  0.62197125 0.64784394
  0.67125257 0.66036961 0.6963039  0.70287474]
 [0.54043221 0.58644127 0.63140467 0.63576159 0.64970373 0.67950505
  0.69309864 0.6814221  0.71244336 0.72098292]
 [0.53103448 0.59408867 0.63267652 0.62824302 0.65829228 0.68965517
  0.70525452 0.69195402 0.72840722 0.72939245]
 [0.48905109 0.53116227 0.58787198 0.59835299 0.63091896 0.6464533
  0.65880591 0.65244245 0.68257533 0.69137189]
 [0.47664647 0.52999805 0.5860856  0.57944108 0.62438929 0.64647254
  0.65370334 0.65565761 0.68067227 0.68204026]
 [0.51515152 0.56955923 0.61604683 0.60003444 0.64187328 0.67062672
  0.69197658 0.67665289 0.71573691 0.71745868]
 [0.53114305 0.57991102 0.62234771 0.61875428 0.6473306  0.67813142
  0.69113621 0.67453799 0.71697467 0.72279261]
 [0.51886792 0.57675815 0.61835334 0.6147084  0.63572041 0.66831046
  0.69210978 0.68181818 0.71633791 0.71848199]
 [0.49980931 0.56693364 0.61651411 0.597254   0.63863463 0.67181541
  0.68916857 0.67372235 0.70747521 0.71243326]]


Train losses per communication round:  [1.8398710316356837, 1.3780135111929641, 1.1628330812812422, 1.050689045291473, 0.9824985217122949, 0.932212807253911, 0.8946967260955034, 0.8617750937736052, 0.8354168542379407, 0.8127391656089532]
Test losses per communication round:  [17.001275312900543, 13.513444197177886, 11.676908448338509, 10.863464903831481, 10.091387777030468, 9.770098032057286, 9.28275837674737, 8.939633870124817, 8.574681892991066, 8.321733799576759]
Test weighted accuracies per communication round:  [0.5216820139718841, 0.5823230858648263, 0.618580325661118, 0.6450203718453634, 0.6663846552417392, 0.679328153430057, 0.6907737500950589, 0.7016454949606555, 0.7081328885323118, 0.7150570702614537]
Test losses per communication round for each client:  [[17.2207495  13.50636017 12.63061905 10.66771406 10.54834908 10.07777882
   9.47417837  9.31626463  9.20406926  8.85651332]
 [17.62236738 14.26883268 12.57834983 11.52201217 10.25553325 11.23592424
   9.80347413  8.8292703   8.92987338  8.99707323]
 [16.84416938 13.50770783 11.59655595 11.98736668 10.90510726  9.49727178
   8.5091025   9.39836687  8.31815407  7.85599899]
 [16.69251454 13.43826711 11.39176118 10.7168287   9.53519115  9.85548294
   8.85621446  8.79725075  8.69273162  8.20003003]
 [17.88667917 13.99580598 11.53502014 11.63907707  9.88486646 10.63819194
  11.04621434  9.33154595  8.59193063  8.50214121]
 [16.94389582 13.15740985 11.74075687 10.95580512 10.20444936  8.89317055
   9.85152912  9.50715882  8.33310872  8.84476864]
 [17.03106427 13.06024611 11.33328986  9.89778674  9.91062748  8.88462782
   8.5098111   8.59480405  8.32095784  7.56028146]
 [16.72538388 14.62944317 11.50532216 10.71625209 10.50796366  9.93010259
   8.89565969  8.67556787  8.92307514  8.34497786]
 [17.26655722 13.19957489 11.54484719 10.49535745  9.77142149  9.75190723
   9.33274275  8.60963851  8.34502032  8.14488965]
 [15.77937198 12.37079418 10.91256225 10.03644896  9.39036858  8.93652242
   8.5486573   8.33647096  8.08789796  7.9106636 ]]
Test accuracies per communication round for each client:  [[0.51676424 0.58559517 0.61557566 0.63970197 0.65566791 0.66471527
  0.67784282 0.68901898 0.69629235 0.70072734]
 [0.49627159 0.55435636 0.59478022 0.61872057 0.64246468 0.65973312
  0.66405024 0.68426217 0.68563579 0.69348509]
 [0.52542045 0.58225401 0.62033636 0.64604678 0.66847091 0.67987628
  0.68896192 0.69901411 0.71699207 0.72066499]
 [0.51699717 0.59029745 0.62641643 0.65226629 0.67404391 0.68767705
  0.68997875 0.70662181 0.71423513 0.72291076]
 [0.50406197 0.55998489 0.59890421 0.62743246 0.65048177 0.6671075
  0.67938787 0.69317967 0.69790289 0.69941432]
 [0.51621979 0.5796094  0.61916584 0.64829527 0.66914929 0.6878517
  0.70109235 0.70539556 0.71466402 0.72591857]
 [0.54070661 0.59869432 0.64420123 0.66781874 0.6891321  0.69969278
  0.71639785 0.72465438 0.73713518 0.74155146]
 [0.54890052 0.60649215 0.63183246 0.65403141 0.67225131 0.68816754
  0.69926702 0.71162304 0.7086911  0.72167539]
 [0.54298203 0.59527279 0.630565   0.66083859 0.68123685 0.68415088
  0.70212077 0.71377691 0.7123199  0.7246236 ]
 [0.50828283 0.57070707 0.60545455 0.63676768 0.66282828 0.67353535
  0.68848485 0.68949495 0.69818182 0.69959596]]


Train losses per communication round:  [1.8822396349799342, 1.4656451011630525, 1.2260103367145483, 1.09135014091726, 1.0074846523660193, 0.976171471064222, 0.902503792312406, 0.892296448280432, 0.8608596366371568, 0.8204855841924401]
Test losses per communication round:  [19.665646862983703, 15.364568257331848, 13.818737882375718, 11.906958717107774, 10.614558842778205, 28.73994333744049, 12.082548373937607, 17.90631071701646, 44.09360601902008, 10.182993415743113]
Test weighted accuracies per communication round:  [0.4698539710729161, 0.5059642502723675, 0.5797923043282118, 0.6123978919483286, 0.6605696934395203, 0.2768203861689204, 0.6144337798460939, 0.3932880249119744, 0.2028617065750609, 0.6522874908106914]
Test losses per communication round for each client:  [[19.70160282 15.13489926 14.21270478 12.67852306 11.09372461 27.99873328
  11.71627653 17.39622748 41.35862756 10.15762347]
 [19.83722675 14.87699699 13.69257212 10.93876761  9.37528482 27.44199538
  10.91085842 15.83114547 48.23849964  8.98007317]
 [19.81528211 16.23687863 13.4951148  12.01003426 10.24031299 29.13736582
  11.93262184 17.16870526 45.82923412  9.54235756]
 [19.37632668 15.65173912 14.30825913 11.55750614 11.85106117 30.1067872
  12.63864791 18.11463761 46.62152243  9.28866568]
 [19.83297336 15.82093716 14.72066939 12.80783069 10.52168614 28.5972476
  12.15612209 18.67307019 43.04454565 10.69156754]
 [19.75299275 16.00010157 14.3887713  12.14687145 10.68841147 29.21494222
  12.17185941 19.03389907 41.62751269 10.61158776]
 [20.03404164 15.00335193 14.05192953 11.89856446 11.68245429 28.67081106
  12.22704715 18.04193562 45.22591376 12.21281606]
 [19.56114006 14.91659272 12.45876741 10.78832352 10.33670795 27.77300537
  12.3344143  17.76146364 41.13850904 10.48869419]
 [19.49957919 15.19150043 14.11651993 12.35216933 10.5144099  30.72028756
  12.54502618 18.62731957 45.89587164 10.52284294]
 [19.24530327 14.81268477 12.74207044 11.89099663  9.84153509 27.73825788
  12.19260991 18.41470325 41.95582366  9.33370578]]
Test accuracies per communication round for each client:  [[0.46420649 0.49163138 0.58580359 0.60274249 0.6630369  0.29663239
  0.63399879 0.39967735 0.23290986 0.67029643]
 [0.50634642 0.52841242 0.60417887 0.6404999  0.67877368 0.32923257
  0.63386057 0.42433119 0.19761765 0.66510447]
 [0.47611681 0.53974086 0.59620963 0.62966544 0.67046993 0.25604332
  0.58557339 0.36317927 0.17907561 0.64184877]
 [0.45638717 0.48339899 0.56837366 0.59819921 0.64903395 0.26073907
  0.61939599 0.39636091 0.17107485 0.66141437]
 [0.44963971 0.48502802 0.55404323 0.5988791  0.64723779 0.25940753
  0.60656525 0.37838271 0.17966373 0.64323459]
 [0.45551961 0.48301658 0.55337647 0.58976951 0.63465427 0.29417711
  0.58613021 0.39203397 0.2179539  0.63445208]
 [0.45790104 0.47865124 0.5528731  0.59457302 0.63886672 0.26556265
  0.6075419  0.38766959 0.2057063  0.62470072]
 [0.47756628 0.5175051  0.5985724  0.62015636 0.68167913 0.28127124
  0.63120326 0.40516655 0.2324949  0.67980965]
 [0.4640853  0.51889263 0.57388702 0.6157875  0.65955855 0.22727273
  0.60643472 0.36344931 0.16965956 0.63150019]
 [0.493066   0.5390142  0.61654135 0.63876358 0.68721805 0.29289891
  0.63943191 0.42238931 0.23458647 0.67451963]]


Train losses per communication round:  [1.8596470330351278, 1.403491382251453, 1.1771792361411726, 1.0590191350198543, 0.9812768902559663, 0.9276147906267971, 0.8967531465040126, 0.8507520009039, 0.8236237291347308, 0.7936437936596104]
Test losses per communication round:  [17.407439988851547, 14.194182568788529, 11.927547034621238, 11.646014469861985, 12.26669710278511, 9.716899609565735, 11.934177380800246, 9.129099516570568, 8.382095239683986, 8.244678817689419]
Test weighted accuracies per communication round:  [0.5269784627328814, 0.5796879002828972, 0.6246042768275453, 0.6156560359223665, 0.6048819721661753, 0.676425535845896, 0.6262843404527122, 0.6937268089042417, 0.7171536690608847, 0.7236111753375927]
Test losses per communication round for each client:  [[18.28619194 14.47495699 12.91941333 11.95914632 12.58086646  9.90857685
  11.81700754  9.4601534   8.51978517  8.2625587 ]
 [17.02566803 13.76610732 11.68010247 11.43324792 11.64353716  9.23719954
  11.31049746  8.19286905  8.46392667  8.50449538]
 [17.40712285 13.43778515 12.14732575 10.74933946 11.53782463 10.24709761
  11.62229371  9.61659521  8.23109746  7.90139449]
 [15.93048507 13.43457603 10.27688658 10.63033527 12.67597383  8.77003717
  10.86377352  7.5084815   7.74695176  7.41842389]
 [17.64158189 14.9189992  12.43368995 11.90843803 12.73318064 10.06445229
  12.0633986   9.7441957   9.37310308  8.66223168]
 [17.25562918 14.77899563 11.27336702 11.02703869 11.78688955  9.08816478
  11.81465232  9.18827659  7.7841943   7.89295989]
 [17.66838551 14.98545146 12.17341536 12.03271973 13.26869202  9.89359057
  12.27244097  8.99236262  8.82353532  8.48970187]
 [17.05378687 13.93078905 12.42016387 11.84624326 12.14736199 10.51500118
  13.12812531  9.9828589   8.16858262  7.72520171]
 [17.85931993 13.98446226 11.67061174 12.25722599 12.05180407  9.56038371
  12.19995511  8.99560058  8.14699954  8.28218335]
 [17.94622862 14.22970259 12.28049427 12.61641002 12.24084067  9.8844924
  12.24962926  9.60960162  8.56277648  9.30763721]]
Test accuracies per communication round for each client:  [[0.49712276 0.55738491 0.61476982 0.59462916 0.57992327 0.66048593
  0.61908568 0.68877877 0.70828005 0.71579284]
 [0.54826635 0.60638298 0.64775414 0.64342002 0.63258471 0.7037037
  0.64164697 0.70882585 0.74152876 0.7429078 ]
 [0.54019074 0.59213215 0.626703   0.64032698 0.62840599 0.6898842
  0.63947548 0.69124659 0.72547684 0.73382153]
 [0.5965251  0.64907765 0.66966967 0.66795367 0.66001716 0.71364221
  0.67009867 0.72951523 0.75096525 0.75246675]
 [0.48513741 0.54870069 0.59319499 0.59880351 0.57356515 0.65881473
  0.6292765  0.6752664  0.69957001 0.70125257]
 [0.54666398 0.58980044 0.62588188 0.6097561  0.59947591 0.67546866
  0.62124572 0.69602903 0.71054223 0.72082241]
 [0.50449983 0.55036345 0.61838006 0.59345794 0.58809277 0.66251298
  0.60159225 0.68812738 0.7101073  0.72326064]
 [0.53169695 0.57460379 0.61364515 0.63200618 0.61712408 0.67549285
  0.62582141 0.67413993 0.71492076 0.72400464]
 [0.52256074 0.58291554 0.63748554 0.59274971 0.59043579 0.6723872
  0.61396066 0.70960278 0.71384497 0.72695719]
 [0.50105522 0.55276117 0.60622582 0.58670419 0.58494548 0.65687654
  0.60376363 0.68255364 0.70154766 0.69943721]]


Train losses per communication round:  [1.8766765432951018, 1.440398411890667, 1.2011320969968482, 1.0737772385925293, 0.9912305019352674, 0.9367640758095434, 0.8902827814238885, 0.8513686235998504, 0.8245064238383615, 0.8044691369258846]
Test losses per communication round:  [18.372528111934663, 14.259902864694595, 12.33770222067833, 10.898939870297909, 10.281140100955962, 9.896355539560318, 9.30064494907856, 8.871138948202134, 8.445200961828231, 8.703711032867432]
Test weighted accuracies per communication round:  [0.4843595165902403, 0.5843269406285828, 0.618069404856986, 0.6465284795758975, 0.6674982181390444, 0.6882785157178373, 0.6941307073849584, 0.7060080096642272, 0.7189599434764536, 0.7080703695629944]
Test losses per communication round for each client:  [[17.84083188 13.53249258 11.96133566 10.51543254  9.66603374  9.74380904
   8.37851295  8.13332665  8.025769    8.04434609]
 [18.46032572 14.19619179 12.46661448 10.75024188 10.04239678  9.20520961
   8.92346406  8.73035967  8.14847344  8.33045503]
 [18.86104441 14.75542068 12.29156882 11.53698677 10.55235964 10.21359634
   9.7571739   9.04836428  8.67176759  8.40538525]
 [18.09848154 14.05547678 12.66616666 11.23025662 10.4029237   9.88762784
   9.49493772  9.11234409  8.79569817  9.62434506]
 [18.51344121 14.93852866 13.41222608 11.5034225  10.36475307 10.81831396
  10.27348018  9.10556978  9.24605316  9.0182479 ]
 [18.98197532 14.35313189 13.12435007 11.2443763  10.46664506  9.89548105
   9.37260604  9.2692371   8.61129224  9.55929273]
 [18.80057704 14.69777334 11.86585522 10.77047646 10.44175136  9.32910174
   8.91033179  8.82156318  8.27831078  9.21031201]
 [17.25377405 13.55508924 10.73185897  9.56295894 10.01219153 10.42835802
   8.01636934  8.76784593  7.42010659  7.26763835]
 [18.45659351 14.33570051 12.0405854  11.19198269 10.80448157  9.70656699
   9.73526001  9.22852486  8.74805295  9.43039852]
 [18.45823646 14.17922318 12.81646085 10.68326402 10.05786455  9.7354908
  10.14431351  8.49425393  8.5064857   8.14668937]]
Test accuracies per communication round for each client:  [[0.51321353 0.60447498 0.64164905 0.66842847 0.68939394 0.70877378
  0.7167019  0.72374912 0.73854827 0.73185342]
 [0.47732786 0.58667662 0.62623624 0.64732226 0.66523605 0.68632208
  0.70013062 0.70946072 0.72308266 0.71524538]
 [0.45262747 0.56104708 0.60070326 0.62941981 0.65540145 0.67767142
  0.68235984 0.69915999 0.71107638 0.69701113]
 [0.52659214 0.59400407 0.60636856 0.64227642 0.65955285 0.67445799
  0.68597561 0.69071816 0.70613144 0.68495935]
 [0.42634665 0.5476365  0.60076951 0.62971785 0.6515207  0.67423965
  0.67259069 0.68468303 0.69769146 0.69256138]
 [0.49124726 0.58315098 0.5940919  0.62764406 0.64606127 0.6694019
  0.67487236 0.69164843 0.70113056 0.6885485 ]
 [0.49623315 0.58148295 0.61954798 0.64532117 0.66137986 0.68576527
  0.68636003 0.70142744 0.71233148 0.70816812]
 [0.50711194 0.61059575 0.65594723 0.67656153 0.70171099 0.71799629
  0.72253144 0.72995259 0.7429396  0.73572459]
 [0.47404103 0.58501338 0.61088314 0.64299732 0.66690455 0.68991971
  0.69063336 0.70472792 0.72096343 0.70169492]
 [0.4804652  0.58876976 0.62166091 0.65418862 0.67581319 0.69580229
  0.70670543 0.72106124 0.73287298 0.72087952]]


# federated baseline non-IID 1.0 with no pre-training
Train losses per communication round:  [1.6991329574587994, 1.4151581777897615, 1.2059202291990314, 1.0581948326523407, 0.9742793098045445, 0.9068719817813736, 0.8575918332498181, 0.8271534907744658, 0.7877667373061222, 0.7679007881697986]
Test losses per communication round:  [20.820735847949983, 17.827367222309114, 13.915144407749176, 12.177946579456329, 13.167621493339539, 14.783277440071107, 10.272098985314368, 10.338391947746278, 9.73701314330101, 10.034207257628442]
Test weighted accuracies per communication round:  [0.41596694802326273, 0.5245475772753061, 0.5864144735865915, 0.6270183734021674, 0.6056913886402078, 0.5545444121403491, 0.6543929704659107, 0.6825156697407497, 0.6955031532844704, 0.6854974215657812]
Test losses per communication round for each client:  [[21.26658142 17.92767501 11.39186168 10.26798147 12.374717   15.82284439
   8.07338181  9.05918759  8.11384368  8.84205586]
 [18.95354164 16.4737184  12.97589028 11.5019691  11.62251866 13.86823344
   9.71059954 10.13851166  9.89993662  9.83318806]
 [20.04726279 17.51048565 13.18880796 11.82327282 14.13796091 17.1646657
  10.0183506  10.48495185  9.89166772 11.40121645]
 [20.90659797 17.74355567 15.00188696 12.84696901 13.43257213 16.06349611
  11.9188664  10.97680062 10.26878846 10.67322242]
 [20.1545428  16.95447505 13.59585416 11.1659916  12.27342176 13.70496559
   9.9597947   9.78262979  9.40882951  9.30011016]
 [20.91935551 18.61043584 15.58586204 14.01390278 14.65807426 16.10177517
  12.03639591 12.24431407 11.9562577  11.75111383]
 [20.32708597 17.03305018 11.95036054 10.74076396 11.85069501 13.3470391
   8.62002933  9.5211013   9.50969303  9.19376177]
 [21.73393226 17.95639622 13.89998364 12.19493455 13.54255581 13.35518205
  10.67094237 10.65610766  9.36247259  9.6575968 ]
 [21.73515713 18.87067354 14.40536785 12.82601631 13.09578955 15.00281787
  10.12729335 10.14329261  9.45413488  9.73601502]
 [22.16330099 19.19320667 17.15556896 14.39766419 14.68790984 13.40175498
  11.58533585 10.37702233  9.50450724  9.95379221]]
Test accuracies per communication round for each client:  [[0.46394032 0.61425808 0.69245648 0.71843051 0.67504836 0.5846919
  0.72672009 0.75490467 0.77010224 0.75766786]
 [0.36553134 0.45517711 0.53378747 0.5846049  0.5846049  0.50980926
  0.61607629 0.63283379 0.63746594 0.64441417]
 [0.54418869 0.58965615 0.61608411 0.63910202 0.5942029  0.49417448
  0.67064507 0.71128161 0.70957658 0.68286445]
 [0.40027096 0.49315068 0.5614933  0.60153545 0.58934216 0.52235436
  0.61628782 0.64398615 0.65979226 0.64774951]
 [0.47168662 0.596712   0.64745281 0.67972397 0.64643799 0.6342602
  0.6856099  0.7055003  0.7337122  0.72194033]
 [0.4380704  0.46235332 0.49527379 0.50977836 0.53210561 0.45664928
  0.58262712 0.59647979 0.58441982 0.57708605]
 [0.47752453 0.59575815 0.67806268 0.68296929 0.66967395 0.62013295
  0.72348845 0.71035138 0.71573283 0.72174739]
 [0.34467456 0.49408284 0.57429323 0.632643   0.60585141 0.5977975
  0.64792899 0.6808021  0.70430638 0.68704799]
 [0.32166392 0.4485173  0.54736409 0.60687809 0.59266886 0.53088962
  0.64229819 0.70078254 0.70304778 0.71396211]
 [0.22817025 0.42957437 0.48617815 0.60048267 0.56888986 0.61452391
  0.62659061 0.68100044 0.73168056 0.71588416]]


Train losses per communication round:  [1.7524964944427968, 1.3532111377943539, 1.121705746986202, 0.995637548607807, 0.9191096163977935, 0.8785366734142128, 0.8488092659701694, 1.021362483395406, 0.8899529119333295, 0.8243637796999265]
Test losses per communication round:  [18.958171951770783, 14.512459322810173, 12.561457860469819, 11.279517444968224, 10.652421819418668, 15.333321076631545, 22.305838268995284, 21.25516837835312, 12.064900249242783, 10.256442648172378]
Test weighted accuracies per communication round:  [0.5081603217142673, 0.5664168814949904, 0.6023488094935291, 0.6305904775090783, 0.6503332539517829, 0.4269809429673531, 0.39693599384091516, 0.3748937896906004, 0.6000172497893097, 0.6478870406337098]
Test losses per communication round for each client:  [[16.54198408 13.12985206 11.00877178 10.34272105  9.62217474 14.32537794
  21.29233551 17.31162238 10.89128137  9.48084652]
 [19.12334347 14.07597917 12.01162213 10.51274882 10.51449239 14.74770701
  23.99754143 22.66719663 10.71349713 10.07373065]
 [18.30790269 13.45173597 11.36048806 10.06113029 10.19925737 12.52710706
  17.20290244 16.57827055 12.8915832   9.54094994]
 [20.22913539 13.59641099 12.88257253 10.67697015 10.66864032 14.27516544
  20.35799944 19.49767125 12.73762846  9.3810516 ]
 [19.21704113 15.69547427 13.8134917  12.10658157 11.22364348 13.79705834
  23.07920074 21.79661465 12.36874413 10.16319895]
 [19.55225718 16.85502005 13.90416384 12.76190269 11.74106652 17.76353371
  26.52019262 22.37938917 13.08906305 12.19710886]
 [18.78647959 13.88280889 12.50820082 10.88702066 10.03981345 16.47309494
  21.66943759 21.49772215 11.2422227  10.32834405]
 [19.58057547 13.77975518 11.97006643 10.8377021   9.98913521 14.63754249
  22.94540823 26.80207324 11.8951692   8.53430873]
 [19.95390821 16.19590235 13.79167211 12.81285775 11.47781599 17.96429062
  26.15225315 26.19105172 12.86227953 11.88900495]
 [18.2890923  14.46165431 12.36352921 11.79553938 11.04817873 16.82233322
  19.84111154 17.83007205 11.95753372 10.97588223]]
Test accuracies per communication round for each client:  [[0.55951493 0.60820896 0.62798507 0.64328358 0.65951493 0.4255597
  0.41473881 0.45485075 0.60578358 0.65839552]
 [0.52771309 0.60627232 0.64477566 0.66231952 0.68095016 0.51575842
  0.37307871 0.37245769 0.64819127 0.68421053]
 [0.58732373 0.62900976 0.68076863 0.69796994 0.72152487 0.56299396
  0.46459011 0.55323106 0.58608399 0.69502557]
 [0.55504587 0.6402704  0.65958474 0.67624336 0.70473201 0.47585707
  0.41260261 0.3440367  0.66537904 0.74191212]
 [0.46294466 0.52618577 0.56472332 0.61231884 0.62928195 0.50148221
  0.3527668  0.33959157 0.60902503 0.64426877]
 [0.40089253 0.42748234 0.49330606 0.54313871 0.56712533 0.3081071
  0.32354035 0.28653775 0.55448122 0.55076237]
 [0.53196742 0.5820785  0.59960504 0.62453715 0.63910146 0.33226364
  0.44507529 0.40064182 0.59442113 0.61737843]
 [0.52241919 0.62565172 0.65832464 0.67848453 0.69290928 0.4622871
  0.39016336 0.3163017  0.61122697 0.72610358]
 [0.42244993 0.46762925 0.51863065 0.56427573 0.58523521 0.31439218
  0.36585934 0.26525384 0.53959013 0.56427573]
 [0.56909361 0.62076936 0.62341093 0.63628859 0.65725607 0.36239062
  0.47581311 0.44708602 0.62225524 0.6359584 ]]


Train losses per communication round:  [1.706290462097004, 1.2838663563409514, 1.0630737333179865, 0.9471149141054738, 0.8712047849634486, 0.8218210458200209, 0.7820180086131815, 0.7515614302915661, 0.7265185890957553, 0.7077452953328917]
Test losses per communication round:  [18.03860640525818, 14.004117000102998, 12.435332134366035, 10.939726674556733, 10.004889124631882, 9.604792493581773, 9.098627477884293, 8.511928822100163, 8.372464880347252, 8.251172304153442]
Test weighted accuracies per communication round:  [0.5463220388422829, 0.5898484602774874, 0.6235856084484028, 0.657216719493469, 0.6757243651005788, 0.6902289086167542, 0.700326618382102, 0.7117912447541734, 0.7207076002400971, 0.7223018208557954]
Test losses per communication round for each client:  [[18.11654544 14.26052845 11.93204188  9.98266387  9.71975321  8.97451758
   8.25325137  7.28517404  7.39886606  6.93898314]
 [18.01478291 14.01669014 12.66865277 11.19772422  9.87989503  9.98218095
   9.41604197  8.39511377  8.25367731  8.58067733]
 [18.13419735 13.42695761 12.23856974 10.75142342  9.5072313   9.24077421
   8.97691423  8.14943907  8.52802008  7.65593949]
 [18.10444939 14.30663621 12.89416969 10.56173003  9.73941886  9.55086976
   8.80810672  8.49633327  8.75471085  8.45646781]
 [16.70086956 13.09741998 11.78138971 10.30672216  9.69350135  9.36647975
   8.91365701  8.59983951  8.27599132  8.21008307]
 [17.89706647 13.82382369 12.23802638 11.43729472 10.89642322 10.35345638
   9.18001896  9.48612905  8.87708771  8.63339823]
 [18.50957036 14.74715471 12.64336705 10.72984558  9.79332137  8.85043478
   8.63547641  8.29001841  7.79213762  8.55540884]
 [18.26753545 15.02696848 12.30741766 11.46842355 10.54402268 10.49996364
  10.33387852  9.35597688  9.44428414  9.18053347]
 [17.81985831 13.01591027 12.36517167 11.28887385  9.31000841  9.30718094
   8.67642266  7.57540937  7.21943453  7.73402745]
 [18.82118881 14.31908047 13.28451478 11.67256534 10.96531582  9.92206693
   9.79250693  9.48585486  9.18043917  8.56620422]]
Test accuracies per communication round for each client:  [[0.58573676 0.62637651 0.66321447 0.68628736 0.70673833 0.71997902
  0.72692711 0.74554274 0.74947562 0.75930781]
 [0.56955204 0.60357023 0.62714719 0.66823846 0.68743685 0.68912092
  0.69821489 0.72381273 0.72751768 0.72078141]
 [0.54623712 0.60062606 0.63584192 0.66597104 0.69296987 0.70823008
  0.71096909 0.71501239 0.72583801 0.73014217]
 [0.54395997 0.5729807  0.6115797  0.6586133  0.68062902 0.69549678
  0.7119371  0.71708363 0.73466762 0.72380272]
 [0.52586207 0.56231527 0.57931034 0.63251232 0.64630542 0.66256158
  0.68152709 0.68743842 0.69630542 0.69261084]
 [0.52263714 0.57452082 0.61087244 0.63648381 0.64755453 0.66639128
  0.67564442 0.68307997 0.69431593 0.69795109]
 [0.52910053 0.56935818 0.61352657 0.65355418 0.66689671 0.69059121
  0.70393375 0.71014493 0.7221072  0.72463768]
 [0.56052697 0.58985831 0.62043251 0.63559533 0.65299528 0.66343525
  0.66542381 0.68754661 0.68456376 0.68555804]
 [0.58122744 0.62473874 0.65874976 0.68763063 0.71271138 0.72221167
  0.73076192 0.74216226 0.75926278 0.75812274]
 [0.47539016 0.54381753 0.58183273 0.61984794 0.63745498 0.66166467
  0.67667067 0.67887155 0.68447379 0.69667867]]


Train losses per communication round:  [1.7372819070435668, 1.3674774474919464, 1.1291004869342538, 0.9902648559096422, 0.903048157517189, 0.8484580588048631, 0.8088351649717683, 0.7708462015574049, 0.7425546093081025, 0.7206420082330839]
Test losses per communication round:  [19.466763186454774, 15.654885530471802, 24.57021962404251, 12.766284304857255, 11.090534055233002, 16.695990651845932, 9.459077295660972, 9.302127104997634, 9.23496326804161, 8.68814213871956]
Test weighted accuracies per communication round:  [0.490646258713349, 0.537321669585696, 0.25310724392739875, 0.6052129363776204, 0.6444452700308546, 0.4534301200391169, 0.6905660512780345, 0.6950059549488715, 0.685877888434825, 0.7130620884766746]
Test losses per communication round for each client:  [[19.22731018 14.76808262 24.89526963 12.00900322 10.73783058 16.88280177
   9.40863842  9.49970585  8.56250167  8.40903795]
 [19.79093361 15.5216465  25.7534399  12.69600868 11.59029162 17.05757451
   9.73007876  9.517658    9.71134073  8.77093518]
 [19.8009069  16.42248201 29.64382172 14.46288049 12.51737344 14.72340071
  12.06609845 11.1764639  10.86029136 10.36769068]
 [18.61643791 14.82748151 25.09216666 12.55189276 10.60260737 15.28269506
   8.67991722  8.88080144  9.10036647  8.23268998]
 [20.36914456 17.38457406 23.17016768 13.51297748 12.54603076 16.91655242
  10.33347821  9.79250276  9.99544561  9.28340274]
 [19.15582204 15.14338648 24.35809112 13.36632001 10.69599372 16.04637551
   9.54470271  9.1156311   8.66356796  8.4655481 ]
 [18.97228682 14.91875827 20.69723499 11.75511861  9.6215921  17.6308198
   7.89704651  8.17795765  7.75984776  7.87936854]
 [19.93470716 15.99745202 24.47377586 12.53595603 11.10104644 18.50058627
   9.22240198  8.93234193  9.27056777  9.10031575]
 [19.99127936 16.19362867 24.58418655 12.82962894 11.36225981 19.12260473
   9.57996416  9.83753115  9.36615705  8.66765839]
 [18.80880332 15.37136316 23.03404212 11.94305682 10.13031471 14.79649574
   8.12844655  8.09067726  9.05954629  7.70477408]]
Test accuracies per communication round for each client:  [[0.48584371 0.58273562 0.28715238 0.66226249 0.67283252 0.42041022
  0.7064301  0.70995344 0.71712596 0.72606015]
 [0.42875189 0.48534613 0.23976756 0.58564932 0.62556847 0.45679636
  0.67129864 0.68393128 0.66725619 0.71045983]
 [0.47941681 0.47555746 0.17688679 0.47062607 0.5806175  0.54202401
  0.60012864 0.61942539 0.60741852 0.62607204]
 [0.58245904 0.59047507 0.18814099 0.63385595 0.65472121 0.51597312
  0.74289756 0.71943888 0.69586231 0.72981257]
 [0.40116101 0.43522762 0.35853957 0.54842652 0.59547815 0.42453407
  0.63978002 0.65643141 0.65566758 0.68469294]
 [0.49778121 0.56627436 0.29172294 0.63785452 0.67007525 0.4561065
  0.70519004 0.71773104 0.7275709  0.73181555]
 [0.56471936 0.6387457  0.33075601 0.65292096 0.69931271 0.38502291
  0.71291523 0.71406071 0.71420389 0.73052692]
 [0.45902335 0.51762208 0.20467091 0.60679406 0.63949045 0.37239915
  0.69002123 0.69171975 0.68067941 0.71125265]
 [0.41276307 0.49287169 0.26544467 0.58814211 0.61642906 0.35980991
  0.64630007 0.66123557 0.64924191 0.69336954]
 [0.53537395 0.56367312 0.27721629 0.6407739  0.6731158  0.51602657
  0.73346809 0.73577823 0.71671961 0.75397055]]


Train losses per communication round:  [1.7603402636337016, 1.3631986992217502, 1.1230348600841675, 0.9949746277479035, 0.9185132627511516, 0.8680343085080159, 0.8297043119040115, 0.7989122692343755, 0.7702323061530948, 0.7489045729203646]
Test losses per communication round:  [19.290016293525696, 14.922801917791366, 12.6058025598526, 11.364777481555938, 10.681815850734711, 10.315084397792816, 9.795953108370304, 9.529548695683479, 9.160339692234993, 8.892081739008427]
Test weighted accuracies per communication round:  [0.4904303872262534, 0.5747839543395524, 0.610573392137718, 0.6397638101225619, 0.6605664106661363, 0.6663483352535169, 0.6827305106936421, 0.6947217847502959, 0.7043000728124881, 0.7054575766478651]
Test losses per communication round for each client:  [[20.06998348 16.17447376 13.5971396  12.45437878 11.57716686 11.19629163
  11.12909657 11.09307307 10.26838875  9.83413339]
 [18.33071411 13.22076076 11.93746096 10.38952994  9.56229305  8.9959951
   8.22409357  8.70211166  7.69339961  7.34087928]
 [19.26130998 15.01551771 12.78928256 10.99940372 10.83106482 10.46042216
   9.52461684  9.12398589  9.08880419  8.81363684]
 [19.37396097 14.99763167 12.70034444 11.59412903 11.22544038 10.83003616
  10.25238383  9.96341652  9.78481042  9.55832064]
 [18.61758721 13.19062889 10.84156746  9.94686097  9.20413345  8.63877702
   8.95121002  8.28515369  7.86706984  7.55829144]
 [18.64715827 14.44435823 12.56297469 11.42800963 10.62110955 10.01442248
   9.25978589  8.98526436  9.46783018  8.58904821]
 [18.98327398 14.74165761 12.3576768  10.71932125 10.22014481 10.28223735
   9.62240285  9.7124567   9.3442322   9.49734449]
 [19.82023096 16.66466868 13.78503209 13.10508609 12.1124801  12.33455718
  11.48579311 10.96265268 10.6097706  10.26515287]
 [20.04018927 15.34414124 13.17971003 11.83861589 11.02498364 10.31923515
  10.22128326  9.95560163  9.37329537  8.88643295]
 [19.75575471 15.43418062 12.30683696 11.17243952 10.43934184 10.07886976
   9.28886515  8.51177076  8.10579577  8.57757729]]
Test accuracies per communication round for each client:  [[0.38648204 0.49177406 0.54537976 0.57992871 0.60419523 0.61516315
  0.62613107 0.6487524  0.66081711 0.6621881 ]
 [0.56081081 0.64379764 0.68173943 0.69057519 0.7047817  0.72331947
  0.73111573 0.73700624 0.748614   0.75571726]
 [0.50575043 0.58654399 0.62880966 0.66216216 0.6986774  0.68430132
  0.70442783 0.70241518 0.71880391 0.71276596]
 [0.47585169 0.53769325 0.57846491 0.60227117 0.60418662 0.62922424
  0.64304282 0.65207279 0.65877685 0.66684909]
 [0.57659647 0.66576087 0.67730978 0.6985394  0.71637228 0.71433424
  0.73046875 0.72724185 0.73046875 0.7376019 ]
 [0.53315116 0.59830289 0.63296419 0.65928376 0.67481663 0.66719402
  0.69538329 0.70890263 0.71781965 0.71508701]
 [0.50576015 0.59395656 0.61567517 0.64948064 0.66931067 0.67214353
  0.68876298 0.70236072 0.7068933  0.71369216]
 [0.45448228 0.50845495 0.52559648 0.55455177 0.57400973 0.58790827
  0.6066713  0.62358119 0.63354181 0.63006718]
 [0.45007641 0.55832909 0.59373408 0.63270504 0.65180846 0.66403464
  0.67091187 0.68644931 0.69842078 0.69612837]
 [0.47093178 0.55508362 0.60021237 0.63897    0.66657818 0.66817096
  0.69843377 0.72577648 0.72949297 0.72896204]]


# federated baseline non-IID 0.1 with no pre-training
Train losses per communication round:  [1.3719052591624528, 1.1492128530925698, 1.002663642728688, 0.8977288143838719, 0.8173702419947355, 0.7515859850731806, 0.7032343324589465, 0.6618301315595057, 0.6336834475129967, 0.603695198502036]
Test losses per communication round:  [21.75972514152527, 19.42807606458664, 17.47610160112381, 15.911593931913377, 14.562835943698882, 13.88530324101448, 13.390908694267273, 12.582035559415818, 12.421208882331848, 12.121629726886749]
Test weighted accuracies per communication round:  [0.3551336835465105, 0.46677407374624763, 0.5454981699845922, 0.5634106931964051, 0.5699494783170659, 0.5670542964679919, 0.5729831110081002, 0.6104430560947113, 0.606797663868357, 0.6165142628249665]
Test losses per communication round for each client:  [[20.57542515 17.91684937 15.57182145 13.83631825 11.71926558 10.98793936
  10.44831902  9.75690395  9.71066421  9.38236606]
 [21.54987848 19.49670076 18.08170629 16.7868793  16.30125415 15.37485254
  15.22089684 14.93577373 15.09341812 13.95869374]
 [22.95689654 20.79813778 17.6279186  15.43802595 13.79473543 13.66641235
  12.386904   11.58914185 11.11291426 10.80059582]
 [22.33407354 19.80146086 17.66271555 15.58790994 14.08153629 12.80163103
  12.51545048 12.29663849 11.02824128 11.32820946]
 [21.15782619 18.45388615 16.35282588 15.29409873 13.84239137 11.99641967
  12.07640731 11.06782675 10.71755433 10.62272   ]
 [23.02975035 20.7279042  18.13564944 14.99604523 13.09281731 12.04521859
  11.97519398 11.01660842  9.78095812 10.12737674]
 [22.52779055 20.56783772 19.23172414 17.64791751 14.69959092 14.30024362
  13.12445605 12.06030357 11.40436441 11.04264933]
 [20.53860223 18.43830943 16.83130217 15.71343082 15.93171072 16.15078866
  15.70693946 14.71119571 15.50061035 15.39237928]
 [21.82070422 19.74714375 18.34168684 17.07318962 16.83562732 16.09310019
  16.48104286 14.65680665 15.62392819 15.02876139]
 [21.10630417 18.33253062 16.92366564 16.74212396 15.32943034 15.4364264
  13.97347695 13.72915649 14.23943555 13.53254545]]
Test accuracies per communication round for each client:  [[0.33450704 0.48591549 0.63380282 0.67018779 0.67018779 0.68075117
  0.67253521 0.74178404 0.75352113 0.75117371]
 [0.46073009 0.43971239 0.4477323  0.4994469  0.49115044 0.5102323
  0.51272124 0.5199115  0.50774336 0.53207965]
 [0.20949166 0.44817315 0.62053217 0.65885624 0.70770453 0.6731533
  0.700556   0.70393169 0.70333598 0.71227164]
 [0.2894704  0.4317757  0.55003115 0.65271028 0.70018692 0.70691589
  0.7046729  0.72922118 0.75364486 0.74629283]
 [0.34040843 0.57485126 0.68837434 0.72133784 0.74722624 0.76443158
  0.74593986 0.77022029 0.77970735 0.77086348]
 [0.26095361 0.50837629 0.68137887 0.74806701 0.7867268  0.77448454
  0.78382732 0.78865979 0.78962629 0.79220361]
 [0.37023004 0.43220568 0.49878214 0.53775372 0.67929635 0.67686062
  0.6985115  0.72286874 0.74695535 0.75751015]
 [0.50189544 0.48175644 0.43855631 0.36566103 0.29861001 0.30713947
  0.31472121 0.36605592 0.34465329 0.36613489]
 [0.22233057 0.28778645 0.38261824 0.40285227 0.43149683 0.3860312
  0.4052901  0.45453437 0.42369576 0.46245734]
 [0.3613575  0.45314308 0.48630929 0.4346317  0.4662553  0.40725029
  0.45507135 0.51831855 0.47936753 0.50983417]]


Train losses per communication round:  [1.3437555178545166, 1.1472510844995933, 1.0057766189633441, 0.9040387721096534, 0.8382435139823187, 0.7878677500262596, 0.7411087981212562, 0.7119640719425053, 0.6874309397865064, 0.6559856716160374]
Test losses per communication round:  [22.355404686927795, 19.791152608394622, 18.085197067260744, 16.913094830513, 16.32037694454193, 15.815537309646606, 15.472888344526291, 14.424041157960891, 14.09926193356514, 14.346799063682557]
Test weighted accuracies per communication round:  [0.41710953268041845, 0.4845226151175956, 0.5023792516947502, 0.5055167612230659, 0.5015446605912868, 0.5124548915548127, 0.5209017588714001, 0.5347649663551435, 0.54477459224551, 0.5492032359707993]
Test losses per communication round for each client:  [[20.78875804 17.93251503 16.46368289 15.15501952 14.49551117 13.85239148
  13.19384515 12.33489388 11.73469961 11.88370895]
 [23.77847457 21.17637098 19.30747557 19.28565359 19.70482934 17.75612581
  18.72076893 14.80093294 15.0173052  16.06445205]
 [22.86931849 19.85656559 17.75853705 16.4901135  15.44280314 15.7369833
  15.43768907 14.62480068 14.24957669 14.37692356]
 [21.97013962 18.8257972  17.36111593 16.45453107 15.76421189 15.01376343
  14.49041808 13.03288782 12.23644018 13.33430994]
 [21.90922594 19.09920621 18.18154228 17.41363454 16.41430807 16.70750165
  16.0866003  15.3296634  14.33914292 15.95080888]
 [22.65151334 18.46993232 14.88688159 12.8283757  11.94895971 11.55494285
  10.67504984 10.70151192 10.8613342  10.7481885 ]
 [25.08430982 24.59053564 23.88850737 23.07019794 23.46101332 23.35719562
  23.39798141 22.41078794 22.79148662 23.30841351]
 [22.44963622 20.2714349  18.38928473 16.93419409 16.04503429 15.57947254
  14.74812174 14.28979671 14.45362949 13.97512257]
 [23.59953618 22.59453464 21.64441752 19.73565054 19.02427769 18.33397472
  17.82181466 16.82673407 15.67984998 14.72538626]
 [18.45313466 15.09463358 12.97052574 11.76357782 10.90282083 10.26302171
  10.15659428  9.88840222  9.62915444  9.10067642]]
Test accuracies per communication round for each client:  [[0.62569832 0.67318436 0.62849162 0.62290503 0.58379888 0.60335196
  0.58659218 0.60614525 0.61452514 0.65921788]
 [0.15521777 0.20432622 0.19438761 0.17451038 0.17129494 0.24408068
  0.29874306 0.43700672 0.41099094 0.37328267]
 [0.13835377 0.30122592 0.43432574 0.48511384 0.50087566 0.49912434
  0.51313485 0.45534151 0.47635727 0.52364273]
 [0.40037028 0.52881277 0.53945846 0.50289285 0.50682712 0.54987271
  0.58852118 0.66628095 0.66142097 0.61675538]
 [0.51990017 0.46814659 0.43688428 0.42677    0.43123604 0.42571916
  0.45067647 0.50558256 0.52870091 0.43609615]
 [0.34420535 0.53613818 0.63408279 0.6575316  0.67374312 0.67181318
  0.6813664  0.65724211 0.6644794  0.68908617]
 [0.03084201 0.03803217 0.04219489 0.0410596  0.03500473 0.03651845
  0.0359508  0.04427625 0.04219489 0.0397351 ]
 [0.05638355 0.06212965 0.07505836 0.08906446 0.1138445  0.1429341
  0.27940384 0.29610343 0.36721135 0.37134135]
 [0.16504564 0.22923837 0.29687266 0.36121502 0.41942242 0.47329044
  0.52012569 0.53553793 0.55289541 0.59434386]
 [0.69317719 0.76751527 0.78370672 0.7802444  0.76649695 0.77668024
  0.73849287 0.74837067 0.7389002  0.76425662]]


Train losses per communication round:  [1.4821235554895296, 1.2672391843400759, 1.1389419849092126, 1.04785248986701, 0.9770203451098908, 0.9208730552892511, 0.8863643863326617, 0.8527491449298699, 0.8243341640592892, 0.8041877667246993]
Test losses per communication round:  [22.556966018676757, 21.59319338798523, 16.529613518714903, 15.599217700958253, 14.404028809070587, 14.256113588809967, 22.696902751922607, 12.751300950348377, 13.759056347608567, 12.535171481966973]
Test weighted accuracies per communication round:  [0.25444435816288974, 0.2484550988556988, 0.46999473841228684, 0.42858338895872156, 0.4900728996513306, 0.499135145805476, 0.24343253296467868, 0.547855613604976, 0.4836161238304322, 0.5466349702477928]
Test losses per communication round for each client:  [[22.32934546 21.49702156 19.10754645 17.80127573 15.98470646 15.91724372
  25.45817518 16.02844501 17.63275909 14.5786463 ]
 [23.43623555 24.47853208 21.86267757 21.74630249 20.91247129 19.34258986
  28.5327189  19.25622571 22.66249323 19.5089395 ]
 [23.08246255 23.52958655 17.26972795 16.6774739  16.35513544 16.96482778
  26.52392411 15.37648809 15.37295461 14.42110121]
 [20.96281886 17.74239016 13.83908856 13.04106838 11.85916579 12.36044806
  16.37639737 10.95253032 13.5743221  12.88740873]
 [22.74560022 28.77010083 17.87838244 20.63347268 16.34326011 17.09956074
  20.74834681 11.19235659 11.98655057 11.20472735]
 [20.78518033 22.45039296 15.44908607 12.88162327 12.19541872 10.2402575
  20.95357442  9.06155024  8.01305914  8.72870058]
 [23.9823873  18.53073394 16.43226266 15.45715582 14.82946861 14.42270851
  20.96287274 13.29832113 15.76595986 12.87579846]
 [25.20877171 23.54870319 16.91134274 13.98660582 15.92652249 15.469944
  36.18745828 15.27894068 10.8697747  14.65423918]
 [20.72344625 18.23482227 14.41360176 13.9119457  11.03539503 11.81814301
  17.42467797  9.96924192 12.26712728  8.84842187]
 [22.31341195 17.14965034 12.13241899  9.85525322  8.59874415  8.92541271
  13.80088174  7.09890983  9.4455629   7.64373162]]
Test accuracies per communication round for each client:  [[0.21712223 0.18050542 0.24755028 0.26147499 0.31614234 0.4280557
  0.16915936 0.38937597 0.29551315 0.36771532]
 [0.09715055 0.07606013 0.06484182 0.05429661 0.12407449 0.27305362
  0.09333632 0.2380525  0.05698901 0.15974871]
 [0.08472222 0.13333333 0.27638889 0.22916667 0.29722222 0.24027778
  0.17361111 0.31527778 0.25138889 0.39583333]
 [0.35987998 0.35173596 0.62108873 0.54684955 0.57205315 0.49215602
  0.41877411 0.62828976 0.49755679 0.50175739]
 [0.51785714 0.16071429 0.67857143 0.44642857 0.64285714 0.58928571
  0.26785714 0.76785714 0.69642857 0.78571429]
 [0.5064241  0.19749858 0.5762365  0.73610006 0.73064241 0.77396248
  0.5298465  0.74678795 0.81819215 0.77987493]
 [0.1913034  0.3483011  0.41560144 0.38479187 0.47896864 0.43843549
  0.33562766 0.51141702 0.38741396 0.53796569]
 [0.09045584 0.21438746 0.52136752 0.67378917 0.5534188  0.58618234
  0.08547009 0.55982906 0.73148148 0.57905983]
 [0.48765084 0.43205143 0.71331905 0.63685576 0.75290403 0.70215405
  0.31995038 0.78121123 0.66899741 0.79339123]
 [0.32733295 0.6343606  0.79464286 0.80544355 0.80861175 0.7860023
  0.53427419 0.80717166 0.72321429 0.7734735 ]]


Train losses per communication round:  [1.3481691435475942, 1.0927752360719758, 0.9369148706131268, 0.8256001695921149, 0.7452043479767927, 0.693168813903648, 0.6402427382822946, 0.6006942579779062, 0.5662045271485434, 0.5492948814209704]
Test losses per communication round:  [22.234615540504457, 20.251950633525848, 19.360939276218414, 17.977505803108215, 17.151499390602112, 16.763763195276262, 16.364673972129822, 16.03123069405556, 15.599109917879105, 15.971848690509796]
Test weighted accuracies per communication round:  [0.34032923287047573, 0.4052926265644545, 0.42416205098593973, 0.46194391883759134, 0.4801986456171468, 0.49101975926012015, 0.47639923500632686, 0.4939241502345022, 0.5109354557645414, 0.511750768237733]
Test losses per communication round for each client:  [[22.13181257 21.36747932 21.781322   20.1682235  19.97893929 18.57228541
  18.3305819  18.3316201  17.47374415 18.35973966]
 [22.98653269 23.17489552 24.97279406 22.48242986 21.98023796 20.28701377
  19.333722   20.30360901 19.31405663 22.2469666 ]
 [26.11612582 25.81968737 26.05462885 26.2038312  25.30085421 26.40709209
  27.12023056 28.34030032 27.81619167 28.92569017]
 [20.37217414 18.2061671  16.84587491 15.36712098 13.65315127 13.19102991
  11.84482062 11.98227084 10.77983093 11.69474286]
 [24.76612067 23.45881343 22.15292168 22.89288449 22.47556722 23.34094238
  23.34646332 23.1889832  22.19739473 22.39064443]
 [22.59525681 19.94737577 18.09347558 16.29693329 16.1534946  16.27595854
  15.40126652 14.56384897 14.7857002  12.91902155]
 [21.95068538 19.3282795  17.00734198 15.68235314 14.41224349 13.6934129
  13.48570275 11.25640839 10.39945346 10.98259974]
 [19.60462916 16.10050154 12.87715495 11.79085732 10.33512247 10.31212157
   9.4634304   8.29492158  8.79935503  8.50470328]
 [20.80242407 17.45874536 16.25155985 14.637676   14.24201179 12.93989646
  14.11853206 12.16829622 13.23661566 10.60627246]
 [21.02039409 17.65756142 17.57231891 14.25274825 12.98337162 12.61787891
  11.20198959 11.88204831 11.1887567  13.08810616]]
Test accuracies per communication round for each client:  [[0.20168827 0.22158577 0.21706361 0.22701236 0.231836   0.24208622
  0.22610793 0.23213747 0.24600543 0.2556527 ]
 [0.02499107 0.03320243 0.03534452 0.03427347 0.03284541 0.03427347
  0.05997858 0.03927169 0.04462692 0.03570154]
 [0.05656297 0.07103643 0.07253369 0.08151722 0.08717352 0.08733988
  0.0876726  0.09000166 0.09366162 0.08800532]
 [0.60221431 0.57671016 0.54982206 0.61862396 0.66864373 0.70245156
  0.64827995 0.67912218 0.7334915  0.69553183]
 [0.132714   0.19442601 0.24220305 0.2189781  0.23291307 0.22959522
  0.21964167 0.25016589 0.24353019 0.27538155]
 [0.24661112 0.3275712  0.39037433 0.38278821 0.39833354 0.397463
  0.38788708 0.41288397 0.42370352 0.47916926]
 [0.35420609 0.46757268 0.53844831 0.63667641 0.67297437 0.70204714
  0.69172544 0.72286255 0.74935489 0.73198004]
 [0.68327533 0.76451731 0.77935519 0.78411797 0.78072907 0.77486719
  0.78182817 0.79309397 0.78723209 0.79666606]
 [0.50075169 0.58857429 0.63117013 0.65597595 0.68128289 0.6874217
  0.63517915 0.69180656 0.70320722 0.73352543]
 [0.48570309 0.59890325 0.50724638 0.66431649 0.68860165 0.71484528
  0.72542107 0.68507638 0.73521347 0.63533098]]


Train losses per communication round:  [1.4013424245758825, 1.1226888881839403, 0.9593290103983992, 0.8767672492683166, 0.821903705334065, 0.7726146566540446, 0.7390145429664436, 0.7123449979493964, 0.6934024914752462, 0.6657202689612213]
Test losses per communication round:  [22.64878828525543, 17.652236437797548, 15.963442462682725, 15.12398121356964, 14.149878704547882, 13.6026237860322, 12.682078262418509, 12.421967732533812, 12.19442813694477, 12.144130308181047]
Test weighted accuracies per communication round:  [0.22351118620287327, 0.4627409159170076, 0.5282367473533556, 0.561828879462127, 0.5704263546641892, 0.6016543753004601, 0.607600738016419, 0.6140789607745046, 0.6170682471306335, 0.6230125355945301]
Test losses per communication round for each client:  [[24.22963476 17.45760095 14.90693772 13.70985138 12.67937112 11.40273368
  10.78043985 10.88816482  9.72667164  7.66348565]
 [22.57874227 14.49873245 11.8785907  10.45946753  9.15464985  8.06537992
   7.85605937  7.71712446  6.64342186  6.08670872]
 [22.83706856 14.45372081 11.35330576 11.14302337 10.21120489  8.6048841
   8.07207856  7.85615516  7.79663068  8.09443951]
 [23.49511194 22.25424314 21.90875256 21.5207746  21.21236813 20.3236407
  19.46955013 19.31918335 20.27195036 19.51262379]
 [25.98373604 23.28260744 22.4813621  22.46736562 21.56700027 21.47653663
  20.1311425  20.01982009 20.38909221 21.40517235]
 [21.10765839 18.49119866 16.54932058 15.8495177  14.8155216  15.28310871
  14.06738961 14.37349784 13.78822374 14.64088905]
 [22.50514722 16.80082476 15.8211683  15.448686   14.41168904 14.527722
  14.0139792  13.28122509 12.01336563 13.26235539]
 [21.95255113 18.01548862 17.14714956 15.7450031  15.15985775 14.77256811
  13.70947623 13.01416433 13.27286685 13.6549958 ]
 [20.3545258  16.60178924 14.34123492 12.52067971 11.4019866  10.46168399
   9.72317928  9.13762736  9.0519436   8.52724564]
 [21.44370675 14.66615832 13.24660242 12.3754431  10.8851378  11.10798001
   8.9974879   8.61271482  8.99011481  8.59338719]]
Test accuracies per communication round for each client:  [[0.05126282 0.47386847 0.62340585 0.64116029 0.61915479 0.75868967
  0.71692923 0.69292323 0.73218305 0.81345336]
 [0.27589666 0.68472536 0.77075495 0.7880612  0.78906446 0.85226988
  0.83421119 0.82267369 0.8427389  0.87735139]
 [0.29664179 0.68003731 0.70988806 0.73041045 0.73414179 0.73414179
  0.74906716 0.76492537 0.74906716 0.72201493]
 [0.16329588 0.16794007 0.19805243 0.21438202 0.22561798 0.23715356
  0.25632959 0.26831461 0.27640449 0.26786517]
 [0.02273978 0.1059967  0.10893086 0.11021456 0.11828351 0.13313772
  0.14065652 0.14285714 0.15697781 0.15257656]
 [0.43640405 0.56236108 0.56680662 0.54334404 0.55421092 0.53716967
  0.56137318 0.55470487 0.55618671 0.54457891]
 [0.2        0.76       0.712      0.624      0.72       0.336
  0.544      0.592      0.512      0.248     ]
 [0.30307634 0.42157235 0.45442461 0.47113559 0.459267   0.51281808
  0.53152298 0.56589442 0.50883023 0.54576529]
 [0.30186698 0.41061844 0.5445741  0.6747958  0.71551925 0.77071179
  0.78389732 0.79906651 0.80105018 0.8117853 ]
 [0.39849072 0.78534745 0.76899696 0.76333718 0.77560004 0.63787863
  0.69384761 0.72937847 0.6986689  0.591133  ]]


# federated baseline non-IID 0.01 with no pre-training
Train losses per communication round:  [1.112020311901698, 0.8760208901058746, 0.727161849469, 0.629160153927417, 0.5660691434185781, 0.5111090721191038, 0.4766512675026059, 0.452822447458062, 0.4253800604360275, 0.4048153029277072]
Test losses per communication round:  [23.618173718452454, 23.265631246566773, 22.75820323228836, 22.54754321575165, 22.559545695781708, 22.33121417760849, 22.357184958457946, 22.33526176214218, 22.45019782781601, 22.761333203315736]
Test weighted accuracies per communication round:  [0.18586279388113114, 0.256286724934267, 0.2638225131834414, 0.27057167430812273, 0.2725618267557869, 0.2715008281561824, 0.27904205756416195, 0.29098280660059506, 0.29535034436436636, 0.29166426977086524]
Test losses per communication round for each client:  [[25.77083278 25.65038753 25.53548789 25.24339747 25.60354614 25.8252914
  26.12173629 25.6612525  25.72539806 26.59337497]
 [21.90080309 23.1735456  22.54406428 22.01028991 21.87887287 21.97345161
  22.33097458 22.51616168 22.54937148 22.9173553 ]
 [23.35449171 20.99306262 20.642349   20.3303858  20.5787636  21.07257557
  20.72342634 19.16628206 19.38461125 19.28027654]
 [24.87622571 23.60150528 23.66181612 23.38415432 23.61674881 23.62022829
  23.93287611 23.81639671 24.1040144  24.66134953]
 [23.83391833 26.75004888 26.41359377 26.22366452 26.31772733 25.58375382
  25.58933592 26.87455058 27.02202582 27.24439478]
 [23.88507009 23.71888351 22.8839947  23.56978679 23.76088405 23.16586673
  23.07165635 23.76285148 24.34665346 24.53215241]
 [27.0234077  26.8146894  27.19941902 27.59524727 27.78507566 28.06061745
  28.50048661 28.47610688 28.64548397 30.06178212]
 [21.51098084 17.63711154 16.37980807 16.06319284 15.47263539 14.24964797
  13.80353749 13.32896638 12.66596937 12.86092257]
 [23.70639205 26.836344   26.45057583 26.18261671 26.384516   25.7926991
  25.63151312 26.7703917  27.04837322 26.97371101]
 [20.31961489 17.48073411 15.87092364 14.87269652 14.1966871  13.96800983
  13.86630678 12.97965765 13.01007724 12.48801279]]
Test accuracies per communication round for each client:  [[9.24043615e-04 3.69617446e-04 3.69617446e-04 1.84808723e-04
  1.84808723e-04 3.69617446e-04 1.84808723e-04 0.00000000e+00
  1.84808723e-04 0.00000000e+00]
 [1.30185185e-01 9.25925926e-04 2.03703704e-03 2.40740741e-03
  3.14814815e-03 2.96296296e-03 1.85185185e-03 2.77777778e-03
  3.88888889e-03 4.07407407e-03]
 [2.94736842e-01 3.57894737e-01 4.10526316e-01 4.73684211e-01
  4.42105263e-01 4.42105263e-01 4.84210526e-01 5.36842105e-01
  5.89473684e-01 5.57894737e-01]
 [1.85185185e-04 3.70370370e-04 1.85185185e-04 1.85185185e-04
  1.85185185e-04 3.70370370e-04 3.70370370e-04 5.55555556e-04
  3.70370370e-04 1.85185185e-04]
 [1.01102941e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [1.52416996e-01 6.82952004e-02 7.07035954e-02 6.74350593e-02
  6.86392568e-02 6.70910029e-02 6.74350593e-02 6.70910029e-02
  6.74350593e-02 6.98434543e-02]
 [3.69822485e-04 5.54733728e-04 3.69822485e-04 5.54733728e-04
  3.69822485e-04 5.54733728e-04 7.39644970e-04 7.39644970e-04
  7.39644970e-04 5.54733728e-04]
 [5.74830878e-01 7.94458345e-01 7.91492911e-01 7.82225929e-01
  8.07061440e-01 8.04837364e-01 8.26058753e-01 8.29765545e-01
  8.29024187e-01 8.22815309e-01]
 [1.38953219e-02 1.15794349e-03 1.15794349e-03 1.15794349e-03
  1.15794349e-03 1.15794349e-03 1.15794349e-03 9.26354794e-04
  9.26354794e-04 1.15794349e-03]
 [2.03501946e-01 6.35214008e-01 6.60700389e-01 6.85019455e-01
  6.87743191e-01 6.82198444e-01 6.76070039e-01 7.35408560e-01
  7.26070039e-01 7.31128405e-01]]


Train losses per communication round:  [1.3465487861022774, 1.1623376823446305, 1.014284264844902, 0.8977244581619468, 0.8142495576720549, 0.7444847513182837, 0.6910483432695094, 0.6439101327814208, 0.6191964518565338, 0.5949253096619525]
Test losses per communication round:  [24.790012729167938, 22.934811222553254, 22.445385015010835, 21.956371796131133, 21.240790164470674, 20.893115293979644, 19.979022747278215, 19.49717801809311, 18.930071431398392, 18.777744203805923]
Test weighted accuracies per communication round:  [0.11972583152587529, 0.2358048213457258, 0.2525201197085987, 0.2581158839224204, 0.26616349793507993, 0.2953411047207138, 0.35733463366855217, 0.3368299138218468, 0.45879751403316804, 0.3767468174689595]
Test losses per communication round for each client:  [[26.29669809 26.3352437  26.81419754 26.5336163  26.01521754 25.69459438
  24.00126886 22.75284004 22.53645492 22.00046635]
 [28.07722378 26.31345224 26.13781786 26.13225627 25.41914296 25.25347948
  25.41758811 25.20437551 26.41549754 23.86328721]
 [24.40060425 19.40384662 17.83047044 17.07036734 15.88921309 15.7989819
  14.06932598 14.01965225 12.63219708 13.12079579]
 [28.59721994 25.76703691 24.64714551 23.92839301 22.14875102 21.25659144
  20.85873044 20.22686017 20.56526506 19.34499395]
 [27.35854959 26.3779161  26.41014171 24.96098614 23.94756699 23.02003455
  22.12527418 22.00366592 19.67814112 20.58700037]
 [21.67093921 18.92563033 18.30251741 18.5462023  18.41952217 18.8544904
  17.87199485 16.90820539 17.04567897 17.26037502]
 [24.81797743 23.95470762 23.96943617 22.8450489  21.91961002 20.75807023
  20.26566768 20.00289071 17.71236336 18.75468051]
 [20.46605837 15.40675664 13.21621275 13.71336567 12.87746048 13.04831266
  13.01618338 13.62473321 13.22875547 13.75724101]
 [29.0843544  29.12576056 29.73558354 29.54707313 28.96732807 28.43915701
  26.69045973 25.23230815 25.34544444 24.238621  ]
 [17.13050222 17.7377615  17.39032722 16.2864089  16.80408931 16.80744088
  15.47373426 14.99624884 14.14091635 14.84998083]]
Test accuracies per communication round for each client:  [[0.00000000e+00 0.00000000e+00 0.00000000e+00 1.34228188e-03
  8.05369128e-03 1.34228188e-02 1.20805369e-02 8.72483221e-03
  9.39597315e-03 1.47651007e-02]
 [1.36962849e-02 1.59219312e-02 1.52371169e-02 2.19140558e-02
  3.40695086e-02 7.65279918e-02 3.69799692e-02 3.30422873e-02
  3.80071905e-02 7.92672488e-02]
 [6.00000000e-02 3.20000000e-01 3.80000000e-01 3.80000000e-01
  3.80000000e-01 3.40000000e-01 5.00000000e-01 4.40000000e-01
  6.40000000e-01 5.00000000e-01]
 [0.00000000e+00 2.05676676e-03 1.99506376e-02 1.07774578e-01
  2.37350884e-01 3.42863019e-01 2.91032497e-01 2.57095845e-01
  2.75401070e-01 3.72686137e-01]
 [0.00000000e+00 0.00000000e+00 7.54716981e-04 4.77987421e-03
  2.51572327e-02 1.06163522e-01 2.09559748e-01 2.10062893e-01
  4.31949686e-01 2.99119497e-01]
 [1.25000000e-02 3.90370370e-01 4.33518519e-01 4.09907407e-01
  3.94629630e-01 3.83981481e-01 4.00185185e-01 3.86203704e-01
  3.93703704e-01 3.61944444e-01]
 [0.00000000e+00 6.53594771e-04 0.00000000e+00 3.92156863e-03
  1.37254902e-02 9.47712418e-02 1.94117647e-01 2.04575163e-01
  4.52287582e-01 2.99346405e-01]
 [4.70517842e-01 7.35966057e-01 7.75565709e-01 7.71105309e-01
  7.52447781e-01 7.21388164e-01 7.41623151e-01 6.64273281e-01
  6.49695387e-01 6.15208877e-01]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  2.52143217e-04 2.52143217e-04 0.00000000e+00 2.52143217e-04
  2.52143217e-04 5.04286435e-04]
 [6.38647343e-01 6.53462158e-01 5.55233494e-01 5.67149758e-01
  5.09822866e-01 4.43156200e-01 5.41706924e-01 6.03864734e-01
  6.20611916e-01 4.87278583e-01]]


Train losses per communication round:  [1.161790069328521, 0.9235684508457858, 0.7032012213949336, 0.5637992233324353, 0.47435953503780964, 0.408862662194745, 0.3653778956433101, 0.33145044630898646, 0.3113177477510122, 0.28978011467311526]
Test losses per communication round:  [23.980002105236053, 22.934642255306244, 22.26037278175354, 21.788931334018706, 21.36279398202896, 20.98833441734314, 20.824487245082857, 20.51912671327591, 20.434229958057404, 20.305298960208894]
Test weighted accuracies per communication round:  [0.18079195875695406, 0.2414587685669978, 0.24232525965156568, 0.23657761288149548, 0.2544975450697508, 0.25136478931266426, 0.28511604437905064, 0.2679765070139721, 0.27319191908115736, 0.27081708202412663]
Test losses per communication round for each client:  [[25.18224764 24.43622208 23.22649503 21.97575474 21.25708711 21.14878201
  20.97445118 21.49773812 20.77020848 20.52480733]
 [24.03665686 23.28024387 23.20786524 22.30426311 21.45817447 20.64402473
  20.57283533 18.60174334 18.62617242 17.57762384]
 [23.96277404 22.38591647 20.60146594 19.81619132 19.08793867 18.25374234
  17.9702754  18.19765878 19.31105864 18.77895808]
 [25.20725298 22.76143169 20.6696701  19.19730461 17.72939551 17.22826922
  17.85150719 16.24697721 16.09278071 17.50466609]
 [22.16388702 21.73737478 21.29724073 21.44516635 21.84078741 21.98069787
  22.77942967 21.95848918 21.41448426 22.61663508]
 [24.19570208 24.54838061 24.62305808 24.53082991 24.33947086 24.28243494
  23.58284974 24.16111541 23.43360233 23.51607919]
 [24.12676668 23.82752562 23.88380146 24.01529884 24.59691119 24.11082315
  24.11182165 23.0469234  23.78326917 22.68361306]
 [22.1127857  20.17674315 19.26567578 18.95298302 18.89560103 17.66595161
  17.38390696 17.74170649 16.32141387 15.56112182]
 [24.53986096 22.5000453  21.83969498 21.57193828 20.91389632 20.85491562
  20.07043266 20.20795751 19.89953256 20.43512452]
 [24.2720871  23.69253898 23.98876047 24.07958317 23.50867724 23.71370268
  22.94736266 23.5309577  24.68977714 23.85436058]]
Test accuracies per communication round for each client:  [[3.17251736e-02 2.08372442e-02 1.35160503e-02 7.71541205e-02
  1.77210437e-01 1.78899944e-01 1.80401727e-01 1.59001314e-01
  1.34597334e-01 1.74770039e-01]
 [2.98572047e-01 3.81436608e-01 2.48160969e-01 2.58978797e-01
  3.32107313e-01 3.69104284e-01 4.02206837e-01 5.05408914e-01
  5.22068369e-01 6.47987884e-01]
 [3.16320808e-01 4.78519349e-01 5.50084128e-01 5.33595064e-01
  5.29220415e-01 5.25630959e-01 5.68480090e-01 5.10375771e-01
  3.61749860e-01 5.01962984e-01]
 [2.28571429e-01 5.04043127e-01 5.97843666e-01 6.48517520e-01
  6.64690027e-01 6.82479784e-01 6.09703504e-01 7.20215633e-01
  7.31536388e-01 6.71159030e-01]
 [4.25925926e-03 1.48148148e-02 6.94444444e-02 3.37037037e-02
  3.48148148e-02 4.14814815e-02 1.05555556e-02 7.07407407e-02
  9.90740741e-02 3.14814815e-03]
 [2.67281852e-01 6.50801360e-02 3.23781771e-02 3.56159948e-02
  4.29010847e-02 4.74340295e-02 5.64999191e-02 6.21661000e-02
  2.84927959e-01 1.29674599e-01]
 [2.59259259e-03 6.11111111e-03 2.59259259e-03 1.66666667e-03
  9.25925926e-04 5.55555556e-04 1.85185185e-04 0.00000000e+00
  0.00000000e+00 1.66666667e-03]
 [6.45655376e-01 7.83210604e-01 7.61708395e-01 7.43446244e-01
  7.06332842e-01 7.44918999e-01 7.48453608e-01 7.74668630e-01
  7.86745214e-01 7.74963181e-01]
 [2.46340498e-01 5.52419887e-01 6.03586971e-01 5.08505868e-01
  4.61163128e-01 4.07094817e-01 5.12330212e-01 3.82038771e-01
  3.60015825e-01 2.88276408e-01]
 [4.87804878e-03 6.07879925e-02 3.62101313e-02 3.93996248e-02
  8.53658537e-02 2.08255159e-02 2.00938086e-01 6.75422139e-03
  0.00000000e+00 1.20075047e-02]]


Train losses per communication round:  [1.3075524768461064, 1.1697803470214934, 1.0864147227638494, 1.0214237944558484, 0.9723102426170142, 0.9309710940935011, 0.8863761452526552, 0.8403748834171305, 0.8315120992244669, 0.8103283979790069]
Test losses per communication round:  [23.78431752920151, 22.221262073516847, 21.430575406551363, 20.829410552978516, 20.762365055084228, 20.506891512870787, 20.89073202610016, 20.50897886157036, 20.342340582609175, 22.45729055404663]
Test weighted accuracies per communication round:  [0.13137019634151742, 0.27960053073973845, 0.2969316058053557, 0.3182304672741316, 0.31102135685541915, 0.3499164613770046, 0.34396669462344676, 0.3718250506278159, 0.34166291885338756, 0.2501155302839694]
Test losses per communication round for each client:  [[25.33539653 19.83595264 18.12753367 16.63404024 17.12213027 16.1271444
  16.47563362 14.30461109 13.98830467 20.23512948]
 [22.20627856 20.25683439 17.98298836 16.9444989  16.39929962 15.57075584
  15.66871727 14.74989223 15.05569708 17.906394  ]
 [24.87803102 22.29845929 21.67646122 21.13250721 19.72579598 19.08487785
  19.89573085 19.97823393 19.23552608 22.35929179]
 [23.19852161 19.76600754 18.1458956  16.21189368 15.07515359 13.4132359
  13.05809379 12.39523232 11.29897928 13.96671498]
 [27.24194813 26.28061438 27.72787762 28.00396848 31.72723627 34.26132536
  34.37313676 33.25386167 32.5198276  45.12064266]
 [22.03679967 19.53432417 16.23546398 13.4945848  14.96383893 11.4532091
   9.67333794  9.08768672 10.31702745 19.76708627]
 [24.90611076 21.74055064 21.18251836 20.92837429 19.25323367 20.07752621
  20.29561949 20.01083767 19.64069784 19.80537546]
 [22.23803902 24.97302461 25.53275585 26.38460135 26.17869186 26.62773824
  28.61091089 28.93494487 29.18648815 22.77349961]
 [23.82974792 22.64833903 22.26679373 22.6346705  20.9892211  21.96010315
  22.47607231 23.63150573 23.49500346 20.10912061]
 [21.97230208 24.87851405 25.42746568 25.9249661  26.18904924 26.49299908
  28.38006735 28.74298239 28.6858542  22.52965069]]
Test accuracies per communication round for each client:  [[1.50414455e-01 3.18710999e-01 4.30380926e-01 4.08773400e-01
  4.43513086e-01 4.53851169e-01 4.41929776e-01 4.75086151e-01
  4.59253050e-01 4.45468939e-01]
 [1.07726673e-01 5.04619758e-01 5.37008833e-01 5.87369276e-01
  5.53457204e-01 5.45131485e-01 5.30713778e-01 5.81886486e-01
  5.55995533e-01 4.57812976e-01]
 [2.06446940e-02 1.16443318e-01 9.23578414e-02 1.38536762e-01
  1.63165520e-01 3.19992756e-01 2.72365085e-01 3.70336834e-01
  2.69829772e-01 5.84932995e-02]
 [2.32435597e-01 6.14363778e-01 5.92701015e-01 7.06088993e-01
  6.77985948e-01 7.05991413e-01 6.91354411e-01 7.29410617e-01
  8.04937549e-01 5.71623731e-01]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 1.85150898e-04
  0.00000000e+00 0.00000000e+00]
 [4.79166667e-01 8.03240741e-01 9.02777778e-01 9.09722222e-01
  8.61111111e-01 9.28240741e-01 9.65277778e-01 9.53703704e-01
  9.21296296e-01 5.20833333e-01]
 [0.00000000e+00 4.87062405e-02 9.13242009e-03 3.04414003e-03
  7.45814307e-02 3.04414003e-03 1.52207002e-03 1.52207002e-03
  1.52207002e-03 2.66362253e-01]
 [4.92227979e-02 2.59067358e-03 0.00000000e+00 2.59067358e-03
  2.59067358e-03 2.59067358e-03 2.59067358e-03 2.59067358e-03
  0.00000000e+00 1.26943005e-01]
 [3.16242297e-02 8.31298686e-02 6.03418207e-02 6.18532729e-02
  1.03011278e-01 3.91814905e-02 3.55772585e-02 3.98790838e-02
  5.40634810e-02 2.46482967e-01]
 [7.33056708e-02 1.19870908e-02 5.53250346e-03 4.61041955e-03
  5.53250346e-03 5.07146150e-03 3.68833564e-03 3.68833564e-03
  5.53250346e-03 1.34163209e-01]]


Train losses per communication round:  [1.3137010780619816, 1.1124403883932006, 0.9780836582111652, 0.8836259020516556, 0.8075424326368623, 0.7497622829540072, 0.7010035786608138, 0.6574175445612436, 0.6264801589567005, 0.5933414647070905]
Test losses per communication round:  [23.850146222114564, 22.502680611610412, 22.02519870996475, 21.839154374599456, 21.180649614334108, 21.217948222160338, 20.82832326889038, 20.452201700210573, 20.815194153785704, 20.720433628559114]
Test weighted accuracies per communication round:  [0.19995596947681216, 0.2506711009398112, 0.3110642356389247, 0.32536759521482905, 0.35283782389914786, 0.3570577101407799, 0.3647003842999839, 0.3674756062187017, 0.3529879860509438, 0.3558533272469399]
Test losses per communication round for each client:  [[20.85583043 21.16306567 19.94817436 20.23213792 19.40490544 18.10030913
  18.75407529 19.04206586 17.73042572 19.47316706]
 [23.08412957 23.0657382  21.78919566 22.1243881  21.06726599 19.60227263
  20.24561775 20.64789379 19.37518883 21.08289254]
 [26.23846006 25.59262252 27.29680514 27.1129005  27.19495153 28.31837654
  28.59612846 27.57801414 28.1564796  27.34426808]
 [26.97176695 23.83737803 24.15073276 24.2397871  24.41323471 23.33994317
  22.9319551  22.5073092  22.867167   22.40882993]
 [24.07780504 23.28124261 20.65797591 19.61502898 17.65569293 15.73638248
  16.43270934 15.96888804 15.18067777 14.6102134 ]
 [26.73064876 25.2038517  26.1963594  26.09013724 25.50451064 28.23815823
  26.55533099 25.44598699 27.54047918 26.7632761 ]
 [22.22361279 20.19354022 19.26760828 18.2974714  16.77497315 17.20745754
  16.51729143 15.75602722 17.40325344 16.77223361]
 [21.05696774 20.02516723 19.24816859 18.69696999 17.52885294 18.01935375
  16.47066998 16.43066418 16.23520148 15.98035932]
 [23.56503081 20.47879422 18.68658674 18.332093   17.52938175 17.78434587
  16.54568827 15.5227077  17.09044528 16.13563097]
 [23.69721007 22.18540573 23.01038027 23.65062952 24.73272705 25.83288288
  25.23376608 25.62245989 26.57262325 26.63346529]]
Test accuracies per communication round for each client:  [[3.08333333e-01 2.41666667e-01 4.50000000e-01 4.00000000e-01
  4.41666667e-01 5.50000000e-01 4.91666667e-01 4.66666667e-01
  5.66666667e-01 4.08333333e-01]
 [2.06723891e-01 1.73372675e-01 2.88894850e-01 2.57421316e-01
  3.11874106e-01 3.91541488e-01 3.56133763e-01 3.23587268e-01
  4.02628755e-01 2.74052217e-01]
 [5.09987250e-03 8.92477688e-03 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 6.11111111e-03 2.77777778e-03 3.14814815e-03
  7.40740741e-04 3.33333333e-03 1.46296296e-02 2.50000000e-02
  7.03703704e-03 1.88888889e-02]
 [1.38364780e-01 2.51572327e-01 5.13626834e-01 5.87002096e-01
  6.89727463e-01 7.46331237e-01 7.29559748e-01 7.19077568e-01
  7.33752621e-01 7.48427673e-01]
 [5.10855683e-03 3.51213282e-02 1.46871009e-02 3.51213282e-02
  5.23627075e-02 9.57854406e-03 2.42656450e-02 3.76756066e-02
  1.59642401e-02 2.93742018e-02]
 [4.01677704e-01 4.69403974e-01 5.52317881e-01 6.14569536e-01
  6.35673289e-01 6.02295806e-01 6.19161148e-01 6.42913907e-01
  5.54083885e-01 6.06357616e-01]
 [4.41634738e-01 5.81353768e-01 6.06002554e-01 5.76117497e-01
  6.02554278e-01 6.04214559e-01 6.46615581e-01 6.37292465e-01
  6.30140485e-01 6.51979566e-01]
 [3.29454109e-01 6.17756449e-01 6.28554289e-01 6.43791242e-01
  6.47750450e-01 6.27954409e-01 6.28674265e-01 6.48350330e-01
  6.29154169e-01 6.39952010e-01]
 [9.05730129e-03 2.56931608e-02 1.84842884e-03 7.39371534e-04
  5.54528651e-04 1.10905730e-03 1.10905730e-03 1.10905730e-03
  1.10905730e-03 2.03327172e-03]]
