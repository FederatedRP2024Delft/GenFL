# pretraining

# federated baseline IID pretraining
Train losses per communication round:  [0.837358289100085, 0.5851639676405505, 0.4774631231931192, 0.4050757538355727, 0.35794536044146763, 0.3245465769706647, 0.3025255419529517, 0.283303236451755, 0.2714733778229383, 0.26030609900388074]
Test losses per communication round:  [5.9199825644493105, 4.603844946622848, 3.7929217889904976, 3.3051800206303596, 2.956539602577686, 2.682281215488911, 2.500471626222134, 2.375241530686617, 2.2268052235245706, 2.156960444152355]
Test weighted accuracies per communication round:  [0.9134444444444445, 0.9210925925925927, 0.9259444444444445, 0.9290185185185186, 0.9317407407407408, 0.9336851851851853, 0.9360185185185186, 0.9370925925925926, 0.9393148148148148, 0.9406666666666668]
Test losses per communication round for each client:  [[6.15578848 4.8681336  4.17217401 3.48871243 3.12959468 2.87188973
  2.73664629 2.5432332  2.46214585 2.34373371]
 [5.77554438 4.46198723 3.68560442 3.15091325 2.92767172 2.41606601
  2.33725446 2.26707715 2.15948993 2.0445209 ]
 [5.44970357 4.22081086 3.29033303 3.02689093 2.64699043 2.51533219
  2.28961051 2.13398438 2.02322541 1.9367905 ]
 [6.19347247 4.79820547 4.06422246 3.45840317 2.887151   2.71193536
  2.60828927 2.40269817 2.29664563 2.26046084]
 [5.82359242 4.49363151 3.6917806  3.20779471 2.87781188 2.6397384
  2.36661519 2.38401622 2.20371731 2.09905389]
 [5.91440913 4.53500763 3.73378561 3.21897292 2.89817309 2.55740748
  2.41954391 2.36812764 2.17002195 2.07642077]
 [6.1083152  4.78117764 3.99127266 3.42361265 3.21974103 2.87771885
  2.68088613 2.59307756 2.33524618 2.30410707]
 [5.98193678 4.5991478  3.82804495 3.3122385  2.9620696  2.70721833
  2.50014843 2.32432018 2.14303939 2.17994906]
 [6.19371003 4.79553542 3.82655373 3.43781421 2.99647415 2.81005721
  2.62163854 2.45289771 2.26795693 2.22512303]
 [5.60335317 4.48481232 3.64544642 3.32644743 3.01971844 2.7154486
  2.44408353 2.28298309 2.20656367 2.09944467]]
Test accuracies per communication round for each client:  [[0.90962963 0.91814815 0.9212963  0.92425926 0.92777778 0.92685185
  0.92722222 0.93037037 0.93092593 0.935     ]
 [0.91481481 0.92351852 0.92814815 0.93185185 0.93092593 0.93685185
  0.93888889 0.93851852 0.93814815 0.93981481]
 [0.91592593 0.92574074 0.93333333 0.93425926 0.93759259 0.93907407
  0.94240741 0.94240741 0.945      0.94851852]
 [0.91203704 0.92055556 0.92481481 0.92796296 0.9337037  0.93314815
  0.93574074 0.93851852 0.94092593 0.94037037]
 [0.91111111 0.92092593 0.92574074 0.92944444 0.93185185 0.93537037
  0.93648148 0.93648148 0.94       0.94166667]
 [0.91296296 0.92074074 0.92425926 0.9287037  0.93092593 0.93351852
  0.9362963  0.93592593 0.93796296 0.93981481]
 [0.91518519 0.92259259 0.92537037 0.92907407 0.92944444 0.93314815
  0.93444444 0.9362963  0.94       0.94037037]
 [0.91777778 0.92185185 0.92944444 0.93055556 0.93425926 0.93666667
  0.94037037 0.94055556 0.94333333 0.94185185]
 [0.9087037  0.91574074 0.92092593 0.92722222 0.93074074 0.92981481
  0.93203704 0.93351852 0.9362963  0.93814815]
 [0.9162963  0.92111111 0.92611111 0.92685185 0.93018519 0.93240741
  0.9362963  0.93833333 0.94055556 0.94111111]]


Train losses per communication round:  [0.734201874219673, 0.529519581854026, 0.44049379322062193, 0.3785242694932568, 0.33581049524506995, 0.30800216985768614, 0.2837983082583399, 0.2699196112171689, 0.2555376787160898, 0.2444064502507867]
Test losses per communication round:  [5.382703599333763, 4.2358014523983005, 3.5462757676839827, 3.0608284518122675, 2.729699745774269, 2.5214226856827735, 2.3474346935749053, 2.2007423996925355, 2.1203707084059715, 2.0423420913517476]
Test weighted accuracies per communication round:  [0.915537037037037, 0.9233888888888889, 0.9285555555555556, 0.9328703703703705, 0.9355740740740741, 0.9367037037037037, 0.9382777777777779, 0.9401296296296298, 0.9413333333333334, 0.9428148148148149]
Test losses per communication round for each client:  [[5.11358091 4.16382885 3.5417359  3.11322966 2.66834094 2.45781274
  2.30143225 2.20738783 2.03064544 1.97307391]
 [5.61457467 4.56538466 3.55768463 3.16496721 2.80915612 2.67506737
  2.39939748 2.28469385 2.1485679  2.08776948]
 [5.49427286 4.20890081 3.5063348  2.85412881 2.66375403 2.3940617
  2.20019078 2.11062801 2.00427346 1.93091653]
 [5.41132441 3.97097558 3.53314921 2.95857149 2.58508794 2.37794402
  2.21611068 2.04234716 2.02999187 1.98213294]
 [5.30864927 4.06382155 3.30509166 2.90245669 2.58403134 2.39310001
  2.24219355 2.12596579 2.0149309  1.90020669]
 [5.48293543 4.16267574 3.41941175 3.03554389 2.70694779 2.42698227
  2.32361537 2.24173833 2.11129914 2.03974262]
 [5.59253579 4.36285308 3.66935526 3.18043087 2.72804885 2.72554623
  2.45469078 2.32721269 2.29177876 2.14259526]
 [5.70384637 4.62213475 3.88982314 3.33724767 3.05760168 2.76925914
  2.6169436  2.40051018 2.31114954 2.29465699]
 [4.94891351 4.12962213 3.58955294 3.13370371 2.72440468 2.51415919
  2.33827056 2.13000269 2.09784912 2.03019744]
 [5.15640277 4.10781738 3.45061839 2.92800452 2.7696241  2.4802942
  2.38150188 2.13693745 2.16322096 2.04212905]]
Test accuracies per communication round for each client:  [[0.91814815 0.92518519 0.92962963 0.93259259 0.93703704 0.93740741
  0.94       0.9412963  0.94388889 0.94259259]
 [0.90962963 0.91685185 0.92555556 0.93111111 0.93407407 0.93444444
  0.93814815 0.94018519 0.94203704 0.94462963]
 [0.90962963 0.92074074 0.92740741 0.93296296 0.93240741 0.93462963
  0.93666667 0.93685185 0.9387037  0.94055556]
 [0.91796296 0.9287037  0.93092593 0.93481481 0.93833333 0.94148148
  0.94407407 0.94574074 0.94759259 0.9462963 ]
 [0.91481481 0.92444444 0.93203704 0.93388889 0.93777778 0.93833333
  0.94018519 0.94055556 0.94351852 0.94648148]
 [0.9162963  0.92407407 0.93055556 0.93574074 0.93666667 0.94166667
  0.93777778 0.94203704 0.94222222 0.94444444]
 [0.91148148 0.92203704 0.92759259 0.93240741 0.93462963 0.93166667
  0.93462963 0.93574074 0.93555556 0.93796296]
 [0.91759259 0.9212963  0.92425926 0.92907407 0.93203704 0.93185185
  0.93222222 0.93574074 0.93685185 0.93796296]
 [0.92333333 0.92555556 0.92851852 0.9312963  0.93740741 0.93833333
  0.94018519 0.94240741 0.94111111 0.94185185]
 [0.91648148 0.925      0.92907407 0.93481481 0.93537037 0.93722222
  0.93888889 0.94074074 0.94185185 0.94537037]]


Train losses per communication round:  [0.8402315273086781, 0.5839439952499856, 0.4757970592211973, 0.4087232905669074, 0.35970179374700345, 0.3313377005909673, 0.3134610914260827, 0.29379119078102434, 0.28454815057979777, 0.2757605168451803]
Test losses per communication round:  [5.721679177880287, 4.541834664344788, 3.733320966362953, 3.3741061463952065, 3.055750398337841, 2.782108424603939, 2.61953518986702, 2.4588409319519995, 2.3827439546585083, 2.2874141156673433]
Test weighted accuracies per communication round:  [0.9103518518518519, 0.9177222222222223, 0.9220370370370371, 0.9260370370370371, 0.9275925925925926, 0.9305740740740741, 0.9318333333333334, 0.9337592592592593, 0.934888888888889, 0.9366111111111112]
Test losses per communication round for each client:  [[6.68999344 5.08077881 4.36589296 3.96319938 3.43943998 3.21684372
  3.02072459 2.73618969 2.80113807 2.67794766]
 [5.88243482 4.90393949 3.91267097 3.57089627 3.3604176  3.0411693
  2.90252981 2.652016   2.564777   2.50632834]
 [5.39161015 4.43678969 3.74204451 3.37254223 3.03626706 2.80880302
  2.58689319 2.57748079 2.42729922 2.29607593]
 [5.37823653 4.15422985 3.44061343 3.10619219 2.88616937 2.60686494
  2.47444351 2.33615594 2.21318635 2.16862483]
 [5.56526741 4.44822711 3.5468061  3.19322124 2.86361524 2.5381119
  2.44658002 2.28520298 2.28083773 2.10647713]
 [5.53090703 4.31388178 3.77346361 3.41522199 3.08338863 2.85074486
  2.68258965 2.44388206 2.41003963 2.36759925]
 [6.01970258 4.87069091 3.9170081  3.37014434 3.16610256 2.80509123
  2.66973868 2.51984072 2.36482257 2.30859274]
 [5.47373036 4.35431528 3.64093736 3.41435722 2.96784212 2.67124899
  2.41831987 2.39117433 2.23140633 2.17703275]
 [5.7136569  4.57999748 3.48318566 3.24782491 3.05460221 2.74237515
  2.62072134 2.39394486 2.36172874 2.22275908]
 [5.57125255 4.27549624 3.51058696 3.08746171 2.69965921 2.53983113
  2.37281124 2.25252195 2.1722039  2.04270345]]
Test accuracies per communication round for each client:  [[0.90259259 0.91222222 0.91518519 0.91648148 0.92018519 0.92537037
  0.92722222 0.92851852 0.92666667 0.93018519]
 [0.90481481 0.91222222 0.91851852 0.92222222 0.92148148 0.9237037
  0.92481481 0.92888889 0.93148148 0.92981481]
 [0.91444444 0.91611111 0.91648148 0.92351852 0.92722222 0.92907407
  0.9337037  0.93259259 0.935      0.93685185]
 [0.90851852 0.91685185 0.91888889 0.92185185 0.92425926 0.92740741
  0.92907407 0.92944444 0.93240741 0.93388889]
 [0.90962963 0.9187037  0.92648148 0.92888889 0.93203704 0.93314815
  0.93537037 0.93777778 0.93666667 0.93981481]
 [0.91685185 0.92296296 0.92555556 0.92888889 0.93277778 0.93537037
  0.93407407 0.93814815 0.93925926 0.94111111]
 [0.90518519 0.91222222 0.91796296 0.92518519 0.92351852 0.92592593
  0.92888889 0.93037037 0.93185185 0.93222222]
 [0.91944444 0.92740741 0.93092593 0.9312963  0.93259259 0.93703704
  0.93851852 0.93944444 0.94074074 0.94166667]
 [0.91037037 0.91851852 0.9237037  0.93185185 0.92888889 0.93388889
  0.93111111 0.93537037 0.93592593 0.93907407]
 [0.91166667 0.92       0.92666667 0.93018519 0.93296296 0.93481481
  0.93555556 0.93703704 0.93888889 0.94148148]]

Train losses per communication round:  [0.8739465951753221, 0.5803169258009296, 0.4751551507163473, 0.40752994094420086, 0.36590489657260283, 0.33732804294838153, 0.3177413499068204, 0.3030294728622436, 0.28162894736666827, 0.27838595483738643]
Test losses per communication round:  [5.697037479281425, 4.445485067367554, 3.7986290872097017, 3.238758908212185, 2.998986652493477, 2.7255292534828186, 2.5704032674431803, 2.481546330451965, 2.383188371360302, 2.3181417375802993]
Test weighted accuracies per communication round:  [0.9068703703703704, 0.9169444444444446, 0.9217407407407407, 0.9257407407407408, 0.9278518518518519, 0.9302407407407408, 0.9326296296296297, 0.9330740740740742, 0.9347592592592593, 0.9352777777777779]
Test losses per communication round for each client:  [[5.19988409 4.11292434 3.34142967 3.01296917 2.76130998 2.60450409
  2.44754538 2.33658516 2.30008793 2.27295558]
 [5.85313734 4.52275738 3.90050924 3.26271412 3.02099305 2.71558003
  2.67955121 2.51123311 2.49786061 2.39724581]
 [5.70430377 4.58784267 3.93405074 3.26438583 3.05773918 2.67102396
  2.50502963 2.53707415 2.38614401 2.31275186]
 [6.08902442 4.92974055 4.26522157 3.44499958 3.21987355 2.91760501
  2.71431266 2.70077094 2.56497774 2.45087807]
 [5.89204776 4.52604425 3.99036315 3.4485433  3.20508531 2.96863838
  2.81416555 2.71859735 2.46248172 2.49161877]
 [5.55849761 4.27463582 3.71911122 3.15700684 2.91000454 2.65271899
  2.56025189 2.40891595 2.3864903  2.28176057]
 [5.60240799 4.31246993 3.65711316 3.1332643  2.93072426 2.63936611
  2.52578779 2.42616354 2.33432378 2.23725323]
 [5.58464658 4.22551841 3.73159662 3.16442323 2.92852041 2.72124584
  2.44749472 2.39408274 2.29450713 2.2112781 ]
 [5.78812528 4.38036749 3.67471647 3.15070704 2.89206503 2.58457099
  2.37519971 2.297308   2.20570469 2.15506808]
 [5.69829994 4.58254984 3.77217904 3.34857568 3.0635512  2.78003913
  2.63469414 2.48473236 2.39930581 2.3706073 ]]
Test accuracies per communication round for each client:  [[0.91203704 0.92166667 0.92814815 0.93388889 0.93462963 0.93481481
  0.93740741 0.93907407 0.93851852 0.93907407]
 [0.90296296 0.91574074 0.91907407 0.92425926 0.925      0.92888889
  0.92888889 0.93185185 0.93222222 0.93166667]
 [0.90722222 0.91574074 0.91814815 0.92462963 0.92555556 0.93092593
  0.93277778 0.93111111 0.93425926 0.93518519]
 [0.90444444 0.91222222 0.91814815 0.92259259 0.9262963  0.92796296
  0.92981481 0.92722222 0.93037037 0.93074074]
 [0.90518519 0.91574074 0.92166667 0.9237037  0.92592593 0.9262963
  0.92814815 0.92796296 0.93277778 0.93333333]
 [0.90833333 0.91796296 0.92092593 0.92462963 0.92703704 0.93222222
  0.93314815 0.93518519 0.93388889 0.93537037]
 [0.90388889 0.91740741 0.9212963  0.92407407 0.92851852 0.92907407
  0.93148148 0.93259259 0.93407407 0.93666667]
 [0.91055556 0.92037037 0.92574074 0.93       0.93185185 0.935
  0.93611111 0.93666667 0.93907407 0.93925926]
 [0.90407407 0.91518519 0.92166667 0.92388889 0.92592593 0.9287037
  0.93574074 0.93388889 0.93537037 0.93444444]
 [0.91       0.91740741 0.92259259 0.92574074 0.92777778 0.92851852
  0.93277778 0.93518519 0.93703704 0.93703704]]


Train losses per communication round:  [0.8030687536407877, 0.5740071839676032, 0.46715667536908867, 0.4084529029285176, 0.3671158764311925, 0.33670191271048033, 0.3079403797433554, 0.29293738911031697, 0.27312876919936113, 0.2645575868516207]
Test losses per communication round:  [5.699661764502525, 4.533240342140198, 3.737083208560944, 3.2713790968060494, 2.959415739774704, 2.719521698355675, 2.4986874774098395, 2.378048023581505, 2.2532311260700224, 2.190090076625347]
Test weighted accuracies per communication round:  [0.911888888888889, 0.9224074074074075, 0.9271666666666667, 0.9305925925925926, 0.9330740740740742, 0.9350740740740742, 0.9374444444444445, 0.9382777777777778, 0.9400740740740741, 0.9407777777777778]
Test losses per communication round for each client:  [[5.81971928 4.69778502 3.68775794 3.19351101 2.78659165 2.67689098
  2.44856717 2.32320458 2.14873226 2.15608279]
 [5.94449225 4.85352227 3.90712848 3.48955116 3.04515089 2.73792657
  2.49943034 2.45080106 2.3025945  2.29742074]
 [6.25804165 4.86079991 4.1687209  3.78813601 3.40767063 3.07608859
  2.73788258 2.71428415 2.55226806 2.42808883]
 [5.71659726 4.6090543  3.85378182 3.32191393 3.05859135 2.88619718
  2.62797934 2.49439383 2.39720812 2.27961887]
 [5.78211349 4.46015796 3.73438057 3.07980391 2.9008929  2.64926891
  2.46133053 2.31215134 2.21231654 2.09546605]
 [5.70949888 4.45110559 3.63647839 3.17132699 2.92671373 2.64603227
  2.40242431 2.31415306 2.20490591 2.10239323]
 [5.04418644 3.90010735 3.26765892 2.8345965  2.64151847 2.35288776
  2.20538756 2.07462966 2.01723039 1.92802016]
 [5.77937371 4.56661725 3.79195291 3.31957522 3.02905047 2.83170278
  2.60855025 2.40295918 2.38002616 2.28809464]
 [4.96087852 4.04163137 3.36288786 2.94760793 2.73631473 2.44266622
  2.35807782 2.1483421  1.97478223 1.96146975]
 [5.98171616 4.89162239 3.96008429 3.56776831 3.06166257 2.8955557
  2.63724487 2.54556127 2.34224708 2.3642457 ]]
Test accuracies per communication round for each client:  [[0.91203704 0.91777778 0.92518519 0.92796296 0.93148148 0.93425926
  0.9362963  0.93777778 0.94037037 0.94074074]
 [0.90981481 0.92074074 0.92685185 0.93074074 0.93388889 0.93777778
  0.94018519 0.94185185 0.94351852 0.94277778]
 [0.90444444 0.91648148 0.92185185 0.92314815 0.92666667 0.92851852
  0.93259259 0.93185185 0.93481481 0.93796296]
 [0.91314815 0.92388889 0.92574074 0.93018519 0.93055556 0.93259259
  0.93722222 0.93722222 0.93833333 0.93888889]
 [0.91092593 0.9237037  0.92907407 0.93444444 0.9362963  0.93907407
  0.93925926 0.94055556 0.94259259 0.94259259]
 [0.91611111 0.92537037 0.92888889 0.93333333 0.935      0.93740741
  0.9412963  0.94203704 0.94351852 0.94518519]
 [0.91796296 0.93222222 0.93555556 0.9362963  0.93907407 0.94092593
  0.94388889 0.94240741 0.94314815 0.94555556]
 [0.90759259 0.91888889 0.92537037 0.93       0.93277778 0.93481481
  0.93722222 0.93648148 0.93740741 0.93796296]
 [0.91759259 0.92722222 0.93092593 0.93444444 0.935      0.93462963
  0.93462963 0.93888889 0.94259259 0.94166667]
 [0.90925926 0.91777778 0.92222222 0.92537037 0.93       0.93074074
  0.93185185 0.9337037  0.93444444 0.93444444]]

# federated with dirchlet 0.01
Train losses per communication round:  [2.047354516162953, 1.5181305963176182, 1.171547554407298, 0.9762467435097262, 0.8395651170506, 0.7536624853636578, 0.7230316095554916, 0.664943713711531, 0.6182981596437752, 0.6199130451628412]
Test losses per communication round:  [18.96500374159077, 16.150089363608277, 14.728187951408108, 14.174910039454698, 14.302578972000628, 14.700112515687943, 14.891741724312306, 15.66092488123104, 15.860021413490177, 15.900322210788726]
Test weighted accuracies per communication round:  [0.6145406681083464, 0.6095934058546167, 0.5900571774155925, 0.567585798360758, 0.5440555520035493, 0.5252168006404603, 0.5079064763221006, 0.4982918754989617, 0.4888570996226551, 0.48487661887395517]
Test losses per communication round for each client:  [[20.40061522 16.49825871 14.34541273 13.46351898 12.49863207 12.29491639
  12.05069256 11.67121816 11.71454144 11.97072744]
 [10.73391593  8.53760094  9.64868182  8.6698758   8.59507239  9.05033213
   9.09121405 10.54748005 11.35252655 11.8863951 ]
 [ 4.33463306  4.44029239  4.70276085  5.33083264  5.59375719  7.52642119
   9.02008677  6.49393314  6.77966179  7.77963823]
 [22.45921004 16.61588985 15.31330335 14.97133303 15.01603246 13.84446305
  13.47320971 16.47279286 14.86113107 12.91190892]
 [18.88836277 14.12497324 12.77550983 11.83130652 12.05108893 11.67008126
  11.66754282 11.41965336 11.64486837 11.58764219]
 [19.00838411 14.23221767 12.14535236 10.21919063 10.14506549 10.55188495
   9.65057683 10.33975661  9.55774724  8.78314936]
 [24.35726941 23.08029175 19.26121962 17.36591566 16.44100595 15.88542694
  14.55393708 16.13840902 14.80180287 14.12651193]
 [23.63066775 23.07925135 19.89323485 21.07115221 22.22472727 23.48186272
  23.5200758  25.15835702 27.11479938 27.39775157]
 [16.50925851 15.79496694 15.9483453  15.97824621 17.06108117 18.72659886
  20.93999648 22.59651852 24.55369473 25.46363115]
 [29.32772064 25.0971508  23.2480588  22.84772873 23.3993268  23.96913767
  24.95008516 25.77113008 26.2194407  27.0958662 ]]
Test accuracies per communication round for each client:  [[0.58855535 0.59643527 0.60075047 0.59305816 0.59249531 0.58330206
  0.58030019 0.58611632 0.5793621  0.56697936]
 [0.81199007 0.79478538 0.77811281 0.76587442 0.74423554 0.72454771
  0.69829727 0.67577155 0.63870167 0.6285917 ]
 [0.88997031 0.87809304 0.86209172 0.8413065  0.8269548  0.81425272
  0.80188057 0.79099307 0.78208512 0.78472451]
 [0.60870425 0.61503462 0.6132542  0.61523244 0.59980218 0.60138477
  0.59604352 0.59366963 0.60098912 0.60316518]
 [0.59988927 0.62526529 0.63292424 0.62664944 0.61732952 0.61834456
  0.62425025 0.62120513 0.62295838 0.64436652]
 [0.67173456 0.69994263 0.71227768 0.70826162 0.71256454 0.71208644
  0.71973609 0.71524192 0.72375215 0.72996749]
 [0.55447942 0.60532688 0.6125908  0.55690073 0.55932203 0.54479419
  0.57384988 0.5496368  0.55447942 0.57869249]
 [0.425      0.4        0.325      0.25       0.2        0.15
  0.125      0.125      0.1        0.1       ]
 [0.71598361 0.67131148 0.61393443 0.56495902 0.48442623 0.40635246
  0.31516393 0.2567623  0.20184426 0.16885246]
 [0.38298677 0.33799622 0.26824197 0.21077505 0.16389414 0.13913043
  0.10831758 0.0899811  0.08166352 0.06899811]]


Train losses per communication round:  [1.8917134757379057, 1.3898589890843787, 1.0886622032202176, 0.902603834569114, 0.7131138446623887, 0.6194217190061697, 0.5772818664465424, 0.5082844690113325, 0.45844538787639016, 0.41987583276445495]
Test losses per communication round:  [19.27775522112256, 17.222028758033503, 14.87298678447969, 13.816114848782309, 14.438276415318251, 13.715912298113107, 14.403575158119201, 14.372462962567806, 14.947462636232377, 14.320737186074258]
Test weighted accuracies per communication round:  [0.6608369915238653, 0.6475441174814651, 0.6319184588135947, 0.6231800547895981, 0.6004102662393069, 0.5852847910256064, 0.5662242442233901, 0.5424851295398261, 0.5262087896981682, 0.5152246861446594]
Test losses per communication round for each client:  [[14.74970806 11.97034633 11.5136525  10.00439233 10.84793466 10.79561061
  11.14983177 12.32522762 12.85541987 12.80678725]
 [27.07158184 29.58061135 19.04135728 20.09256685 18.84704006 15.47706819
  15.20641577 14.51759768 13.20892668 14.52448666]
 [25.47452688 19.44497383 18.37023401 17.12593377 18.13013864 16.13516355
  18.61579263 17.13267887 17.78587711 17.44738257]
 [ 3.70038816  4.8199583   5.18416461  6.33531627  6.39058632  8.1389876
   8.98015198  9.13195725 10.00037935  9.86542332]
 [32.99646974 27.23999095 22.11627352 18.24340764 19.05006218 19.42568099
  20.15085804 19.65381801 21.63477993 21.16576064]
 [23.63870251 20.76865625 17.1668101  16.90953445 16.82639849 16.47461402
  14.46024525 14.37452102 13.26322025 13.792292  ]
 [21.78838682 22.46692038 20.38571084 17.2560299  18.70002842 16.5371893
  16.7919426  16.71641052 17.49951792 17.14107871]
 [ 3.40979356  4.39777946  5.5446927   6.38619064  7.22317009  8.28816027
  11.98995918 13.69044191 17.00433499 11.55451381]
 [25.69336009 22.72646737 21.34921992 19.15759063 20.6738795  19.82333291
  19.58473551 20.4489187  19.86638522 19.28234422]
 [14.25463456  8.80458336  8.05775237  6.65018602  7.69352579  6.06331554
   7.10581884  5.73305807  6.35578504  5.62730268]]
Test accuracies per communication round for each client:  [[0.70018116 0.71286232 0.70271739 0.72173913 0.68677536 0.67264493
  0.65018116 0.61467391 0.58822464 0.58152174]
 [0.56061356 0.52647204 0.52795646 0.50940129 0.49777338 0.51954478
  0.53661554 0.52696685 0.54552202 0.54230579]
 [0.43943821 0.4697898  0.47836742 0.48053539 0.47035536 0.48760486
  0.43481949 0.46206051 0.44820435 0.45470827]
 [0.91111111 0.9        0.9        0.86666667 0.85555556 0.78888889
  0.74444444 0.72222222 0.68888889 0.68888889]
 [0.39038136 0.4412925  0.45294007 0.42100319 0.41818523 0.37328574
  0.2988916  0.26019162 0.20326883 0.17302273]
 [0.58607498 0.54705432 0.55087988 0.54705432 0.52333588 0.53787299
  0.56771232 0.54475899 0.56771232 0.56159143]
 [0.65875614 0.60045008 0.54869067 0.54234861 0.51677578 0.51472995
  0.53089198 0.50675123 0.50511457 0.48342881]
 [0.92803221 0.90454622 0.8745177  0.84432142 0.82083543 0.79013588
  0.76111391 0.71347089 0.70072136 0.66364704]
 [0.54823395 0.49734144 0.47151538 0.44341056 0.40695025 0.38112419
  0.35301937 0.33118116 0.30250665 0.31238131]
 [0.70743907 0.76991633 0.78955984 0.80793016 0.81866133 0.83630411
  0.84394325 0.85449254 0.85885777 0.85731175]]


Train losses per communication round:  [1.9794844689186626, 1.5231591015708026, 1.2883099183856648, 1.1352543560406985, 1.0364324285159436, 0.9513584024377872, 0.8965084299012348, 0.8575896378694186, 0.8265123182377054, 0.784381227069498]
Test losses per communication round:  [20.515609273314475, 19.056054577231407, 18.34142643213272, 17.713252887129784, 16.921284441649913, 16.106115908920764, 16.153452202677727, 16.283031165599823, 15.840567901730537, 15.601044307649136]
Test weighted accuracies per communication round:  [0.6127025274984768, 0.604763494194803, 0.6093623737462917, 0.6088715711887512, 0.6135310003054617, 0.6153978583305335, 0.6192998923754278, 0.6211263714412568, 0.6194184041628559, 0.6179255262102954]
Test losses per communication round for each client:  [[20.91910934 22.7217288  23.99596047 24.82474422 24.40129304 24.62446332
  25.20990896 25.86692262 26.06829309 26.86447906]
 [ 7.43348056  5.43624553  4.22089082  3.49180382  3.25201318  3.13893676
   2.9726775   2.92252254  3.03023252  3.00730714]
 [20.62107375 19.40725636 19.4109689  19.34453082 17.52623314 17.00463492
  16.86855376 17.1435684  16.77477217 17.23483157]
 [31.07816041 29.58652985 30.81412637 26.87965703 28.15872359 27.55322242
  25.25860417 26.11089671 23.89955759 23.57128745]
 [15.1979571  14.39680767 13.79620212 14.02794683 11.25446136 11.20926803
  11.67064792 12.86918491 10.04713941  9.97480565]
 [12.76348078 10.52792245  9.30207586  8.66751468  7.98362756  6.6858369
   7.00669694  6.73843151  8.02156651  6.05938853]
 [13.7886112  13.63432449 13.01820099 11.78520349 11.40991336 10.64448389
  11.88548172 11.57236612 11.01360959 11.88138878]
 [26.90596223 25.74952137 25.06400967 26.20274854 25.62018538 23.21443558
  24.08260822 23.65555573 25.59480381 23.84496474]
 [38.08705211 30.63066697 27.93246436 26.11264491 23.81015015 22.58929992
  21.60839462 21.06950593 20.16453171 19.94788849]
 [18.36120525 18.46954226 15.85936475 15.79573452 15.79624367 14.39657736
  14.97094822 14.88135719 13.79117262 13.62410164]]
Test accuracies per communication round for each client:  [[0.38809035 0.27291394 0.18536494 0.12861676 0.09706926 0.075042
  0.06309502 0.04928131 0.04368116 0.04125443]
 [0.82769754 0.8584537  0.88334749 0.90254885 0.90824129 0.91376381
  0.92115548 0.92548853 0.92387426 0.92718777]
 [0.67431193 0.65137615 0.59174312 0.56880734 0.57798165 0.5733945
  0.59633028 0.5733945  0.5733945  0.56422018]
 [0.34751773 0.28368794 0.26950355 0.27659574 0.27659574 0.27659574
  0.29787234 0.29787234 0.31205674 0.30496454]
 [0.71579344 0.68959668 0.68846589 0.68978515 0.70128157 0.70844327
  0.70392009 0.71240106 0.71108179 0.71485111]
 [0.6660922  0.67987936 0.75592417 0.78414477 0.79900905 0.81430418
  0.82442913 0.84834123 0.8410168  0.85114175]
 [0.75168169 0.74037498 0.73951624 0.72878202 0.73150136 0.72792329
  0.71647345 0.70416488 0.70015744 0.68899385]
 [0.53644148 0.49609895 0.43824929 0.3809705  0.36060894 0.33777355
  0.3132255  0.30466223 0.28544244 0.28049477]
 [0.17166979 0.19362101 0.17748593 0.17748593 0.18255159 0.18855535
  0.20037523 0.20581614 0.21969981 0.21463415]
 [0.60702378 0.60235608 0.59779951 0.60424539 0.59313181 0.5959102
  0.59579907 0.60257835 0.62324961 0.62469438]]


Train losses per communication round:  [2.86780548837487, 2.2342653054573685, 1.9988936752666462, 1.8250090056031223, 1.696080844915339, 1.6194795747475978, 1.5666962268636708, 1.5408659646984388, 1.5217087755926708, 1.4900574859927889]
Test losses per communication round:  [17.086993038538004, 15.678719149139942, 13.591635757086625, 12.145137074263767, 11.40407311692834, 11.371770110621583, 10.760491175809875, 10.3686071369797, 9.94395501492545, 10.054784224554897]
Test weighted accuracies per communication round:  [0.6126710425668009, 0.645959614870296, 0.6443762901600069, 0.6742391319394078, 0.7011668599183319, 0.6644644358062628, 0.6653584573885933, 0.6588063214957558, 0.6690378081565173, 0.6676823332146826]
Test losses per communication round for each client:  [[12.24554461 12.30291975  9.91179186 11.83126825 10.0014507  11.42615426
  10.67391747  9.00373565  9.71015149  9.19240392]
 [14.35145259  9.10717547  7.94419891  5.46754849  3.64401808  5.16114593
   4.90491903  4.36323598  4.21501955  3.94463508]
 [ 1.79538212  2.39716858  2.7230816   2.52195628  3.72915275  3.16996056
   3.02675472  3.31182934  2.66121078  3.2717048 ]
 [21.04891108 22.15878665 20.83016756 18.87661493 16.93337798 21.1712141
  20.24590278 20.29248345 18.99005297 18.65253681]
 [ 5.10613677  3.55590907  2.81971939  3.25814036  4.64193863  3.28011898
   3.99032861  3.33930156  3.50040579  3.61239155]
 [ 9.56319045 12.99022621  7.13228154  6.19085174  8.98464179  4.65293402
   5.21412899  5.62866051  5.43854988  5.49745786]
 [11.9412936   8.70778638  8.17410815  7.07837939  6.34476262  5.31475389
   5.63189033  5.42445403  5.02231455  5.23816964]
 [39.90933967 44.55845761 41.7622962  35.06194758 27.90505624 32.06011772
  30.06113839 27.8215028  27.78699923 27.43206096]
 [ 8.70153477  6.61634697  4.98275464  5.30975752  8.7035175   5.17328166
   3.87582408  3.9791766   3.72195415  4.75275809]
 [46.20714474 34.39241481 29.63595772 25.8549062  23.15281487 22.30802
  19.98010737 20.52169144 18.39289176 18.95372355]]
Test accuracies per communication round for each client:  [[0.80111266 0.804242   0.76512517 0.74652295 0.69680111 0.71366481
  0.72531293 0.72148818 0.71679416 0.71053547]
 [0.61031519 0.72492837 0.75071633 0.83954155 0.91117479 0.85100287
  0.86532951 0.87679083 0.88538682 0.9025788 ]
 [0.93478261 0.94202899 0.94202899 0.93478261 0.89855072 0.9057971
  0.92753623 0.89855072 0.9057971  0.89130435]
 [0.56664278 0.54317449 0.48620566 0.50501612 0.55016123 0.44571838
  0.42063776 0.38373343 0.39555715 0.38874955]
 [0.88008914 0.90701036 0.91875452 0.90682968 0.86774271 0.90430017
  0.90399904 0.90947964 0.89755481 0.89556733]
 [0.81081081 0.81081081 0.83783784 0.82882883 0.78378378 0.85135135
  0.84234234 0.83783784 0.84684685 0.85135135]
 [0.6699712  0.73809364 0.78109719 0.80487642 0.82979436 0.83481814
  0.83441624 0.83722955 0.8510282  0.85745864]
 [0.29363905 0.23927515 0.19397189 0.21301775 0.27496302 0.19767012
  0.20691568 0.21394231 0.21431213 0.22263314]
 [0.73684211 0.77192982 0.84210526 0.80701754 0.70175439 0.84210526
  0.87719298 0.87719298 0.9122807  0.85964912]
 [0.11505138 0.14849889 0.15595406 0.1819464  0.18940157 0.21982672
  0.24984888 0.27926657 0.3213782  0.35301229]]


Train losses per communication round:  [1.0993027509032056, 0.8458298211124715, 0.6791583506875329, 0.5721725077927861, 0.4970277917567465, 0.44526144864718964, 0.40406484291216993, 0.3719977621396598, 0.34892178683343805, 0.32977511757325073]
Test losses per communication round:  [17.70180621854961, 13.791143692657352, 12.390621694922448, 11.589777027606033, 10.90549404323101, 10.489302030950785, 10.22978967865929, 10.48590903133154, 10.701743945479393, 10.93384607732296]
Test weighted accuracies per communication round:  [0.5994849565178438, 0.6099313109390453, 0.6085654052684812, 0.6029343878988885, 0.5988978011842532, 0.6009116511803559, 0.5974742256979874, 0.5880486157754735, 0.5897024964567206, 0.5867646164978361]
Test losses per communication round for each client:  [[34.73612988 29.6096698  26.29904008 24.35452962 23.1341753  21.897982
  20.91886735 20.60570419 20.80182111 21.29814088]
 [23.22386217 20.32168603 18.9853332  20.67413616 18.42712629 17.48887455
  17.42274785 17.76269901 18.88060939 18.4956032 ]
 [18.90602994 12.42117348 10.71707404 10.12153482  9.02061713  8.65052819
   8.0765495   8.40434933  7.97406453  7.92543334]
 [11.40555358  9.34971327  8.59736511  8.87988609  9.06727767  9.41481799
  10.14025432 11.33582717 12.19766712 11.95752358]
 [14.05468113 11.85364193 11.38476974  7.73700034  7.85523891  7.2231198
   7.26310909  6.92039931  6.64881498  8.07993817]
 [16.22076511 13.20012504 10.52071121  8.95039964  9.71403396  8.25476402
   7.75109963  7.69389012  7.99050683  7.43934372]
 [29.43579006 18.87765694 15.60002065 15.52151263 12.42508113 11.1058771
   9.95035136  9.81260002  8.87571222  9.01100761]
 [ 9.51990026  6.91527542  6.46898535  6.58271611  7.23199531  8.3991909
   8.80730003  9.91531163 10.60506964 11.09902853]
 [10.57188612  8.1970771   6.38382804  6.5516609   5.62474668  5.13615987
   5.71679074  5.45558573  5.75989059  6.0925706 ]
 [ 8.94346392  7.16541792  8.94908953  6.52439395  6.55464804  7.32170588
   6.25082692  6.9527238   7.28328305  7.93987113]]
Test accuracies per communication round for each client:  [[0.3872844  0.37565183 0.37284396 0.35318893 0.34677096 0.32972323
  0.32751705 0.30906538 0.30545527 0.2990373 ]
 [0.42503177 0.39358323 0.32782719 0.27382465 0.23062262 0.23125794
  0.2315756  0.20330368 0.20489199 0.20616264]
 [0.61376193 0.66800603 0.71132597 0.72626821 0.73254646 0.7424661
  0.75426921 0.75339026 0.77523857 0.79080864]
 [0.7703765  0.77741001 0.76210178 0.74017377 0.72238312 0.70666115
  0.67149359 0.63425734 0.62474141 0.59412495]
 [0.66486304 0.71305377 0.74585729 0.76208996 0.78829895 0.79320257
  0.80047345 0.8084207  0.80250254 0.79692256]
 [0.70560964 0.72183588 0.74455262 0.76634214 0.76912378 0.78766806
  0.78210478 0.77978674 0.78256838 0.7904497 ]
 [0.54105683 0.5831591  0.60701388 0.6455997  0.67914845 0.70490401
  0.71507318 0.73636191 0.74928721 0.74406006]
 [0.81090194 0.83366114 0.82186007 0.80275358 0.79123349 0.76678842
  0.72239393 0.68446193 0.66479348 0.63304299]
 [0.78588375 0.80921313 0.82799526 0.83590352 0.84084618 0.83946224
  0.82997232 0.82799526 0.83511269 0.82700672]
 [0.78219377 0.78171056 0.77023436 0.75730853 0.75078521 0.7498188
  0.74486591 0.74329548 0.74075864 0.74184586]]


# federated with dirchlet 0.1
Train losses per communication round:  [1.1135205420577121, 0.8471611314473557, 0.6664622708896675, 0.5424525148053017, 0.45362334253082404, 0.39188065236542297, 0.3566237746936768, 0.3287610870069324, 0.31513222922481493, 0.3023415763774339]
Test losses per communication round:  [9.173545625602127, 7.334455170645924, 6.837633619690314, 6.527659365534783, 6.09876647235942, 5.896014828979969, 5.786493880790658, 5.903837962076068, 5.702521209418774, 6.081969380378723]
Test weighted accuracies per communication round:  [0.8575862224652678, 0.8728117575565416, 0.8612552272271434, 0.8615569460379388, 0.8634275803597523, 0.8555945817253515, 0.8585211441599702, 0.8596199411818969, 0.8586509421586183, 0.8467831527217292]
Test losses per communication round for each client:  [[15.72707653 11.42336196 11.51415214 11.68826145 11.49801147 10.95246994
  10.02796432  9.69795072 10.66693228 11.86256319]
 [ 5.01759911  3.90564136  3.7071881   2.85644703  2.25537726  2.61425734
   1.94853418  1.74293624  1.50327569  1.74005577]
 [ 4.21973568  3.69839942  3.38795295  3.06620465  2.95768407  2.91705185
   2.72050455  2.44913892  2.64359728  2.68125898]
 [ 8.54318264  5.95912407  6.22447215  6.53191683  5.13976187  5.26466846
   5.30369875  3.96576518  5.27836493  5.14751399]
 [ 9.18762854  7.02249908  7.77440658  5.68004526  6.63988686  5.96669585
   4.93441594  6.5318003   4.69570196  6.40552723]
 [10.13514709  6.11938147  4.72129539  4.56011871  3.8220206   4.14800078
   4.57721803  3.53899661  4.1665076   4.28239247]
 [13.96945226 14.27157271 10.49107671 11.21565711 10.81149083  9.67797136
   9.44102646 11.02920336  9.71257742 11.32828844]
 [14.36460708 12.3866207  11.83752543 11.59063169 11.70216465 11.1791186
  12.8320328  12.69360453 12.61029148 11.06505132]
 [ 7.64864103  6.22877115  6.50089386  5.94399241  4.35487281  4.50649023
   4.34382215  5.56239852  3.80036516  3.95329876]
 [ 2.92238629  2.32917978  2.21737289  2.14331852  1.8063943   1.73342387
   1.73572162  1.82658524  1.94759829  2.35374366]]
Test accuracies per communication round for each client:  [[0.76682964 0.76081234 0.72621286 0.68672433 0.67393757 0.6513727
  0.66002256 0.68033095 0.65400527 0.61150809]
 [0.91437832 0.93346538 0.93895741 0.94462951 0.94949131 0.94994148
  0.95102188 0.94886108 0.95534348 0.95498334]
 [0.92091837 0.925      0.92227891 0.91734694 0.91615646 0.91377551
  0.91411565 0.92482993 0.91615646 0.91394558]
 [0.87786596 0.88492063 0.86463845 0.86287478 0.86243386 0.86155203
  0.85670194 0.87830688 0.86287478 0.85934744]
 [0.8482906  0.86858974 0.83226496 0.85683761 0.86752137 0.8525641
  0.86858974 0.8525641  0.87606838 0.86217949]
 [0.80618969 0.85514239 0.87961873 0.8727936  0.88267828 0.88020711
  0.87738291 0.89950577 0.87114615 0.87985408]
 [0.80963208 0.81645308 0.81376602 0.79102935 0.77986771 0.77449359
  0.74224886 0.73129392 0.71083092 0.67403886]
 [0.75803884 0.75326329 0.7277937  0.68672397 0.66666667 0.63960522
  0.64501751 0.67908309 0.63514804 0.59344158]
 [0.85844817 0.87417615 0.85320551 0.8704314  0.88031756 0.87297783
  0.88001797 0.86488916 0.89334931 0.88166567]
 [0.943993   0.95049381 0.95274409 0.95449431 0.95311914 0.95586948
  0.95399425 0.95011876 0.95061883 0.94899362]]


Train losses per communication round:  [0.9369234134599216, 0.7083444879012092, 0.5489314648460328, 0.46322188436782297, 0.4140667266085168, 0.3749050244957421, 0.34809219524286705, 0.3260070265455913, 0.3081800268754893, 0.2975316828603406]
Test losses per communication round:  [7.661718321574358, 10.609375293249105, 5.555166833660314, 4.35399806186706, 4.689540307764446, 3.8167372113093734, 3.8814644656700694, 4.096657956537092, 3.6846208848639437, 3.5734243945296384]
Test weighted accuracies per communication round:  [0.8727858891549647, 0.8017508572350138, 0.8911363520476486, 0.890598303041371, 0.8941514385989726, 0.9039883389557682, 0.8957707145248792, 0.894663953405665, 0.8987208931927749, 0.900743559580052]
Test losses per communication round for each client:  [[12.03011996 19.48952019  7.08254337  5.57089692 11.0868319   4.20927101
   6.82729799  4.13354742  4.39047062  4.50722206]
 [12.90592235 21.04366016  7.35564305  6.43908626  6.35103279  5.13738412
   5.02277365  6.01227903  5.2825312   4.73312661]
 [ 6.95012766  9.5107348   4.65015063  4.25689432  4.48197833  4.07687768
   3.77455083  4.27986413  3.82184249  3.31722342]
 [ 5.27577883  5.38609031  3.16167858  2.68830073  2.55012894  2.29505214
   2.25341715  2.17722527  2.13017519  2.15243389]
 [10.00450701 11.75325727 10.77669206  5.40781816  5.10255581  4.81808099
   4.53132044  5.85735184  4.77674666  5.20982566]
 [ 7.4037109   9.98684616  5.084968    4.63055813  3.49219558  3.49958636
   3.26191298  3.59207061  3.34782527  3.1734876 ]
 [ 6.44388626  7.76193714  5.37919584  4.38888743  4.25804366  4.60615835
   4.32648027  4.79085487  4.53342485  3.92969093]
 [ 2.9353649   3.44445034  2.16523446  1.91345295  1.80659443  1.97548515
   1.73575473  1.80081022  1.69564497  1.69254433]
 [ 9.36787402 13.64968073  7.61512172  6.22134089  5.84269454  4.65702018
   5.30108374  6.22370115  5.17930071  5.08741322]
 [ 3.29989133  4.06757583  2.28044061  2.02274481  1.9233471   2.89245613
   1.78005287  2.09887502  1.68824687  1.93127623]]
Test accuracies per communication round for each client:  [[0.84483742 0.72675414 0.86537365 0.85966914 0.87107815 0.88134626
  0.87678266 0.87621221 0.87906446 0.87450086]
 [0.80314513 0.63698371 0.83781736 0.83611216 0.84748011 0.86225843
  0.85771125 0.84842743 0.86055324 0.85979538]
 [0.85731737 0.75116052 0.88199365 0.87955045 0.88480332 0.90300513
  0.88223797 0.87906181 0.89225507 0.8964085 ]
 [0.90003874 0.86671833 0.92096087 0.92406044 0.92522278 0.92987214
  0.9287098  0.93180938 0.92909725 0.92716002]
 [0.80464814 0.70599707 0.84137819 0.83325207 0.8436535  0.86250609
  0.84560377 0.84121567 0.84592882 0.84495368]
 [0.85370052 0.77810142 0.89116907 0.88984509 0.89580299 0.90056931
  0.89937773 0.89606779 0.90030451 0.90242288]
 [0.87851623 0.82194745 0.88902628 0.89057187 0.8877898  0.89799073
  0.88840804 0.88593509 0.8877898  0.89180835]
 [0.93339845 0.91297398 0.94938283 0.94956043 0.95231329 0.94902762
  0.95444454 0.95373413 0.95551017 0.95630939]
 [0.83587339 0.76951934 0.84173505 0.84361079 0.84595545 0.87033998
  0.84454865 0.84618992 0.84642438 0.85556858]
 [0.93659711 0.91546281 0.94435527 0.94676297 0.94649545 0.94007491
  0.95050829 0.95238095 0.95211343 0.95238095]]

Train losses per communication round:  [1.236236072125311, 0.9204458042962097, 0.7083432988715441, 0.5597762516066076, 0.4909756884201107, 0.4374248828937044, 0.39571664773331483, 0.367942983766954, 0.3544890497977271, 0.33665218478936726]
Test losses per communication round:  [8.268363330277491, 7.221840986515599, 5.763467832470814, 5.050857401880785, 4.746052247940679, 4.523412057012069, 4.600850101665128, 4.394752478826558, 4.041888610720344, 4.53693986281869]
Test weighted accuracies per communication round:  [0.8506881041112543, 0.8547985581214571, 0.8620208140710706, 0.8636395203059255, 0.8628816583098059, 0.852721876073376, 0.8602281292241801, 0.8522137146767053, 0.8617277997975249, 0.8600115087610265]
Test losses per communication round for each client:  [[ 5.36139763  4.81200599  4.35309505  4.10129635  3.92320156  3.86421848
   3.98344797  3.98556125  4.17749396  3.9812611 ]
 [ 7.71142086  6.44767898  5.29230667  4.85442844  5.17011753  4.95492046
   4.84490338  5.28500197  4.61584832  4.85825866]
 [16.17869679 12.86928152 10.49012838  8.29386147  7.66666073  7.0744037
   6.21809767  5.76906296  5.37291767  9.7941511 ]
 [ 4.09131423  3.12584622  2.6763693   2.47051584  2.2535212   2.14732641
   2.25953837  1.91570644  1.96213808  1.84908136]
 [ 8.91275278  7.46153736  5.35837665  5.97070602  4.39584744  3.79449312
   5.17939535  3.42267395  3.3226686   3.07251786]
 [11.68249027 12.01686597  8.23835778  6.75343638  5.97705931  6.08545929
   7.12093139  6.49894375  5.14475195  5.52029759]
 [ 5.85924006  5.17224088  5.53001994  3.77987909  3.76074865  3.81995735
   3.58629143  3.5689472   4.02269706  3.82051215]
 [ 5.42005646  5.20434687  4.11479763  3.87910362  4.60191479  4.21950805
   4.32231197  4.45789897  3.69735477  4.16716352]
 [11.49428678  9.50888735  6.98536316  6.21167174  5.30464432  4.75788093
   4.29394731  4.40846938  3.87852326  3.68577722]
 [ 5.97197744  5.59971872  4.59586376  4.19367507  4.40680695  4.5159528
   4.19963619  4.63525891  4.22449243  4.62037808]]
Test accuracies per communication round for each client:  [[0.87270766 0.87486516 0.87162891 0.89320388 0.87378641 0.86839266
  0.87918015 0.8781014  0.87594391 0.88133765]
 [0.88811189 0.88170163 0.88170163 0.87062937 0.86946387 0.84848485
  0.85081585 0.83158508 0.84965035 0.8467366 ]
 [0.76752642 0.78525168 0.80434042 0.81308942 0.81933871 0.8149074
  0.82831496 0.83036019 0.83638223 0.83729122]
 [0.92573968 0.93486142 0.9391884  0.93813589 0.94234592 0.94222898
  0.94526956 0.94690679 0.94678985 0.94749152]
 [0.84433375 0.85585305 0.873132   0.88138232 0.88683064 0.89321295
  0.89881694 0.90239726 0.90846824 0.91391656]
 [0.7820793  0.79784577 0.81251951 0.82001249 0.83390571 0.82875429
  0.84389635 0.83655948 0.84670621 0.84389635]
 [0.8864721  0.89142805 0.8928047  0.89537445 0.89858664 0.89353891
  0.89509912 0.89445668 0.89831131 0.90060573]
 [0.88725318 0.88912256 0.89449702 0.89286132 0.8824629  0.87884099
  0.87568641 0.872415   0.87463489 0.87486856]
 [0.80677966 0.81610169 0.85254237 0.85762712 0.87033898 0.86949153
  0.88644068 0.87457627 0.88474576 0.88898305]
 [0.87407407 0.86296296 0.86481481 0.86111111 0.84814815 0.81851852
  0.83518519 0.80740741 0.83148148 0.81851852]]


Train losses per communication round:  [1.1090427389235988, 0.8273621837970803, 0.6547999878417197, 0.5453082591435343, 0.4725862935861521, 0.42383894843780895, 0.38883783662891286, 0.36193015566218223, 0.340867262727115, 0.33124730039693995]
Test losses per communication round:  [7.189416224230035, 5.437276612646872, 4.733047493919253, 4.570208582460509, 4.2881580693971015, 4.45612310782235, 3.9734483185835416, 4.369303037959616, 3.9334458086261295, 3.8461720160310504]
Test weighted accuracies per communication round:  [0.8844173259728977, 0.8936143984556373, 0.8940136815468029, 0.893858895943904, 0.8960613387426457, 0.8964501435648158, 0.8950430084437353, 0.8952487701498002, 0.8980223630057748, 0.8972635392352573]
Test losses per communication round for each client:  [[ 5.88136107  3.79359158  3.28703761  3.31678122  2.63666222  2.48435803
   2.39121845  2.34483495  2.40518939  2.07420124]
 [ 5.96316942  5.03380626  4.96902469  4.9884353   4.54407698  4.82377142
   4.80226007  4.96237203  4.78872071  4.86784416]
 [ 4.86990318  3.6815194   3.0175818   2.5833267   2.1368494   2.00346522
   1.73080084  3.12687647  1.74983424  2.03139429]
 [ 4.32801684  5.02711821  5.05913442  5.31748008  6.6689305   6.51223359
   6.67598069  7.23283964  6.58719575  7.2217738 ]
 [ 4.97616445  3.1565268   2.70950241  2.77153966  2.56338882  2.74840277
   2.39188552  2.38464911  2.85064895  2.26449396]
 [ 6.29060492  5.26012415  4.41733789  4.07608527  3.94999412  3.89588198
   3.9290019   3.94315344  3.64670491  3.77557722]
 [ 4.2676909   3.43785551  2.9270559   3.0119494   3.50114243  6.98018505
   2.45070286  2.4437988   2.66884318  2.48324511]
 [18.9192816  11.71988688  9.986691    8.31939918  7.78374958  6.56114316
   6.97012198  6.71115544  5.62748653  5.70846042]
 [ 9.53041697  8.18604577  6.67761523  7.26705509  5.53964245  5.19383672
   5.07666392  5.19388042  4.91262046  4.97213522]
 [ 6.86755291  5.07629156  4.27949399  4.05003393  3.55714419  3.35795315
   3.31584695  5.34947005  4.09721395  3.06259473]]
Test accuracies per communication round for each client:  [[0.89080728 0.9080728  0.91308913 0.91693887 0.92236351 0.92493
  0.92825478 0.93297947 0.93292114 0.93852077]
 [0.88242328 0.87544839 0.85890793 0.85073735 0.85193304 0.84455959
  0.83698685 0.83379833 0.84774811 0.84356317]
 [0.91899001 0.92635455 0.92793267 0.93319306 0.93687533 0.94108364
  0.94371383 0.94371383 0.9431878  0.94423987]
 [0.90934617 0.88347373 0.84035299 0.81327718 0.80946651 0.79081428
  0.78178901 0.7755716  0.79261933 0.78018452]
 [0.89903424 0.92010536 0.9262511  0.91834943 0.92361721 0.92888499
  0.92098332 0.92186128 0.91922739 0.92449517]
 [0.88571429 0.89006211 0.89937888 0.89627329 0.8947205  0.89347826
  0.8863354  0.88571429 0.89037267 0.8878882 ]
 [0.91988518 0.92640919 0.92693111 0.92014614 0.91936326 0.9204071
  0.92797495 0.92353862 0.91988518 0.9217119 ]
 [0.75664697 0.78766617 0.80151403 0.81462334 0.81351551 0.8129616
  0.81148449 0.81887001 0.8221935  0.81573117]
 [0.8178494  0.8270585  0.84100758 0.84967497 0.84845612 0.85265439
  0.84371614 0.84317443 0.85373781 0.84696641]
 [0.88086825 0.90181726 0.90509844 0.8982837  0.90560323 0.90080767
  0.8972741  0.90156487 0.89929329 0.89929329]]


Train losses per communication round:  [0.9319253010295707, 0.6905216868839441, 0.5536498150265815, 0.46244574347566597, 0.4042512170332472, 0.3581685431428315, 0.3387836786429286, 0.3172872289522002, 0.2973704582345265, 0.288154828687151]
Test losses per communication round:  [6.4460896328210655, 5.265632682925741, 4.671036589414689, 3.8199785482487583, 4.065978545566526, 3.4185531626397276, 3.761980220748228, 3.6253630420033005, 3.2623104944039367, 3.3735916502464534]
Test weighted accuracies per communication round:  [0.8794077721530261, 0.8899129372632105, 0.8964257261854212, 0.89889320358991, 0.9003696436708843, 0.9019294880078579, 0.90147667881315, 0.9040397351429585, 0.9045325159041364, 0.9072344327814374]
Test losses per communication round for each client:  [[3.2667754  2.32062762 2.0116016  1.77874995 2.33665658 1.82797033
  1.60080903 1.7689133  1.70566913 1.54041197]
 [6.92519792 5.76319263 4.70523059 4.20559074 6.13316602 3.74785664
  4.55249974 3.44701675 3.72684792 5.0175817 ]
 [6.98603064 5.04285976 3.90498839 3.42534861 3.15255441 2.85580605
  3.16051222 3.52609108 2.51361459 2.38011148]
 [6.66144812 4.82142445 5.43109471 4.09051666 3.75746443 3.71506387
  3.60947582 3.26453577 3.09981824 3.16621187]
 [7.92795002 6.55957234 5.95827688 5.96400771 5.77813745 5.41846272
  5.56357111 5.42063304 5.57653484 5.48262526]
 [6.48618299 5.09670636 4.3513394  3.72258514 3.38967338 3.33706933
  3.27467093 3.1911785  3.06710112 3.04570128]
 [8.70278645 9.67882064 9.83701748 5.70570409 7.72303233 5.11450528
  6.31829867 7.65720084 5.01622599 5.02814919]
 [5.03607062 3.84467271 2.95558746 2.70600069 2.42707744 2.24557184
  2.24818711 2.15628706 2.13714702 2.13240574]
 [6.4898344  5.53492153 4.49673149 3.84604788 3.45000183 3.46434546
  5.14252642 3.45076404 3.22872599 3.76104158]
 [5.97861978 3.99352879 3.05849789 2.75523402 2.51202159 2.4588801
  2.14925116 2.37101004 2.55142009 2.18167643]]
Test accuracies per communication round for each client:  [[0.93599776 0.94550028 0.94871437 0.95067077 0.95430408 0.95346562
  0.95402459 0.95528228 0.95514254 0.95612074]
 [0.87204864 0.87883501 0.88958009 0.89438711 0.90145624 0.89452849
  0.89905274 0.90301145 0.90216316 0.90400113]
 [0.88149716 0.90279064 0.91800026 0.91628092 0.9169422  0.92368734
  0.92606798 0.92567121 0.9272583  0.93241635]
 [0.87301876 0.89050829 0.89615595 0.89615595 0.89524504 0.90417198
  0.90781563 0.91036619 0.91637821 0.91564948]
 [0.85135135 0.8554309  0.85492096 0.84523202 0.8345232  0.83987761
  0.82712902 0.82993371 0.82024477 0.82330444]
 [0.85747126 0.87011494 0.87471264 0.88378033 0.88965517 0.88812261
  0.88939974 0.89144317 0.89553001 0.89693487]
 [0.8488806  0.86847015 0.87593284 0.86940299 0.85447761 0.8619403
  0.85820896 0.8619403  0.8516791  0.86287313]
 [0.90699153 0.91419492 0.92627119 0.92966102 0.93347458 0.93538136
  0.93389831 0.93411017 0.93432203 0.93516949]
 [0.87252021 0.87068332 0.86884644 0.87729611 0.88280676 0.88207201
  0.87472447 0.88133725 0.8853784  0.88978692]
 [0.88260802 0.90428992 0.91528574 0.92070621 0.92442311 0.92535233
  0.93216664 0.92798513 0.92829487 0.93170203]]

# federated with dirchlet 1.0
Train losses per communication round:  [0.8108929754918872, 0.5929622021297243, 0.48241896072882345, 0.4086923447564842, 0.36899442504485036, 0.33881183096029616, 0.31470838936560963, 0.30068253088313324, 0.28867549372491513, 0.2769429347794433]
Test losses per communication round:  [5.887697073544359, 5.850664759799576, 4.3622188720949, 3.5837496035499496, 3.2939196440798697, 2.80317187840501, 2.996053679267061, 2.617555294116028, 2.610004336345446, 2.441840121243149]
Test weighted accuracies per communication round:  [0.9058178622579277, 0.9112898196078029, 0.9149068045314014, 0.9208951731357369, 0.9205146530746371, 0.9261969617641704, 0.9271181003526385, 0.9298359578270523, 0.9316897981777668, 0.9329159177886457]
Test losses per communication round for each client:  [[6.53258171 7.00184563 4.44928779 4.21305576 3.66154608 3.10352451
  3.10198236 3.03504141 3.39514229 2.50897468]
 [5.54257883 4.12802473 3.51563571 3.1089887  3.36643328 2.40749999
  2.68712571 2.2982999  2.19671094 2.06601986]
 [5.64613238 4.53434004 3.75458769 3.23360462 3.28047539 2.68285807
  2.96373583 2.51144391 2.37692273 2.3846847 ]
 [6.57240086 5.45557112 4.80001459 3.69794603 3.67461934 3.25214923
  3.06878851 3.25053312 2.76646191 2.72618435]
 [4.70968724 3.50995028 3.93117197 2.56788574 2.74658896 2.25383215
  2.54617071 2.0112004  2.22416116 2.03821187]
 [6.54969218 6.33436519 3.87039851 3.4455519  3.02220801 2.77191195
  2.70598318 2.66938435 2.51828469 2.64860234]
 [6.11210307 9.26410553 4.39809917 3.6576532  3.45530108 3.01113577
  2.91348803 2.74763474 3.11683279 2.7421276 ]
 [6.71285053 7.72625497 4.72288691 5.02569345 3.79617516 3.29576775
  4.85666978 2.81539938 2.69865808 2.72520538]
 [4.87207139 4.3086755  3.39419939 2.9778502  2.86105645 2.57949059
  2.47979283 2.3674344  2.28184867 2.17347802]
 [5.62687254 6.24351463 6.785907   3.90926643 3.0747927  2.67354878
  2.63679984 2.46918134 2.52502009 2.40491242]]
Test accuracies per communication round for each client:  [[0.90649168 0.91024139 0.91539723 0.91985001 0.9161003  0.92617764
  0.92992735 0.93109913 0.9350832  0.93531755]
 [0.90981039 0.92052762 0.9291014  0.93173949 0.93371805 0.93470734
  0.9342127  0.93602638 0.9358615  0.93800495]
 [0.90475267 0.91037827 0.91658584 0.92104753 0.92085354 0.92783705
  0.92318138 0.92803104 0.93016489 0.93346266]
 [0.89681947 0.90174705 0.9027923  0.9129461  0.90697327 0.91817232
  0.92369718 0.92354786 0.92489174 0.92683291]
 [0.92407785 0.92962209 0.93618466 0.94127631 0.94014483 0.94387871
  0.944105   0.94602851 0.94749943 0.94772573]
 [0.90149316 0.910618   0.91476566 0.92057238 0.92472003 0.92596433
  0.92617171 0.93073414 0.93280796 0.93052675]
 [0.90486824 0.90062528 0.9057615  0.91469406 0.91983028 0.92474319
  0.92451987 0.9280929  0.93144261 0.93345243]
 [0.89624584 0.90622525 0.90543323 0.91066054 0.9086013  0.91572945
  0.91794709 0.92190718 0.92380802 0.92475843]
 [0.92230216 0.92374101 0.92769784 0.93417266 0.93201439 0.93417266
  0.93489209 0.93741007 0.93848921 0.94172662]
 [0.90163577 0.91101418 0.912759   0.91624864 0.91973828 0.92279171
  0.92104689 0.92388222 0.92388222 0.92519084]]


Train losses per communication round:  [0.7257758545986853, 0.544159770144418, 0.44470752410158054, 0.38689731371395963, 0.3497057716651815, 0.32003028606864564, 0.302311477282943, 0.2879776518629401, 0.2758789757200531, 0.27140406546733775]
Test losses per communication round:  [5.906816102564335, 3.8171513631382483, 3.35126055803302, 3.076924186074757, 2.7169659389182925, 2.594066758162808, 3.0750235944789894, 2.4852262015818267, 2.6540533973369747, 2.3785501556712916]
Test weighted accuracies per communication round:  [0.9142204541187309, 0.9234135812655127, 0.925796249232291, 0.9283619145787447, 0.9306764879069278, 0.931781079067074, 0.9216429657538052, 0.933508421450821, 0.9365529344902838, 0.93820860199065]
Test losses per communication round for each client:  [[4.82724789 3.63754191 3.2082351  2.88077685 2.78205031 2.56697273
  2.62842976 2.33448696 2.24745445 2.0989513 ]
 [7.77737102 3.7107923  3.1627433  4.32900792 2.74277057 2.55149051
  2.76850586 2.84580238 3.11247587 2.15322679]
 [4.46749456 3.53262    3.61991642 2.63096822 2.43849907 2.21048224
  2.74988037 2.01384075 3.30970633 1.94022632]
 [5.90563879 4.57987735 4.59412742 3.55288582 3.06904002 2.99211733
  3.39984183 2.74978296 3.06902276 2.83540379]
 [5.42559186 3.70120909 3.19682777 3.18086579 2.70911819 2.44821178
  3.02176831 3.21259511 2.21990659 2.056861  ]
 [5.74615633 3.35029014 2.95237748 2.83002676 2.46733521 2.33351443
  3.09368891 2.13108141 3.37774634 1.997467  ]
 [8.71709809 3.95219706 3.70091969 2.99623113 2.83757529 3.26871853
  3.69406658 2.70608737 2.42951041 3.46233079]
 [4.59575471 3.33189864 2.7646523  2.61887267 2.4352867  2.37305352
  2.84604102 2.13855474 2.22289273 2.88320366]
 [6.62004039 4.1885547  2.92954101 2.54785308 2.79433063 2.40701053
  2.84423981 2.13973126 2.0691208  1.94882455]
 [4.98576739 4.18653244 3.3832651  3.20175361 2.89365339 2.78909599
  3.7037735  2.58029907 2.48269768 2.40900635]]
Test accuracies per communication round for each client:  [[0.90982659 0.9199422  0.92398844 0.92398844 0.92514451 0.92601156
  0.92745665 0.92919075 0.9283237  0.93294798]
 [0.91690544 0.92634418 0.92668127 0.9298837  0.93258048 0.93325468
  0.92314175 0.93628856 0.93982808 0.94117647]
 [0.92026144 0.92941176 0.93124183 0.93490196 0.94013072 0.93986928
  0.92418301 0.94169935 0.94771242 0.94928105]
 [0.9011874  0.91213216 0.91729479 0.92276717 0.9240062  0.92493547
  0.91564275 0.92823955 0.92927207 0.93195663]
 [0.91072549 0.92159732 0.92473343 0.92431528 0.93079657 0.93037842
  0.91762492 0.93518712 0.94062304 0.94166841]
 [0.91853083 0.93152963 0.93137848 0.93606409 0.93530834 0.93848247
  0.93833132 0.94195889 0.94362152 0.94392382]
 [0.90652353 0.91544178 0.91890999 0.92204789 0.92386457 0.92568126
  0.91032205 0.9255161  0.92914946 0.93014038]
 [0.92317951 0.93411576 0.93464924 0.93598293 0.93571619 0.94051747
  0.93491598 0.93731662 0.94185116 0.94478528]
 [0.92096349 0.92585623 0.93018442 0.93206624 0.93507715 0.93507715
  0.92021076 0.93526534 0.93808807 0.93940534]
 [0.91421087 0.91726697 0.92032307 0.92163283 0.92643528 0.9255621
  0.90067671 0.92447064 0.92949138 0.92970967]]


Train losses per communication round:  [0.8285649855467572, 0.617386828319821, 0.49405110972486155, 0.4195162165922638, 0.3776651458243146, 0.34483588143262833, 0.3249163922359667, 0.3083330156282139, 0.2972361311042629, 0.28658215596889125]
Test losses per communication round:  [5.660765445284778, 4.668366834415065, 3.9478401363070246, 3.5777350316952834, 3.4188236445421323, 2.756982904601864, 2.6168055176121925, 2.618529627493899, 2.4410071426314515, 2.437228762385348]
Test weighted accuracies per communication round:  [0.9044566503868839, 0.9127557623403831, 0.9201082250073587, 0.9237944661064218, 0.9251798166205984, 0.926673103309902, 0.9287741303686151, 0.9295910170448218, 0.9319799998007301, 0.9328306722046001]
Test losses per communication round for each client:  [[6.44949957 5.03145494 4.00370506 4.16187191 3.26167881 2.96143347
  2.88401055 2.75002029 2.85771964 2.55023051]
 [6.42666483 4.64898086 3.73679882 3.24948901 2.86403683 2.74851768
  2.61656174 2.45037885 2.31147844 2.4105331 ]
 [6.42919421 4.72315028 7.20928416 4.72257149 5.28341429 2.75205028
  2.51496023 2.45292993 2.34696188 2.35022655]
 [5.10353308 3.83574644 3.16101282 2.73667893 2.47920839 2.22455005
  2.25184766 2.08070673 2.04033769 1.97751908]
 [5.06708872 5.94157833 3.28839814 2.84181185 2.68389428 2.46999138
  2.50275946 2.95010562 2.20617686 2.13604259]
 [4.73699012 3.89441423 3.07371489 4.64726973 2.60611058 2.65797041
  2.36492236 2.31030269 2.20896894 2.1945553 ]
 [5.64921614 4.42856313 3.60833985 3.05801131 5.76677606 2.79892582
  2.63800609 2.65144121 2.84737775 2.41455661]
 [6.3247439  5.25811572 4.52070692 4.04087806 3.6115881  3.77081199
  3.28615372 3.68734738 2.89046754 3.2377256 ]
 [5.17192763 5.00218669 3.62685232 3.42667215 2.95577764 2.6622326
  2.68675897 2.49501316 2.49859479 2.91953777]
 [5.24879625 3.91947773 3.24958839 2.89209588 2.67575146 2.52334537
  2.42207439 2.35705042 2.20198789 2.18136051]]
Test accuracies per communication round for each client:  [[0.89466037 0.90464947 0.91027969 0.91518344 0.91772612 0.92172176
  0.92226662 0.92317472 0.92589902 0.92698874]
 [0.90165816 0.91415816 0.91836735 0.9190051  0.92372449 0.92117347
  0.925      0.92806122 0.9317602  0.92857143]
 [0.89799784 0.91260823 0.92099567 0.92343074 0.92464827 0.92397186
  0.92667749 0.92775974 0.93114177 0.93290043]
 [0.92284352 0.92963445 0.93483601 0.9361364  0.93945962 0.94003757
  0.93945962 0.94292732 0.94148244 0.94466118]
 [0.91902038 0.92742224 0.93153379 0.93421523 0.93493028 0.93761173
  0.93796925 0.93975688 0.93922059 0.94154451]
 [0.91223156 0.92156863 0.92903828 0.93215064 0.93464052 0.93370682
  0.93557423 0.93495176 0.93744164 0.93899782]
 [0.89920098 0.90657652 0.91313255 0.92091784 0.91948371 0.9213276
  0.92317148 0.92194222 0.92583487 0.92440074]
 [0.88184438 0.88712776 0.90177714 0.90802113 0.90778098 0.91210375
  0.91666667 0.9154659  0.92243036 0.92291066]
 [0.90960208 0.91435986 0.92041522 0.92538927 0.92668685 0.93014706
  0.93447232 0.93447232 0.93295848 0.93382353]
 [0.9129199  0.91808786 0.92377261 0.92635659 0.92583979 0.92816537
  0.92842377 0.92997416 0.93281654 0.93307494]]


Train losses per communication round:  [0.7845050924478854, 0.5808579320933754, 0.4690987999903111, 0.40337950450177595, 0.3597065147474662, 0.33364005932967966, 0.31276354686895075, 0.29656021749613454, 0.280307178716058, 0.26982355228188654]
Test losses per communication round:  [6.146621952310307, 4.134742331573369, 3.665442187858207, 3.785856399011391, 2.8988941576782965, 2.6632652055110158, 2.5977730520709854, 2.442622145496716, 2.4042016103829154, 2.4238750202581287]
Test weighted accuracies per communication round:  [0.9112375361613714, 0.9196546227957267, 0.9238998088002764, 0.9277564679346059, 0.9296152058961338, 0.9324349439382379, 0.9337138014447203, 0.9356303027954549, 0.9383602705196878, 0.9390684597774384]
Test losses per communication round for each client:  [[4.1266548  3.42638842 2.84955068 2.81107186 2.41394869 2.3972754
  2.06807476 2.13561469 2.4914209  2.05352515]
 [8.14183486 4.4844769  4.09689184 3.49755167 3.03088549 3.16851893
  2.82063783 2.7193784  2.501692   2.52245836]
 [5.94569506 4.27358498 3.66731478 3.59835026 2.84339304 3.27667692
  2.49989123 2.40245183 2.3063146  2.41118577]
 [6.69594759 4.44152632 3.66833042 3.10853268 2.73068629 2.64533676
  3.4414853  2.93955414 2.36609867 2.42927993]
 [6.32746845 4.9713695  3.60693819 3.25036485 3.40116547 2.71524131
  2.81078765 2.51726846 2.36525674 2.2709937 ]
 [5.11644228 3.98721063 3.42302793 3.81159528 2.53067161 2.59087546
  2.37115106 2.58992147 2.48150571 2.35189179]
 [7.42242369 3.56390402 3.17849462 2.69171228 2.62311821 2.38891929
  2.36675054 2.13934306 2.81589936 2.15535602]
 [6.33004281 4.69626305 5.81418043 3.18725365 2.84246096 2.72619449
  2.86251961 2.36122202 2.42810448 2.16406984]
 [4.4490724  3.43196283 2.85536691 8.53970808 3.63908958 2.09080476
  2.01379558 2.02278685 1.88529123 3.2064362 ]
 [6.91063759 4.07073667 3.49432609 3.3624234  2.93352223 2.63280873
  2.72263697 2.59868053 2.40043243 2.67355345]]
Test accuracies per communication round for each client:  [[0.93292125 0.93658425 0.94207875 0.94047619 0.94207875 0.94505495
  0.9478022  0.94940476 0.95009158 0.95100733]
 [0.90232635 0.9138756  0.91602046 0.91965022 0.92344498 0.92360997
  0.92295001 0.92262003 0.92723973 0.92707474]
 [0.8976768  0.91492996 0.91715067 0.92722924 0.93013324 0.93354971
  0.93474547 0.93867441 0.93987017 0.94038264]
 [0.90450254 0.9070443  0.91067538 0.92120552 0.92193174 0.92338417
  0.92411038 0.92628903 0.93209877 0.92992012]
 [0.89396198 0.90793887 0.91669773 0.92117033 0.92322028 0.92843832
  0.9303019  0.93048826 0.93533358 0.93850168]
 [0.92524005 0.92866941 0.93232739 0.93392775 0.93552812 0.9352995
  0.93964335 0.94375857 0.94444444 0.94490169]
 [0.92488263 0.9309583  0.9342723  0.9375863  0.9367578  0.93786247
  0.93731014 0.9400718  0.94034797 0.94062414]
 [0.90369076 0.91220791 0.91821358 0.92389168 0.92836864 0.93120769
  0.93426512 0.93415593 0.93633981 0.93797772]
 [0.92689633 0.93239528 0.93773249 0.93821769 0.93886463 0.94436358
  0.94436358 0.94759825 0.94824519 0.94889212]
 [0.91142675 0.91940632 0.9235557  0.92339611 0.92563039 0.93057772
  0.93249282 0.93392914 0.93775934 0.93967443]]


Train losses per communication round:  [0.8666392746203406, 0.6300462619254554, 0.5189746726951233, 0.43923217043427903, 0.38595337878996516, 0.34876290640770613, 0.3270514002826207, 0.30775645946555963, 0.28911428503311465, 0.28033942428061437]
Test losses per communication round:  [7.447628939704003, 6.33676720960064, 4.466951393433919, 3.5038943675810854, 3.497923241018092, 2.886216172261436, 2.989666213291639, 2.863456490178578, 2.6450490386225285, 2.5356288782319667]
Test weighted accuracies per communication round:  [0.9086201225581299, 0.9180229991387352, 0.9240723501902988, 0.9261865320888675, 0.9289518061393786, 0.9315499506451939, 0.9327693801482904, 0.9344853010787951, 0.9358510628875205, 0.9367046623865272]
Test losses per communication round for each client:  [[ 6.99231248  5.24646194  4.32751112  4.31377462  3.52967888  3.15379839
   3.58162421  3.69030523  3.46906379  3.48455521]
 [ 5.40775028  7.1329135   3.5912098   2.9877957   2.69982159  2.46638916
   2.20520586  2.17143667  2.00183645  1.9638277 ]
 [ 6.63588768  4.03357304  3.86256136  2.90035421  3.36734416  2.32139868
   2.17486004  2.31360431  2.11027931  1.97689044]
 [11.63343331  5.33905405  4.78959823  3.78478959  3.45552014  3.08306086
   3.03274366  2.84958149  2.67184266  2.76790234]
 [ 5.96109213 15.57560143  3.86959499  3.15697488  3.02726026  2.72022785
   2.43206476  2.26571769  2.13852692  2.18858854]
 [ 5.13458589  3.91555539  3.14646717  3.25187466  5.58211879  2.24637712
   2.02930931  2.03219184  1.95552015  1.85971551]
 [12.10040611  3.7776046   3.13913342  2.78513036  2.68397634  2.30439265
   4.01795863  1.97660119  1.91822684  2.7344155 ]
 [ 7.10868594  7.9112792   4.54249666  4.00873221  3.65191653  3.67285883
   4.03603102  5.34315602  3.31755488  2.71814735]
 [ 7.3285687   5.46967289  4.66402408  4.24465665  3.88641199  3.58189541
   3.61195007  3.26069406  2.99929221  2.94417871]
 [ 6.17356688  4.96595607  8.73691711  3.6048608   3.09518373  3.31176275
   2.77491456  2.7312764   3.86834718  2.71806747]]
Test accuracies per communication round for each client:  [[0.90192539 0.91215403 0.91756919 0.91837144 0.92278379 0.92498997
  0.92559166 0.93000401 0.92819896 0.93020457]
 [0.926854   0.93380649 0.93626883 0.93931054 0.94220742 0.94510429
  0.94727694 0.94698725 0.948146   0.94988413]
 [0.91961415 0.92826256 0.93269764 0.93558044 0.93990465 0.94134605
  0.94068079 0.94289833 0.94611376 0.94666815]
 [0.90840273 0.91445874 0.91748675 0.91786525 0.92089326 0.92657078
  0.92429977 0.92467827 0.92884179 0.93111279]
 [0.91589209 0.92360009 0.93062798 0.93289504 0.93221492 0.93697574
  0.93878939 0.94014963 0.94218998 0.94082974]
 [0.92557972 0.93294985 0.93780334 0.93816286 0.94355564 0.94751034
  0.94715082 0.94948769 0.95020672 0.94912817]
 [0.91569053 0.92697035 0.93304411 0.93463485 0.93752711 0.93969631
  0.93882863 0.94244396 0.94244396 0.94316703]
 [0.90061029 0.90845684 0.91695728 0.91913688 0.92262424 0.92197036
  0.92327812 0.92567568 0.92632956 0.92436792]
 [0.87982226 0.89759645 0.90385781 0.90547364 0.90809937 0.91011917
  0.91597657 0.91395678 0.9206221  0.9206221 ]
 [0.89311459 0.90106885 0.91076311 0.91548596 0.9159831  0.91896595
  0.92294308 0.92294308 0.92393736 0.92816306]]


# federated with dirchlet 10.0
Train losses per communication round:  [0.8601758903386258, 0.5999554335617928, 0.4759075853852889, 0.409372857335425, 0.3636165937921775, 0.33134312459713494, 0.3159577319490458, 0.29181566188158625, 0.2815316879875373, 0.27131197904778087]
Test losses per communication round:  [7.025529573857784, 5.324470799090338, 3.812035487965113, 3.6014179632693413, 2.967283374158433, 2.8035550736123698, 2.5740900556644193, 2.4918638177216055, 2.376145013038331, 2.3251448750294004]
Test weighted accuracies per communication round:  [0.9094396404785945, 0.9205310912649858, 0.9263324131665991, 0.9284720221482614, 0.9317881856734953, 0.9320676898119146, 0.9348223874057583, 0.9369779083016483, 0.9376026515363344, 0.9386498637954638]
Test losses per communication round for each client:  [[ 5.77247147  4.14605987  3.20646882  2.89661903  2.64622481  2.44203861
   2.28500591  2.22901534  2.13724188  2.00075114]
 [ 9.23875922  4.88639962  3.79097095  4.95978548  3.03881534  3.02106012
   2.59512983  2.90612821  2.55890872  2.42531677]
 [ 7.15141815  4.65550929  4.05069837  3.67233779  3.03644719  2.93053432
   2.64240479  2.57141533  2.54181373  2.42585772]
 [ 6.37957454  4.18463197  3.44884162  2.9736914   2.87184009  2.80682994
   2.46833322  2.33895215  2.30005144  2.1727288 ]
 [ 6.55675697  4.86585528  3.79070815  3.41252014  3.00137922  2.82467528
   2.5507237   2.46145612  2.46639803  2.40841261]
 [ 6.04065365  4.39730933  3.60196394  3.22643864  2.82547201  2.61529008
   2.47058295  2.26121433  2.21273144  2.04505943]
 [ 7.04057187  5.77106544  4.62160757  4.8565663   3.20370406  3.08401766
   2.99701607  2.68880519  2.59723985  2.65353028]
 [ 7.32436872  5.1701261   4.05758645  3.37693577  3.14231692  2.76115955
   2.54842703  2.68736091  2.38099829  2.6877086 ]
 [ 6.51384431  4.75818422  3.92244963  3.51510289  3.19057723  2.92177904
   2.72404456  2.49228989  2.3799171   2.29463276]
 [ 8.23687685 10.40956686  3.62905938  3.12418221  2.71605687  2.62816615
   2.4592325   2.28200071  2.18614966  2.13745064]]
Test accuracies per communication round for each client:  [[0.91711332 0.9280245  0.93491577 0.93587289 0.94276417 0.94027565
  0.94295559 0.94372129 0.94314701 0.9454441 ]
 [0.90838011 0.91659984 0.92221331 0.92101043 0.92822775 0.92822775
  0.93143545 0.93203689 0.93524459 0.93504411]
 [0.90414747 0.91778802 0.92       0.92442396 0.92626728 0.92792627
  0.93142857 0.93179724 0.93419355 0.93474654]
 [0.91059261 0.9207103  0.92649184 0.93124097 0.93351229 0.93557712
  0.93578361 0.94032624 0.94032624 0.94280405]
 [0.90542636 0.91996124 0.92848837 0.92906977 0.93081395 0.93120155
  0.93546512 0.9375969  0.9374031  0.93662791]
 [0.90981067 0.91910499 0.9253012  0.92444062 0.93046472 0.9313253
  0.93218589 0.93511188 0.93717728 0.93889845]
 [0.90250982 0.91377838 0.92026635 0.92504695 0.92743725 0.92692505
  0.93016903 0.93273007 0.93273007 0.93512037]
 [0.91516279 0.92204651 0.92837209 0.93246512 0.93432558 0.93339535
  0.93786047 0.93934884 0.93748837 0.93860465]
 [0.90742975 0.9220824  0.92673677 0.92759869 0.93001207 0.93139114
  0.9339769  0.93656266 0.93690743 0.93707981]
 [0.91535255 0.92713431 0.93275331 0.93565343 0.93547218 0.93583469
  0.9383723  0.94235998 0.94272249 0.94326627]]


Train losses per communication round:  [0.8141844715715095, 0.5717870409613939, 0.46953443906515124, 0.4104248963135332, 0.3730459098017742, 0.34054355096544303, 0.3207060933878804, 0.3094678823375985, 0.29552069182858154, 0.28372870275577516]
Test losses per communication round:  [8.789248410612345, 4.502430922468193, 3.89669437028424, 3.366232742732586, 3.104761726806828, 3.0145861933528977, 3.0867158294189716, 2.6585897057345393, 2.441361240437254, 2.4174753191648053]
Test weighted accuracies per communication round:  [0.8664083350485825, 0.9142441869570254, 0.9195138153519975, 0.9250015493714384, 0.9270515087805272, 0.9296860193221106, 0.9305770508926923, 0.9329949857543264, 0.9337522868411259, 0.935763517866256]
Test losses per communication round for each client:  [[ 8.90527332  5.27917567  5.48018906  3.93888335  3.2162241   2.96742095
   3.21216428  4.12427241  2.54161539  2.76964535]
 [ 7.56382088  4.846973    4.10208134  3.45034142  3.16318124  2.92380785
   3.46675955  2.75167869  2.73975697  2.40857561]
 [ 7.07901454  3.99726695  3.30222794  2.94433977  2.71080133  2.48767291
   2.34432583  2.26815565  2.23382427  2.06309594]
 [ 7.75709879  4.52715495  3.59060366  3.14377284  2.91004796  2.60047434
   2.51383229  2.27803688  2.28690269  2.08620934]
 [ 9.73684704  4.55632913  3.95396033  3.64176274  3.49753946  4.86421609
   2.7935168   2.58112239  2.52298449  2.38914933]
 [ 9.94522595  4.52564584  3.84627764  3.50764105  3.49242003  2.94046266
   3.5342916   2.60902477  2.59368366  2.5484719 ]
 [ 7.40481329  4.2488392   3.65817299  3.21260752  3.02439678  2.70470884
   2.53149979  2.43173018  2.36164171  2.28825791]
 [ 9.42920327  4.3921379   3.87523926  3.50472686  3.15259082  3.01433532
   2.75483465  2.59607741  2.47470324  3.10691997]
 [12.5865013   4.35030878  3.56997594  3.18514808  2.92628951  2.96949196
   5.18458332  2.47067146  2.28589304  2.29262431]
 [ 7.48468572  4.3004778   3.58821553  3.1331038   2.95412605  2.67327102
   2.5313502   2.47512724  2.37260696  2.22180353]]
Test accuracies per communication round for each client:  [[0.8695428  0.91612238 0.91887246 0.92299759 0.92248195 0.92351323
  0.92918529 0.92781024 0.93038845 0.93090409]
 [0.86308872 0.90799562 0.91325301 0.92552026 0.92552026 0.92990142
  0.932092   0.9305586  0.93362541 0.93559693]
 [0.86746795 0.91810897 0.92083333 0.92644231 0.92788462 0.93108974
  0.93092949 0.93189103 0.93189103 0.93685897]
 [0.86227665 0.9182895  0.92230476 0.92953222 0.9291307  0.93254367
  0.93274443 0.93896808 0.93736198 0.94298334]
 [0.85815947 0.91185509 0.91703057 0.92204432 0.92624939 0.92673459
  0.9272198  0.93077794 0.93174834 0.93320395]
 [0.88623853 0.91600408 0.92150866 0.92313965 0.927421   0.92844037
  0.92925586 0.93149847 0.93007136 0.9351682 ]
 [0.863286   0.91095335 0.91825558 0.92332657 0.92799189 0.93286004
  0.93184584 0.93630832 0.93448276 0.93590264]
 [0.86600221 0.91306755 0.91823551 0.92248062 0.92488003 0.92709487
  0.92912514 0.93152455 0.93337025 0.92986342]
 [0.85944098 0.91011462 0.91715262 0.92016891 0.9245928  0.92640257
  0.92539714 0.92941886 0.93344058 0.93122863]
 [0.86961603 0.91836394 0.92587646 0.93222037 0.93288815 0.93639399
  0.93622705 0.93856427 0.939399   0.94290484]]


Train losses per communication round:  [0.7340090857329444, 0.5521808935931494, 0.4532232842957192, 0.3995983867891914, 0.357712044909096, 0.3292280606283238, 0.3076197267435055, 0.29165049370283186, 0.2800859504252979, 0.26895399247464846]
Test losses per communication round:  [5.72166645317493, 4.62557354693954, 3.9736008967185628, 3.335373112803785, 3.1399405776988716, 2.993063925462775, 2.8715768166352063, 2.5550941223638803, 2.479113671556115, 2.4675764486921254]
Test weighted accuracies per communication round:  [0.9100150164659467, 0.9171669441994372, 0.9232997855411501, 0.9261572641286501, 0.9279613102561208, 0.9301696470019772, 0.9323296271568995, 0.9337641628529022, 0.9358367879153091, 0.9379864701795784]
Test losses per communication round for each client:  [[5.4600762  5.51582548 3.75569886 3.16925378 2.97249726 2.71050899
  2.75776788 2.53713668 2.34246329 3.11341734]
 [5.27548842 5.50248024 3.80516541 3.43882263 3.42564406 3.68812135
  3.5962625  2.49047888 2.632992   2.63400096]
 [5.15355399 4.13882315 3.66001275 3.07581075 2.98252732 2.65341814
  2.67661463 2.51903166 2.3212343  2.32308482]
 [6.20362946 4.37641244 5.18720573 4.11937472 3.2266705  3.53367439
  2.87518186 2.91989133 2.99705586 2.58444107]
 [5.01480352 3.73184705 3.31103626 3.4134105  3.72148314 3.13007656
  2.50582853 2.5548061  2.35089523 2.52456162]
 [5.11526227 4.17451669 3.31173621 3.02755076 2.80678979 2.68814903
  3.80086686 2.32240142 2.41619756 2.06546892]
 [5.70597869 4.70858076 3.90284832 3.30591972 3.12611035 2.94571149
  2.76146738 2.56775278 2.48626307 2.33185595]
 [7.97334591 4.42663306 5.82492967 3.12153282 3.03407076 2.66250402
  2.49777655 2.27710907 2.39081654 2.27740829]
 [5.4438919  5.45680255 3.58244802 3.50314927 3.16459909 2.92489767
  2.6756849  2.6700553  2.52355377 2.57576887]
 [5.87063417 4.22381405 3.39492774 3.17890618 2.93901352 2.99357761
  2.56831708 2.69227801 2.3296651  2.24575666]]
Test accuracies per communication round for each client:  [[0.90740199 0.91617905 0.92115272 0.92598011 0.92773552 0.93139263
  0.93227033 0.93622001 0.93768286 0.94060854]
 [0.91094554 0.91609012 0.9215895  0.92318609 0.92708888 0.92921767
  0.93205606 0.93276566 0.93241086 0.93471705]
 [0.91097561 0.91910569 0.9203252  0.92601626 0.92764228 0.93028455
  0.92906504 0.9304878  0.93414634 0.93414634]
 [0.90710599 0.91564113 0.92179436 0.92298531 0.92477173 0.92913855
  0.92953553 0.93092497 0.93449782 0.93469631]
 [0.90994335 0.9240086  0.9259621  0.93162727 0.92986912 0.93260402
  0.93455753 0.93768314 0.94002735 0.94276226]
 [0.90986106 0.91579126 0.92239919 0.92527957 0.92985429 0.93120976
  0.93595391 0.93663165 0.93646222 0.94171467]
 [0.90493827 0.91358025 0.92057613 0.9244856  0.92489712 0.92613169
  0.92860082 0.92942387 0.93374486 0.93683128]
 [0.90988609 0.91761595 0.9229048  0.92575264 0.92819365 0.93043124
  0.932262   0.93368592 0.93673718 0.93714402]
 [0.91489362 0.91508025 0.92683837 0.92795819 0.92814483 0.93094438
  0.93393057 0.93635685 0.93654349 0.93822322]
 [0.91528239 0.91878922 0.92912514 0.92783315 0.93152455 0.93115541
  0.93540052 0.93410853 0.93595423 0.93835364]]


Train losses per communication round:  [0.8599708549311709, 0.5974274836848823, 0.4817358420573784, 0.4145915359956226, 0.36394769856563186, 0.3311855706198111, 0.3094433713671962, 0.29008592516316767, 0.2713881651557875, 0.26740112989461473]
Test losses per communication round:  [6.201546261774713, 5.187180360264847, 4.148890642489311, 3.380204978150141, 3.170387071449659, 2.98321431708755, 2.6317055255785817, 2.712870940193534, 2.425669238340288, 2.3186698203906415]
Test weighted accuracies per communication round:  [0.9144779936597143, 0.9219962836687627, 0.9274271479241338, 0.9312183820086315, 0.9314891179681987, 0.9342157423281291, 0.9365314788502136, 0.9366559712229945, 0.9380403039371359, 0.9392057586254848]
Test losses per communication round for each client:  [[6.73955426 4.98552315 3.94518326 3.34627605 3.10796586 2.91305503
  2.61136387 2.85399078 2.33305774 2.38750746]
 [6.12987232 4.84519655 3.85401809 3.61816139 3.15694426 2.86009261
  2.67327732 2.55118603 2.44036494 2.28635614]
 [5.5137647  4.39879478 3.91829202 3.15207449 2.71483418 3.892515
  2.43474878 2.34226194 2.44424735 2.1514637 ]
 [5.98843387 4.6956068  3.82111093 3.43517618 3.12482727 2.80739394
  2.59178667 2.53343709 2.36896349 2.20341854]
 [6.4235997  5.69398767 3.98118104 3.44535846 3.62368065 2.89368665
  2.90745775 2.45326886 2.84277704 2.42218036]
 [7.20901331 4.7552205  3.90124226 3.10555542 3.0213986  3.6643063
  2.41830054 2.83449055 2.29070267 2.22986352]
 [5.5165059  5.25603551 4.64160627 3.02171454 3.46082443 2.49311001
  3.11346774 3.47894561 2.1470811  2.48227163]
 [5.8797023  4.59643975 3.61025587 3.1104427  2.85732201 2.54604009
  2.39321569 2.28832798 2.26064537 2.0754309 ]
 [6.33570953 4.93658268 5.97344244 3.64700903 3.47628179 3.01051679
  2.64044509 3.12882656 2.795922   2.85730475]
 [6.27930673 7.70841622 3.84257426 3.92028151 3.15979166 2.75142675
  2.53299181 2.66397402 2.33293068 2.0909012 ]]
Test accuracies per communication round for each client:  [[0.91417497 0.92469546 0.92764858 0.93337025 0.93318568 0.93373939
  0.93872278 0.94038391 0.94112219 0.94186047]
 [0.91341732 0.92061588 0.9270146  0.92861428 0.9330134  0.9340132
  0.93581284 0.93741252 0.93861228 0.94041192]
 [0.91720017 0.92253521 0.93000427 0.93320529 0.93512591 0.93747332
  0.93832693 0.93768673 0.93896714 0.93875373]
 [0.91831776 0.92242991 0.92766355 0.9328972  0.92990654 0.93308411
  0.93420561 0.9328972  0.93420561 0.9388785 ]
 [0.91001871 0.91665249 0.9215853  0.92685831 0.92634802 0.92838918
  0.93111073 0.93230141 0.93485287 0.93332199]
 [0.91186923 0.92288557 0.92874911 0.93105899 0.92803838 0.93230277
  0.9362118  0.9340796  0.93656716 0.93638948]
 [0.91650854 0.92392617 0.92892876 0.93479386 0.93617388 0.9373814
  0.94134897 0.94186648 0.94462653 0.94393652]
 [0.91975737 0.92426343 0.93206239 0.93604853 0.93743501 0.9389948
  0.93986135 0.9407279  0.94107452 0.94194107]
 [0.90400154 0.91342824 0.92035398 0.924394   0.92574067 0.93247403
  0.93343594 0.93228165 0.93343594 0.93459023]
 [0.91736164 0.9262699  0.92835481 0.9293025  0.92873389 0.93347233
  0.93517817 0.93574678 0.93593632 0.94067475]]


Train losses per communication round:  [0.7909164290754529, 0.5574135932888435, 0.4542281878319846, 0.3834189671848675, 0.34192368481269975, 0.31808152816069324, 0.2993674608719222, 0.2811473704770598, 0.27153534528430767, 0.2597907171798938]
Test losses per communication round:  [6.091820146945247, 5.224971305334657, 3.4989020523578604, 3.3253245124418753, 2.8891217678402428, 2.6758204811960242, 2.4950842088533136, 2.8744639920132613, 2.6159369028284347, 2.5209631993551738]
Test weighted accuracies per communication round:  [0.9138846872875838, 0.9236191233680355, 0.9281079066891176, 0.9315370536893369, 0.9328838883548528, 0.9347520984140514, 0.9363934113224978, 0.9377099722488034, 0.9334569385103171, 0.9407895294125233]
Test losses per communication round for each client:  [[5.09447619 4.06677496 3.39538316 2.97088841 2.76909393 2.61247656
  2.36920589 2.29752602 2.69518618 2.1537627 ]
 [5.42142517 4.08419835 3.3906003  2.78210253 2.67078456 2.4553105
  2.40114342 2.26659232 2.35502416 4.13516065]
 [7.99000546 8.195869   3.65857641 3.2338844  3.21611963 2.82744795
  2.53837825 2.43176296 3.36450116 2.47499456]
 [5.56486243 3.94365776 3.30223206 4.08960626 2.54400279 2.39997719
  2.31571086 2.13137363 2.22440783 2.46298647]
 [5.81114248 7.08541527 3.6383003  3.10362764 2.85846475 2.98148434
  2.5361726  3.36532944 2.62169646 2.4418015 ]
 [7.70338386 6.01790059 3.63764094 3.8280862  2.96411179 2.63368086
  2.62438382 3.50664517 2.55758061 2.25317377]
 [5.697367   5.58517829 3.57374218 2.82341301 2.6399117  2.55468833
  2.67114711 2.53544655 2.33461191 2.40389845]
 [5.43113291 4.23946007 3.49452831 3.16081029 2.86929244 2.58198693
  2.53552871 2.68721302 2.5403202  2.31151117]
 [5.7937139  3.6768125  3.05471663 2.7467703  3.13268304 2.78768961
  2.25232107 3.23723303 2.48566999 1.94472905]
 [6.41069207 5.35444626 3.84330022 4.51405609 3.22675304 2.92346254
  2.70685035 4.28551778 2.98037052 2.62761368]]
Test accuracies per communication round for each client:  [[0.91571709 0.92298625 0.93143418 0.93418468 0.93339882 0.93497053
  0.93929273 0.93909627 0.92691552 0.94047151]
 [0.91475603 0.92298648 0.92670978 0.9345483  0.93376445 0.93631197
  0.93533216 0.93768372 0.93552812 0.9404272 ]
 [0.91203336 0.92037331 0.92275616 0.92772041 0.92950755 0.93268467
  0.93606037 0.94082605 0.93109611 0.94042891]
 [0.91519731 0.92653233 0.93115029 0.934089   0.93639798 0.93744752
  0.93849706 0.94206549 0.93723762 0.94584383]
 [0.91534756 0.92532691 0.92653131 0.92997247 0.93324157 0.93134893
  0.93289745 0.93479009 0.93100482 0.940468  ]
 [0.91307359 0.92398268 0.92796537 0.92969697 0.93177489 0.93679654
  0.9369697  0.93731602 0.93419913 0.9395671 ]
 [0.90865794 0.91988433 0.92685831 0.93009015 0.93128083 0.9328117
  0.9329818  0.9329818  0.93587345 0.93757442]
 [0.91900035 0.92484934 0.92857143 0.93016661 0.93282524 0.9360156
  0.93796526 0.93654732 0.93282524 0.93991492]
 [0.91739295 0.92876089 0.933687   0.93728685 0.93690792 0.93842365
  0.94069723 0.9408867  0.94012884 0.94505495]
 [0.90841188 0.92103859 0.9258403  0.9288636  0.93046417 0.93153121
  0.93402099 0.93633292 0.93046417 0.93917837]]

# federated with dirchlet 100.0
Train losses per communication round:  [0.7878802315361253, 0.5370971928810028, 0.43543650752420004, 0.3883550530857776, 0.348000090260031, 0.3185233161647589, 0.30470491390365717, 0.29068716074091727, 0.2719538566533345, 0.26484125374978995]
Test losses per communication round:  [6.427480035944481, 5.760149740290398, 3.5440745556763433, 3.300637702634276, 2.8698778562014917, 2.6709989893421153, 2.6350600584900574, 3.2224954647554114, 2.448372853988258, 2.627786892223958]
Test weighted accuracies per communication round:  [0.9056164377207376, 0.9198729911049627, 0.9231474100545289, 0.9270634454083092, 0.9289486040706267, 0.9317337588690613, 0.9330938048338747, 0.9347749528089984, 0.9372351116544538, 0.9344828516686091]
Test losses per communication round for each client:  [[ 5.54277922  7.39392495  3.50406309  4.20903228  2.9091689   2.7600638
   2.64317433  2.59836267  2.40051169  2.41865165]
 [ 6.28567669  3.99697     3.57250533  3.1279911   2.76388106  2.76722556
   2.55486579  2.33218521  2.1167222   2.87166695]
 [ 5.71305854  5.71470082  3.4673756   3.19274698  2.70343617  2.46311424
   2.55143899  2.16571842  2.3370102   2.16833846]
 [ 5.57465196  4.28524649  3.50646365  3.25576361  2.92155716  2.68188187
   3.56460999  2.71300524  3.15413868  2.41843687]
 [ 5.97750733  5.871775    3.70457454  3.28738081  2.92742445  2.69131023
   2.50822604  2.54559138  2.41153122  2.65711735]
 [ 5.93015902  5.77683762  3.54252217  3.09012341  2.79880901  2.58281466
   2.47954645  7.04075223  2.5078204   2.38811623]
 [11.37092105  4.04055196  3.64366663  3.17796919  2.86876959  2.74966054
   2.55460559  2.42814867  2.32761291  2.35203567]
 [ 6.37749618  4.51266822  3.69354659  3.34013571  3.10066305  2.77768185
   2.62867603  5.69685006  2.48576917  2.42338277]
 [ 5.85003429 11.99720165  3.55700313  3.43174626  2.96216201  2.64946382
   2.47701292  2.47137434  2.47291465  4.39613982]
 [ 5.65251609  4.0116207   3.24902484  2.89348768  2.74290716  2.58677332
   2.38844446  2.23296641  2.26969741  2.18398315]]
Test accuracies per communication round for each client:  [[0.90763732 0.92419112 0.92456734 0.92475546 0.92626035 0.92908202
  0.92757713 0.93021068 0.93453725 0.93322047]
 [0.91503997 0.92303402 0.92693809 0.93270125 0.93548987 0.93790667
  0.93902212 0.93902212 0.94404164 0.93827849]
 [0.90341782 0.92223502 0.92895545 0.93241167 0.93701997 0.93778802
  0.93759601 0.94124424 0.94393241 0.9406682 ]
 [0.90520274 0.9181633  0.92205147 0.92427328 0.92593964 0.93149417
  0.93334568 0.93556749 0.93760415 0.93149417]
 [0.90228311 0.91671233 0.91853881 0.92383562 0.92621005 0.92712329
  0.93077626 0.93150685 0.93607306 0.93388128]
 [0.90003622 0.91633466 0.92068091 0.92810576 0.92846795 0.93245201
  0.93390076 0.93716045 0.93915248 0.93480623]
 [0.90595437 0.92357633 0.92301985 0.9280282  0.93062512 0.93303654
  0.93285105 0.93489149 0.93600445 0.93340753]
 [0.90495706 0.91451991 0.91881343 0.92193599 0.92017955 0.92525371
  0.92798595 0.92818111 0.92915691 0.92935207]
 [0.90789953 0.92009465 0.92373498 0.92519112 0.92810339 0.93192574
  0.93356389 0.93283582 0.93392792 0.93247179]
 [0.9028461  0.91953619 0.92392832 0.92937456 0.93113141 0.93113141
  0.93429375 0.93728039 0.93780745 0.93728039]]


Train losses per communication round:  [0.81297554690032, 0.5563791491713486, 0.460751294518906, 0.4002032332000556, 0.36389765446376326, 0.32694843218617486, 0.3152618542839091, 0.29633417132908596, 0.2842853380591281, 0.2712878296045145]
Test losses per communication round:  [6.020840066545498, 4.734483236901087, 3.9748979217568037, 3.3041441420915363, 3.104992058010609, 2.83346417327657, 2.5938269232027773, 5.686794389391435, 2.4819873281300486, 2.2531228091545925]
Test weighted accuracies per communication round:  [0.9109793372150116, 0.9210589117727611, 0.9266294083366854, 0.9288374206198584, 0.9327595547537078, 0.9340078339988546, 0.9372868930267151, 0.9382084228641431, 0.940161807347355, 0.941692051656458]
Test losses per communication round for each client:  [[ 5.66152771  4.17529137  3.47966454  3.26781345  2.87198064  2.64089244
   2.45676533  2.29020357  2.49561886  2.08832778]
 [ 5.45260286  4.05893761  3.26733187  2.95739125  2.64377134  2.48485298
   2.31420721  2.25566263  2.17250608  2.05653606]
 [ 5.61650854  4.73584303  4.06471035  3.34594459  2.92087885  2.97545317
   2.6115978   2.45786074  2.30624839  2.19152014]
 [ 7.59132606  6.65268961  4.80641794  3.60761218  3.17814321  2.93388169
   2.86985046  2.5662066   2.98766963  2.4151772 ]
 [ 6.79242507  4.48393611  5.56213143  3.42893882  3.76334986  3.04050119
   2.62393864  2.48267374  2.68048637  2.36479377]
 [ 5.35056397  4.18209046  3.52046971  3.10679793  2.69229425  2.53851019
   2.25282182  2.30038548  2.10872061  2.06138173]
 [ 5.89122284  4.35086587  3.65970293  3.39446813  3.00709116  2.88184981
   2.52776985 34.28631411  2.43330765  2.31343901]
 [ 6.20284916  4.73158555  4.00816861  3.3947516   4.10092863  3.08640245
   3.07990414  2.6768339   3.29460505  2.4426766 ]
 [ 5.93507022  5.3945002   3.59290999  3.43602444  3.01459979  2.65272878
   2.47781511  2.43434704  2.16935363  2.20590648]
 [ 5.71430423  4.57909256  3.78747185  3.10169902  2.85688284  3.09956902
   2.72359888  3.11745608  2.17135701  2.39146933]]
Test accuracies per communication round for each client:  [[0.91275674 0.92688901 0.9317882  0.92933861 0.93649896 0.93989071
  0.94158658 0.9429056  0.94460147 0.94347089]
 [0.91167608 0.92297552 0.93032015 0.93314501 0.93653484 0.93672316
  0.9393597  0.93879473 0.94011299 0.94218456]
 [0.9155663  0.92691092 0.93156035 0.92932862 0.93583783 0.93583783
  0.94030128 0.94271899 0.94457876 0.94550865]
 [0.90734659 0.91702679 0.92290406 0.92722558 0.9315471  0.9306828
  0.93137424 0.93362143 0.93500432 0.93759723]
 [0.91193554 0.91811879 0.92430204 0.92598838 0.92992318 0.92917369
  0.93385797 0.93442009 0.93516957 0.9376054 ]
 [0.91248606 0.91973244 0.92660721 0.93069491 0.93515422 0.93794129
  0.94184318 0.93979933 0.94481605 0.94295801]
 [0.90779485 0.9166821  0.92223662 0.92501389 0.92816145 0.93093872
  0.93149417 0.93260507 0.93371598 0.9381596 ]
 [0.90892296 0.91982265 0.92499538 0.92905967 0.93053759 0.93090708
  0.93718825 0.9392204  0.93977462 0.94383891]
 [0.91365979 0.92120766 0.92433726 0.92801915 0.93078056 0.93298969
  0.93630339 0.93703976 0.94035346 0.94090574]
 [0.90720669 0.92070736 0.92679217 0.93040502 0.93230652 0.93477847
  0.93915193 0.94048298 0.94295493 0.94428599]]


Train losses per communication round:  [0.8464076926730225, 0.5826269977416807, 0.4704252872787543, 0.40987063941207846, 0.3671415999492038, 0.33516406231111134, 0.31426207693776065, 0.2962903273205381, 0.2838480538643214, 0.27115784553467515]
Test losses per communication round:  [6.486155788496211, 4.466766960136463, 4.660391608042119, 3.37952382637894, 3.3147775300961713, 2.971092835825948, 2.600991148736921, 3.0744995370480863, 2.4459719389540595, 2.3749060956433823]
Test weighted accuracies per communication round:  [0.9092197439083138, 0.9193191239242592, 0.925172052945733, 0.928991890317001, 0.9290592773892159, 0.9338820683120916, 0.936355830988154, 0.9386320289926485, 0.9394035883253931, 0.9404455410222962]
Test losses per communication round for each client:  [[5.64561248 4.38632167 3.61051469 3.21043466 2.97831497 2.61420401
  2.5473865  2.43185423 2.34838866 2.23617897]
 [8.78145468 3.94308414 7.34886654 3.05724215 2.63895356 2.36943314
  2.31646258 3.26638487 2.48236167 2.04411045]
 [5.78970472 4.48005704 6.68304831 3.46810046 3.23912143 2.76395445
  2.61259681 2.70026468 2.45520853 2.22158598]
 [6.17107287 4.21297405 3.68754893 3.20714832 3.06191633 2.9122068
  2.43655292 2.36310857 2.37455898 2.23180599]
 [6.87053549 4.97983453 4.04275855 3.27363971 2.91324139 2.58935014
  3.04486386 2.38223592 2.40861419 2.22471564]
 [7.04086438 4.67274529 3.94283585 3.48455089 5.65932457 2.97065493
  2.75683311 2.70060201 2.46861638 2.39078615]
 [6.12546802 4.54975713 5.63206971 4.02828357 3.22869042 2.91525325
  2.60695454 2.59331881 2.76480833 2.78503585]
 [5.37312863 4.01590742 3.41595908 2.9763804  3.10429004 3.37088563
  2.41352134 2.29955285 2.27218806 2.95593089]
 [6.60064694 4.57768099 4.14230642 3.52348426 3.1458029  4.40748768
  2.68628138 2.67743815 2.46350025 2.25856439]
 [6.46306967 4.84930736 4.09800801 3.56597385 3.1781197  2.79749833
  2.58845843 7.33023529 2.42147434 2.40034664]]
Test accuracies per communication round for each client:  [[0.91083852 0.91999268 0.92658367 0.92878067 0.9262175  0.9328085
  0.93610399 0.93720249 0.93958257 0.94049799]
 [0.91097869 0.92072951 0.92795233 0.93138317 0.9342723  0.93914771
  0.93986999 0.94203684 0.94257855 0.94420368]
 [0.91279178 0.9210084  0.92829132 0.92829132 0.92829132 0.9340803
  0.9363212  0.9372549  0.93800187 0.94117647]
 [0.90677205 0.91934615 0.92724987 0.92850728 0.93012394 0.93174061
  0.93623136 0.9376684  0.94054248 0.94054248]
 [0.91142234 0.92124409 0.9268825  0.92961077 0.93397599 0.93797745
  0.93743179 0.94325209 0.94234267 0.94307021]
 [0.9085736  0.91824734 0.9207132  0.92450683 0.9227997  0.92943854
  0.93304249 0.93342185 0.93247344 0.9339909 ]
 [0.90446812 0.91661993 0.92353711 0.92802393 0.92578052 0.93138904
  0.9330716  0.93793232 0.93718452 0.93774537]
 [0.9117591  0.92224128 0.92757766 0.93367639 0.93291405 0.93825043
  0.94072804 0.94301506 0.94320564 0.94301506]
 [0.9113488  0.92113851 0.92367658 0.9291153  0.92875272 0.93201595
  0.93419144 0.9350979  0.93872371 0.93999275]
 [0.9034801  0.91290137 0.91943857 0.92828302 0.92770621 0.93212844
  0.93674293 0.93943472 0.93962699 0.94039608]]


Train losses per communication round:  [0.8469968626417883, 0.6065320397224524, 0.49310168775149477, 0.43174087831530256, 0.3818140164288711, 0.35367950935606024, 0.333070220094697, 0.3163181052745907, 0.30292911314687626, 0.2926732367363565]
Test losses per communication round:  [8.041823409936478, 7.1246735769791485, 4.814740383444405, 4.0172048148558925, 3.5691068063018294, 3.0590105441602646, 2.9348686796496617, 2.6893166021442085, 2.621192414010145, 2.5122375118779017]
Test weighted accuracies per communication round:  [0.892164700341078, 0.8890250363349812, 0.920132300561574, 0.9235214833441511, 0.925602374298331, 0.9283631800149956, 0.9303650873590131, 0.9306495467421966, 0.9319458432719, 0.9337873297992493]
Test losses per communication round for each client:  [[ 7.28862631  8.16675234  6.81349963  3.54382416  4.32926624  3.79183251
   2.86644352  3.44270004  3.82958141  2.3482517 ]
 [20.9378103   7.20872421  4.28063226  3.61218306  3.31261989  3.0978391
   2.84961647  2.8102641   2.60098676  2.61410594]
 [ 6.32063851  6.44128039  6.01803485  3.54724544  3.56186274  2.90991587
   3.36338213  2.59953682  2.42879408  2.79822665]
 [ 8.80962074  6.78080517  3.97853183  4.90379271  3.17696539  3.21178496
   3.40925023  2.6033434   2.59539266  2.36872811]
 [ 6.43849906  6.86166519  5.00144318  3.463397    3.26667571  2.89767882
   2.65843949  2.76520647  2.48992775  2.36973473]
 [ 6.22953519  6.93844619  3.94301878  3.44293556  4.16125043  2.85156224
   2.65577766  2.4859217   2.42756507  2.3231707 ]
 [ 5.82083334  6.74434958  3.87905399  3.39338465  3.0005859   2.75058587
   2.81250024  2.52048672  2.38994025  2.38217044]
 [ 6.44030504  7.86143354  4.04613625  6.60225475  3.14766634  3.38853201
   2.91778786  2.80655923  2.64042965  2.50274315]
 [ 6.18708375  6.78648998  3.71712892  3.3043844   3.69254118  2.88245386
   3.13000606  2.38913403  2.42194739  2.9160345 ]
 [ 5.94528186  7.4567892   6.46992415  4.35864642  4.04163425  2.8079202
   2.68548314  2.47001351  2.38735913  2.49920918]]
Test accuracies per communication round for each client:  [[0.88979666 0.88961511 0.92011619 0.92538126 0.9248366  0.92755991
  0.93173566 0.93010167 0.93191721 0.93627451]
 [0.88320089 0.88708187 0.91591203 0.91960821 0.92311957 0.92348919
  0.92866383 0.92829422 0.93032711 0.93236001]
 [0.89998027 0.89366739 0.9191162  0.92404814 0.92838824 0.93095285
  0.93213652 0.93292563 0.93509568 0.93410929]
 [0.88888889 0.88640398 0.9142705  0.9199503  0.92048278 0.92350018
  0.92758253 0.92829251 0.92598509 0.92935747]
 [0.88714499 0.88359492 0.91704036 0.91984305 0.91890882 0.92376682
  0.92675635 0.92320628 0.92675635 0.92899851]
 [0.89240862 0.89165886 0.92146204 0.92746017 0.92783505 0.93045923
  0.9289597  0.93064667 0.93252109 0.93345829]
 [0.89893914 0.88777219 0.92480923 0.92555369 0.92704262 0.93020659
  0.93337056 0.93299832 0.93448725 0.93485948]
 [0.8876648  0.88423334 0.91872855 0.9216182  0.92486906 0.92523027
  0.92848113 0.92775871 0.92866173 0.93082897]
 [0.89443488 0.89615605 0.92713712 0.92694588 0.9330656  0.9340218
  0.93325684 0.93650794 0.93784662 0.940524  ]
 [0.89899172 0.88980915 0.92257832 0.92473893 0.92707958 0.93446165
  0.93266115 0.935722   0.935722   0.93716241]]


Train losses per communication round:  [0.8025913763455513, 0.5751936960355686, 0.4694753416367992, 0.40157963629548454, 0.35847853707968136, 0.3274727341939026, 0.3073801722324957, 0.2977282928220707, 0.2765336860949857, 0.26729102021642426]
Test losses per communication round:  [6.507682015177261, 5.404936220248781, 4.130056713586422, 3.369702250045475, 3.8604706170672216, 2.949789711325059, 2.632778977480484, 2.453278111937834, 2.7082416042569095, 2.473879451106768]
Test weighted accuracies per communication round:  [0.9151519974009813, 0.9243845182354432, 0.9282725443282618, 0.9314627630893784, 0.9333738278784945, 0.9351463596641381, 0.9364825416407427, 0.937217482966189, 0.9384193988224775, 0.9398008145652307]
Test losses per communication round for each client:  [[5.33205654 4.01195161 3.33207766 3.60630898 2.67985632 2.73805504
  2.40026145 2.26544414 2.18534708 2.42399354]
 [5.58447815 4.44978207 7.29069799 3.3003743  2.85348128 4.15601549
  2.94016449 2.41761875 2.35610268 2.23280012]
 [9.97181901 6.36114949 3.40963345 3.03567996 2.62239574 2.54341164
  2.28990823 2.23912068 2.1541485  2.21598066]
 [7.28948784 7.02050667 3.92264876 3.36939239 4.45550799 2.88220271
  2.79585373 2.46196482 3.76356916 2.22151205]
 [6.06905258 5.51485407 3.9063244  3.51872437 3.13103631 2.97801527
  2.67387403 2.70506215 2.43314536 2.28991052]
 [5.88557173 5.18358406 3.46602006 3.18732718 3.81369425 2.58853244
  2.57132787 2.33262173 2.35891839 2.21634083]
 [6.04978821 4.55035546 3.79568422 3.11761947 7.09059031 2.70357522
  2.63525258 2.42428358 2.29698403 2.14862504]
 [6.57446647 6.37824202 4.54350714 3.50266722 3.06094595 2.77430849
  2.64951923 2.46238922 3.70931739 2.31165827]
 [6.44021869 5.00876656 3.99164969 3.68406602 4.9559637  2.95153391
  2.79443653 2.63687293 3.51451913 3.66903627]
 [5.87988093 5.57017019 3.64232377 3.3748626  3.94123432 3.18224691
  2.57719162 2.58740312 2.31036432 3.00893721]]
Test accuracies per communication round for each client:  [[0.91919192 0.93022821 0.93509166 0.93527871 0.93771044 0.93845866
  0.94051627 0.94276094 0.94388328 0.94388328]
 [0.91436837 0.92246866 0.92478303 0.93018322 0.931919   0.93442623
  0.93346191 0.93558341 0.93616201 0.93712633]
 [0.91852801 0.92823142 0.93299158 0.93500549 0.93866715 0.93903332
  0.94159648 0.94324423 0.9436104  0.94434273]
 [0.91634582 0.92562128 0.93017151 0.93489674 0.93559678 0.93647182
  0.93874694 0.93857193 0.93979699 0.94224711]
 [0.91081323 0.92100089 0.92171582 0.92546917 0.92654155 0.92815013
  0.92957998 0.93100983 0.93243968 0.93476318]
 [0.91185928 0.92112729 0.92717988 0.93153017 0.9320976  0.93455646
  0.93550218 0.93663703 0.93550218 0.93663703]
 [0.91530945 0.92417662 0.92870069 0.93268187 0.93268187 0.93376764
  0.93557727 0.93503438 0.9388346  0.94245385]
 [0.9172974  0.92523537 0.93040428 0.93501938 0.93668082 0.93760384
  0.94203434 0.94000369 0.94277275 0.94092671]
 [0.91134485 0.91998497 0.92392938 0.92430503 0.92993989 0.93144252
  0.93238167 0.93181818 0.93332081 0.93613824]
 [0.91666667 0.92599068 0.92812743 0.93045843 0.93220668 0.93803419
  0.93570319 0.93783994 0.93803419 0.93978244]]


# no-pretraining

# federated baseline IID with no pre-training
Train losses per communication round:  [2.000821020934709, 1.6797458921311168, 1.3440883710363205, 1.057930491132849, 0.8485904755500646, 0.7153304785313691, 0.6184724132954722, 0.5479875625105651, 0.4933993608200338, 0.4553450728243096]
Test losses per communication round:  [18.272324645519255, 15.210202229022979, 11.84951148033142, 9.078197544813156, 7.244285726547242, 6.194594311714172, 5.3389579474926, 4.721706745028496, 4.212054562568665, 3.917761504650116]
Test weighted accuracies per communication round:  [0.43203703703703705, 0.5446851851851853, 0.6563518518518519, 0.7464074074074074, 0.7991666666666667, 0.8246666666666668, 0.8468703703703704, 0.8638888888888889, 0.877425925925926, 0.8852962962962964]
Test losses per communication round for each client:  [[18.33170223 15.34196711 11.92107248  9.14099437  7.27710068  6.17972857
   5.28055227  4.70629641  4.20512009  3.93556595]
 [18.23442614 15.09617901 11.78058422  9.07929313  7.27397805  6.2318486
   5.34877354  4.77323642  4.27634519  3.92041707]
 [18.18817019 15.10691118 11.7281307   9.02430755  7.19560254  6.17300063
   5.40055886  4.70102724  4.24303767  3.94781369]
 [18.21603048 15.2425549  11.8675853   9.09767693  7.26461816  6.2092067
   5.35645062  4.6923832   4.21721098  3.86265379]
 [18.30822194 15.16442847 11.77134824  8.98527288  7.17108476  6.03893894
   5.24636233  4.61511195  4.04647085  3.81294829]
 [18.32509565 15.25314176 11.93362367  9.17961007  7.28274632  6.2242406
   5.3474822   4.72129837  4.24154869  4.0063017 ]
 [18.30368626 15.29319596 11.94673061  9.11668879  7.30997336  6.27676994
   5.46448123  4.83341038  4.31194237  3.94935963]
 [18.28713524 15.22807658 11.88748276  9.11070508  7.29441613  6.23018348
   5.38368431  4.7337904   4.24030229  3.95833492]
 [18.20668888 15.13439226 11.86330235  9.03731382  7.19806093  6.22866893
   5.34664035  4.77843148  4.14900139  3.90776443]
 [18.32208943 15.24117506 11.79525447  9.01011282  7.17527634  6.15335673
   5.21459377  4.6620816   4.18956611  3.87645558]]
Test accuracies per communication round for each client:  [[0.42796296 0.53648148 0.65425926 0.74259259 0.79777778 0.82592593
  0.85037037 0.86592593 0.87759259 0.88722222]
 [0.4362963  0.5537037  0.66111111 0.74814815 0.79851852 0.81925926
  0.84185185 0.85981481 0.87296296 0.88055556]
 [0.42666667 0.55037037 0.66314815 0.74592593 0.79777778 0.8237037
  0.84351852 0.8612963  0.87722222 0.8837037 ]
 [0.44314815 0.54518519 0.65851852 0.74777778 0.80074074 0.82444444
  0.84611111 0.86611111 0.87814815 0.88888889]
 [0.43055556 0.5387037  0.65222222 0.74759259 0.80148148 0.82888889
  0.85240741 0.86777778 0.8837037  0.89055556]
 [0.43648148 0.54574074 0.6487037  0.74555556 0.80314815 0.82703704
  0.84851852 0.8637037  0.8762963  0.88166667]
 [0.42462963 0.54166667 0.65222222 0.74444444 0.79314815 0.82018519
  0.84092593 0.85925926 0.87574074 0.88592593]
 [0.42518519 0.53907407 0.65166667 0.7387037  0.79222222 0.82092593
  0.84444444 0.86444444 0.87388889 0.88648148]
 [0.44037037 0.54611111 0.65425926 0.75037037 0.79944444 0.8262963
  0.85111111 0.86648148 0.88222222 0.88259259]
 [0.42907407 0.54981481 0.66740741 0.75296296 0.80740741 0.83
  0.84944444 0.86407407 0.87648148 0.88537037]]


Train losses per communication round:  [2.0271209100647085, 1.7825585251729161, 1.5129536375138888, 1.220306863939974, 0.99829595187712, 0.8340119403583058, 0.7184353297807761, 0.623863399870826, 0.5536713962503792, 0.4973575584943125]
Test losses per communication round:  [20.31986302137375, 16.56837091445923, 13.337509763240813, 10.583079355955125, 9.298100692033767, 8.214743328094482, 7.56074104309082, 5.446359670162201, 5.473731675744057, 4.613973954319954]
Test weighted accuracies per communication round:  [0.26833333333333337, 0.47851851851851857, 0.5987407407407408, 0.6944259259259259, 0.732, 0.7626111111111112, 0.7732592592592593, 0.8410370370370371, 0.8397962962962964, 0.8652222222222223]
Test losses per communication round for each client:  [[20.31536484 16.67474473 13.45957208 10.7517314   9.46374941  8.32075578
   7.64816821  5.5420354   5.5618096   4.69334722]
 [20.26589048 16.51537335 13.30793452 10.5361194   9.22723871  8.11928928
   7.53683001  5.4080137   5.49265379  4.60178787]
 [20.21413314 16.35090303 13.21511102 10.41336882  9.21206832  8.15939307
   7.49030989  5.32569078  5.34643054  4.57839337]
 [20.30401587 16.4558953  13.18326092 10.49983013  9.20175183  8.13459998
   7.46092981  5.2969144   5.38087195  4.44161338]
 [20.31148815 16.6081928  13.33029485 10.6996755   9.47007042  8.38763267
   7.75417918  5.61013079  5.63224256  4.78645843]
 [20.37296319 16.57105768 13.20619071 10.41273534  8.99101764  7.97020912
   7.32594645  5.22733092  5.26899806  4.40172121]
 [20.3144877  16.61265194 13.38028347 10.5133698   9.29302275  8.19306719
   7.49354464  5.47841191  5.40119004  4.61247054]
 [20.38453746 16.68950438 13.45340657 10.68783212  9.40301645  8.33589202
   7.62049061  5.55424908  5.52227652  4.64855   ]
 [20.45505011 16.72083902 13.53814185 10.78862238  9.50541401  8.39863837
   7.76162368  5.61486614  5.66056865  4.78723046]
 [20.26069927 16.4845469  13.30090165 10.52750868  9.21365738  8.12795579
   7.51538795  5.40595359  5.47027504  4.58816707]]
Test accuracies per communication round for each client:  [[0.26833333 0.47055556 0.58722222 0.68259259 0.72574074 0.76
  0.77444444 0.83944444 0.83685185 0.86148148]
 [0.27351852 0.48703704 0.60240741 0.70277778 0.7387037  0.77092593
  0.77944444 0.84092593 0.84018519 0.8662963 ]
 [0.27666667 0.49018519 0.61574074 0.69759259 0.73814815 0.76574074
  0.77425926 0.84481481 0.84462963 0.86277778]
 [0.26611111 0.49018519 0.61555556 0.69962963 0.74092593 0.77018519
  0.77444444 0.84777778 0.84518519 0.87518519]
 [0.26759259 0.47462963 0.59592593 0.68407407 0.71962963 0.75148148
  0.76481481 0.8337037  0.83740741 0.85888889]
 [0.26611111 0.48388889 0.60481481 0.7062963  0.74537037 0.76796296
  0.77907407 0.85037037 0.84740741 0.87481481]
 [0.2687037  0.48055556 0.59907407 0.70481481 0.73407407 0.76388889
  0.77462963 0.83981481 0.83907407 0.865     ]
 [0.26796296 0.46388889 0.58203704 0.68851852 0.72796296 0.75722222
  0.77703704 0.84       0.8362963  0.86851852]
 [0.26203704 0.46907407 0.59185185 0.68685185 0.7187037  0.75722222
  0.76222222 0.83166667 0.83185185 0.85685185]
 [0.2662963  0.47518519 0.59277778 0.69111111 0.73074074 0.76148148
  0.77222222 0.84185185 0.83907407 0.86240741]]


Train losses per communication round:  [1.9979421576099283, 1.6524670429483674, 1.3248623023371724, 1.0686830645129526, 0.884590836512972, 0.7554911724649942, 0.6585513794871829, 0.5835700061282463, 0.5227067726339109, 0.4777867143058918]
Test losses per communication round:  [18.12669448852539, 14.735313677787781, 11.456008100509644, 9.741081517934798, 7.653908514976502, 6.928944975137711, 5.73294106721878, 5.010953089594841, 4.527069193124771, 4.086603066325187]
Test weighted accuracies per communication round:  [0.4258148148148148, 0.5496851851851852, 0.6641851851851852, 0.7052962962962963, 0.774462962962963, 0.7926851851851853, 0.8292407407407408, 0.8517962962962964, 0.8650740740740741, 0.8782962962962964]
Test losses per communication round for each client:  [[18.12151754 14.80276942 11.59163642  9.87792099  7.74798775  7.01633966
   5.79054171  5.05600649  4.60472965  4.14682788]
 [18.14734602 14.68110657 11.4061662   9.63796753  7.57629859  6.87911344
   5.6137895   4.92881703  4.43897271  4.05474138]
 [18.10888243 14.75005758 11.44209385  9.67964023  7.57411438  6.80432045
   5.62285239  4.91980481  4.44385764  4.0127424 ]
 [18.1954689  14.81110716 11.5909003   9.88772708  7.90227991  7.11508328
   5.98824     5.24960497  4.66862994  4.2423265 ]
 [18.23675108 14.89291441 11.58469594  9.93192893  7.85055768  7.0560388
   5.97900987  5.19512004  4.6812458   4.22303748]
 [18.17776954 14.82536387 11.50419462  9.76606226  7.62680995  6.93667382
   5.7321499   5.05184388  4.53629357  4.14444274]
 [18.04357696 14.55207109 11.34955943  9.67601758  7.59405303  6.93453747
   5.67404002  5.02016512  4.55225125  4.13489935]
 [18.09434915 14.68974626 11.44951451  9.63598132  7.59501791  6.90969497
   5.64912516  4.87964126  4.47880164  4.02049193]
 [18.13734698 14.70303237 11.35028517  9.64041889  7.51264656  6.77512729
   5.59553909  4.80887341  4.30662918  3.80780631]
 [18.00393629 14.64496803 11.29103458  9.67715037  7.55931938  6.86252058
   5.68412304  4.99965388  4.55928054  4.0787147 ]]
Test accuracies per communication round for each client:  [[0.43       0.54407407 0.65814815 0.69740741 0.76296296 0.78925926
  0.82796296 0.85111111 0.8637037  0.87777778]
 [0.42666667 0.54574074 0.66259259 0.71259259 0.77833333 0.79407407
  0.83333333 0.85462963 0.86777778 0.88037037]
 [0.4262963  0.55333333 0.66092593 0.705      0.77833333 0.8037037
  0.83703704 0.8587037  0.86777778 0.88185185]
 [0.42333333 0.54203704 0.65518519 0.70055556 0.77       0.78925926
  0.82351852 0.84462963 0.86333333 0.87425926]
 [0.41555556 0.54962963 0.65944444 0.69574074 0.76851852 0.78388889
  0.81740741 0.84537037 0.86037037 0.87166667]
 [0.42222222 0.54185185 0.66277778 0.7037037  0.7762963  0.79462963
  0.82777778 0.84722222 0.865      0.87388889]
 [0.43166667 0.55888889 0.67055556 0.71074074 0.77462963 0.79037037
  0.8287037  0.84685185 0.86351852 0.87648148]
 [0.425      0.55259259 0.66518519 0.71       0.77537037 0.79166667
  0.83185185 0.85888889 0.86574074 0.88407407]
 [0.4262963  0.55962963 0.67796296 0.71388889 0.78166667 0.79796296
  0.83407407 0.86037037 0.87314815 0.88611111]
 [0.43111111 0.54907407 0.66907407 0.70333333 0.77851852 0.79203704
  0.83074074 0.85018519 0.86037037 0.87648148]]



Train losses per communication round:  [2.0281658651913412, 1.7941890689395588, 1.5504030951028747, 1.2995783468851676, 1.0516495557226373, 0.8746480911264758, 0.7558206285421665, 0.6657925200268362, 0.6022826429743033, 0.547202943609311]
Test losses per communication round:  [19.404961502552034, 16.62090117931366, 14.00622717142105, 11.477436065673828, 9.197188216447831, 7.6918837308883665, 6.562239354848861, 5.861004799604416, 5.2240498691797255, 4.818452599644661]
Test weighted accuracies per communication round:  [0.3511666666666667, 0.4658703703703704, 0.5630000000000001, 0.6597407407407407, 0.7291296296296297, 0.7714444444444445, 0.8050555555555556, 0.8241666666666667, 0.8425, 0.855388888888889]
Test losses per communication round for each client:  [[19.53513443 16.69622004 13.97854233 11.41672385  9.20566672  7.76764315
   6.5547896   5.79768342  5.18119824  4.77833244]
 [19.36490977 16.59380841 14.04693282 11.54040265  9.29333377  7.82312334
   6.64828616  6.02735889  5.29638651  4.92074335]
 [19.39423239 16.62307823 14.01996136 11.55811214  9.29742557  7.78034961
   6.67551506  5.94378853  5.35428327  4.94987452]
 [19.51165402 16.76025724 14.18332326 11.62449634  9.35624331  7.76227719
   6.71993107  6.0151366   5.30986312  4.83363992]
 [19.5227803  16.7427727  14.09319127 11.56936121  9.22644824  7.71264482
   6.54287112  5.88398486  5.17088094  4.8557359 ]
 [19.34466612 16.49776018 13.94825482 11.32482588  9.08634931  7.5494917
   6.4878816   5.81721795  5.2378197   4.83069393]
 [19.36791635 16.58224213 14.05305731 11.50236225  9.20159733  7.68672031
   6.58263892  5.85437411  5.16474172  4.85542277]
 [19.31734443 16.46944034 13.85800517 11.32146907  8.94946146  7.49853921
   6.39980388  5.69611412  5.10613474  4.68617082]
 [19.37177014 16.59255302 13.80229938 11.34053588  9.10539609  7.55077529
   6.43016976  5.71077448  5.17214143  4.70693362]
 [19.31920707 16.6508795  14.078704   11.57607138  9.24996036  7.78727269
   6.58050638  5.86361504  5.247049    4.76697874]]
Test accuracies per communication round for each client:  [[0.34907407 0.46537037 0.56537037 0.66518519 0.7337037  0.77314815
  0.81074074 0.82722222 0.84703704 0.85685185]
 [0.34722222 0.45833333 0.55185185 0.65388889 0.72722222 0.76518519
  0.79703704 0.81611111 0.83666667 0.85018519]
 [0.34962963 0.46351852 0.56166667 0.6612963  0.72888889 0.77055556
  0.80759259 0.82759259 0.84259259 0.85240741]
 [0.3487037  0.45777778 0.55240741 0.65148148 0.71888889 0.76425926
  0.79611111 0.81425926 0.83666667 0.85425926]
 [0.34462963 0.46777778 0.56111111 0.66       0.7287037  0.77481481
  0.80814815 0.82796296 0.84555556 0.85555556]
 [0.35074074 0.4712963  0.56462963 0.66111111 0.72555556 0.77277778
  0.80314815 0.82277778 0.84055556 0.85148148]
 [0.35407407 0.46203704 0.55722222 0.65351852 0.72685185 0.7712963
  0.80444444 0.82296296 0.84518519 0.85351852]
 [0.36166667 0.48166667 0.57425926 0.66259259 0.73425926 0.77740741
  0.80981481 0.83018519 0.85018519 0.86481481]
 [0.35574074 0.46981481 0.57925926 0.67222222 0.73444444 0.77407407
  0.80703704 0.82611111 0.83907407 0.85648148]
 [0.35018519 0.46111111 0.56222222 0.65611111 0.73277778 0.77092593
  0.80648148 0.82648148 0.84148148 0.85833333]]


Train losses per communication round:  [1.9977596524904466, 1.7394348734934653, 1.49459723094864, 1.2347067891140662, 0.9998646540754645, 0.8196692472731574, 0.6898242667405563, 0.599978960486206, 0.5336588510394802, 0.4835310158512648]
Test losses per communication round:  [20.155393385887145, 17.622741401195526, 13.518291425704955, 10.890844452381135, 8.650769555568695, 7.194077450037002, 6.2678517639637, 5.624522802233696, 4.836344146728516, 4.379342788457871]
Test weighted accuracies per communication round:  [0.27901851851851855, 0.40720370370370373, 0.5800925925925926, 0.674537037037037, 0.7544259259259259, 0.7937962962962963, 0.8199814814814815, 0.8327037037037037, 0.8585555555555556, 0.8700000000000001]
Test losses per communication round for each client:  [[20.09578395 17.57360315 13.53319967 10.96498978  8.68081915  7.30866116
   6.3241443   5.74762583  4.99670228  4.51202857]
 [19.99247968 17.5567677  13.41163301 10.88987601  8.67177045  7.19146484
   6.2442444   5.6274218   4.83615357  4.37853262]
 [20.26586282 17.58773291 13.51016092 10.77819955  8.56721616  7.07645369
   6.20541972  5.46527737  4.75202498  4.27385741]
 [19.9253962  17.46787763 13.49958646 10.90944195  8.64350843  7.18042636
   6.20959616  5.58870783  4.72456115  4.32191059]
 [20.26202297 17.68552399 13.59234703 10.77700853  8.57880086  7.08212918
   6.16908461  5.53912729  4.75237668  4.29686934]
 [20.12461889 17.62082446 13.59288526 10.98138297  8.74685234  7.29213375
   6.43042761  5.66459394  4.91986629  4.42235395]
 [20.44585609 17.85528743 13.57716775 10.88282979  8.70738751  7.28879625
   6.33996755  5.74348217  4.94054452  4.50416088]
 [20.11817706 17.57963443 13.49148178 10.89106035  8.6519171   7.16572255
   6.23513347  5.56773573  4.86618218  4.33161908]
 [20.11967421 17.55851567 13.42735744 10.89107168  8.60992467  7.15436745
   6.2502448   5.63752532  4.76696229  4.37967798]
 [20.20406199 17.74164665 13.54709494 10.94258392  8.64949888  7.20061928
   6.27025503  5.66373074  4.80806753  4.37241745]]
Test accuracies per communication round for each client:  [[0.28092593 0.41092593 0.58203704 0.67481481 0.75333333 0.79148148
  0.82037037 0.83111111 0.85685185 0.86740741]
 [0.28555556 0.40333333 0.58851852 0.67074074 0.75703704 0.8
  0.82333333 0.8312963  0.86166667 0.8712963 ]
 [0.2712963  0.40425926 0.57796296 0.67851852 0.75092593 0.7937037
  0.82222222 0.84166667 0.85759259 0.87222222]
 [0.29574074 0.41425926 0.58092593 0.67574074 0.7512963  0.79388889
  0.81722222 0.83240741 0.86074074 0.87259259]
 [0.27444444 0.40592593 0.5737037  0.67222222 0.75833333 0.79314815
  0.82611111 0.83333333 0.86407407 0.87518519]
 [0.27907407 0.40611111 0.56574074 0.66537037 0.74777778 0.78574074
  0.80740741 0.83018519 0.85111111 0.86833333]
 [0.26277778 0.40148148 0.58074074 0.67962963 0.75259259 0.78722222
  0.81759259 0.82740741 0.85685185 0.86185185]
 [0.28111111 0.41092593 0.58592593 0.68555556 0.75722222 0.79703704
  0.82685185 0.83722222 0.85777778 0.8737037 ]
 [0.28259259 0.41481481 0.59018519 0.67703704 0.76074074 0.80055556
  0.81703704 0.83166667 0.86037037 0.86740741]
 [0.27666667 0.4        0.57518519 0.66574074 0.755      0.79518519
  0.82166667 0.83074074 0.85851852 0.87      ]]


# federated baseline non-IID 100.0 with no pre-training
Train losses per communication round:  [2.011819041587792, 1.6761021928534177, 1.3583062926617162, 1.090038094235536, 0.897399326292792, 0.7511485702548029, 0.6503181626698031, 0.5720285794900037, 0.5101426806161709, 0.46169185162414905]
Test losses per communication round:  [20.131632602214815, 16.695092618465424, 12.774670308828354, 10.256730100512504, 10.24270703792572, 7.312051180005073, 10.258909123390913, 5.22585965692997, 5.010840714722872, 6.001186429942027]
Test weighted accuracies per communication round:  [0.4013659951984868, 0.47481185753874655, 0.6221949536759206, 0.7294683355170394, 0.6959397937609173, 0.8077896100968507, 0.6498175957518231, 0.856231853383414, 0.8668852538850648, 0.823112362510509]
Test losses per communication round for each client:  [[21.15335047 16.56429148 12.46675372 10.58994532  9.89733198  8.91219795
   9.80492871  5.46362793  4.59023533  5.73163181]
 [18.42923415 15.54281747 11.91309202  9.51401401  9.85433513  6.71519387
   9.98460996  4.965996    4.62278417  5.82324713]
 [21.0398258  16.85108018 13.17835259 10.71186042 10.7701236   7.87711424
  10.6499154   5.11176932  5.58436477  6.25253105]
 [18.55495501 15.6022948  11.8879956   9.59445482  9.80862224  6.73574144
   9.87946528  4.99441224  4.68496057  5.80898494]
 [20.86703861 17.84334803 13.60222554 10.90459317 11.28065681  7.97772849
  10.46155962  5.53592995  5.63368112  5.99976821]
 [20.5739702  17.24788153 13.4634937  10.61577785 10.54925728  7.41409713
  11.41359764  5.38982552  5.00401521  6.21522489]
 [20.58464658 17.05492568 12.76774943 10.64677727  9.56025571  6.85657617
   9.93457177  5.53109914  4.75331476  6.00996245]
 [20.33214796 16.82559478 13.39985061  9.8879405   9.97966334  7.05063596
  10.36571103  5.12634364  5.8328639   6.18626493]
 [18.68168163 15.73938692 12.04576194  9.72985566  9.88327402  6.65472311
   9.85866612  4.92150781  4.62422964  5.81726366]
 [21.09947562 17.67930532 13.02142793 10.372082   10.84355026  6.92650345
  10.23606569  5.21808502  4.77795768  6.16698521]]
Test accuracies per communication round for each client:  [[0.40465821 0.48040144 0.62355614 0.73319447 0.70270782 0.81291422
  0.65555766 0.85798144 0.86839614 0.82711608]
 [0.4052356  0.47452007 0.62862129 0.73630017 0.68708551 0.80383944
  0.64415358 0.85200698 0.86300175 0.82582897]
 [0.40049001 0.47191858 0.62438749 0.73746702 0.69770072 0.81360724
  0.64134942 0.8629853  0.87353939 0.82340746]
 [0.39670139 0.48142361 0.625      0.72638889 0.68888889 0.80659722
  0.65555556 0.85486111 0.8640625  0.82430556]
 [0.40782659 0.47995396 0.61998849 0.72568579 0.69518511 0.79992327
  0.6453098  0.84634567 0.8615001  0.82006522]
 [0.41105385 0.46987738 0.61222676 0.7222321  0.69681891 0.80095966
  0.6431491  0.85427404 0.86973521 0.83010485]
 [0.40011637 0.47692009 0.63013964 0.72672614 0.7098526  0.81574864
  0.66330489 0.85841738 0.86986036 0.81671839]
 [0.40045079 0.47614576 0.62490609 0.73610068 0.69778362 0.80897821
  0.64706987 0.8566867  0.86344853 0.81949662]
 [0.3891182  0.46228893 0.61726079 0.71932458 0.68724203 0.81275797
  0.65290807 0.86022514 0.86679174 0.82138837]
 [0.39817975 0.47345468 0.6149033  0.73151308 0.69510808 0.80147895
  0.64789534 0.85836177 0.86841107 0.82271521]]


Train losses per communication round:  [1.9782198200812382, 1.5647102608302885, 1.2231574109908863, 0.9565265452741223, 0.7838794744819109, 0.6634297564764007, 0.5825108880002134, 0.5208660381458154, 0.4858664503936764, 0.45126717384263715]
Test losses per communication round:  [18.981989228725432, 14.902736163139343, 19.84410543143749, 13.575414299219847, 11.193350958824158, 6.545484824106097, 9.285897248238324, 4.7465766243636605, 15.040663397312164, 8.7652522649616]
Test weighted accuracies per communication round:  [0.4999835817762182, 0.6255836529023655, 0.3444618816685307, 0.5815286467007272, 0.6633688217843946, 0.8394276853764987, 0.7385070880607056, 0.8723885033706119, 0.5622023034146869, 0.7407961488148369]
Test losses per communication round for each client:  [[19.33861136 14.98016429 21.58378148 13.86016989 11.53449684  6.59087539
   8.9991321   5.32732439 15.74246466  8.91452062]
 [18.56105173 16.49975467 18.479453   14.75608659 10.96897179  6.64877248
  11.59205258  4.51680186 14.75324798  7.7366426 ]
 [19.46695518 15.40420282 20.12279558 15.23014367 11.16589332  6.50102049
   9.03873277  4.75348388 14.71158636  8.48938349]
 [18.85837579 14.75002396 19.71548271 13.30477357 11.85245895  6.41878867
   8.42616105  4.56842201 14.07199043  8.22770232]
 [19.4789021  14.85738695 19.14457731 12.95355251 10.6929034   5.91380478
   9.60254198  4.90518755 15.81501603  9.81853491]
 [18.97838354 14.49776149 20.73763025 14.228297   11.89545751  6.39066041
  10.13900334  4.79506889 14.45712322  8.69347322]
 [19.60118604 14.99842894 20.37093377 13.24862665 11.55118412  6.4162364
   9.10897368  4.75862125 15.42523766  8.92965734]
 [17.40085268 13.53155279 18.77467918 12.42769456 10.26552409  5.87534863
   8.08215648  4.57513666 13.90846241  8.05823022]
 [19.16430783 14.27759814 20.98861217 13.18194151 10.50974673  6.63829434
   9.63392663  4.64985383 15.95423841  9.14474148]
 [18.97126603 15.23048759 18.52310885 12.56285705 11.49687284  8.06104666
   8.23629188  4.61586593 15.56726682  9.63963646]]
Test accuracies per communication round for each client:  [[0.49284291 0.61532886 0.33810473 0.56368907 0.654104   0.83457148
  0.7312919  0.8668237  0.55009966 0.73111071]
 [0.51307002 0.63632894 0.37569166 0.58443045 0.66227819 0.84182408
  0.74279718 0.87597787 0.57450868 0.74833047]
 [0.49018487 0.61311225 0.34133791 0.57575758 0.65446922 0.83095102
  0.72879741 0.86430341 0.56222603 0.73584906]
 [0.49488055 0.62590064 0.34945013 0.57584376 0.65946151 0.84319302
  0.73871824 0.87409936 0.56541524 0.74459613]
 [0.50412778 0.62221823 0.33740129 0.58452979 0.66654702 0.83811917
  0.73348887 0.86916726 0.56083991 0.74084709]
 [0.51415183 0.63861293 0.33045923 0.58875351 0.66916589 0.84067479
  0.74039363 0.87703843 0.5769447  0.74882849]
 [0.48146747 0.6121407  0.34209531 0.5815053  0.66679274 0.8417171
  0.74829803 0.87689107 0.5484115  0.73997731]
 [0.49926335 0.62615101 0.34677716 0.58103131 0.66058932 0.83572744
  0.73480663 0.86961326 0.5611418  0.73186004]
 [0.50438436 0.63207892 0.32426014 0.59901352 0.67409573 0.84015345
  0.74936061 0.87504567 0.54767994 0.73492875]
 [0.50524818 0.63458459 0.35936666 0.58156912 0.66696317 0.84806974
  0.73830279 0.8756449  0.57427504 0.75182352]]


Train losses per communication round:  [1.9507341835411331, 1.5666285101766007, 1.2710890556197816, 1.038191770531916, 0.868671152211369, 0.7514100160867417, 0.6446191493209933, 0.5719719714975784, 0.5183349500057604, 0.47448314923379414]
Test losses per communication round:  [20.20327912569046, 15.191411995887757, 15.307446026802063, 10.101217520236968, 9.090224793553352, 14.42560663819313, 6.403945509344339, 5.81050835698843, 5.049402561783791, 4.64332779198885]
Test weighted accuracies per communication round:  [0.3842879332168665, 0.5935907201501357, 0.5451291351862784, 0.7355798427689151, 0.7504642360031465, 0.555226291368204, 0.830571809043308, 0.848767289968816, 0.8663592967606075, 0.8760684901797401]
Test losses per communication round for each client:  [[20.08765233 15.18542206 15.33894086 10.05707794  9.50935137 14.51740348
   5.94943844  5.67029008  5.08819705  5.6990872 ]
 [20.65628946 15.22256386 14.94863605 10.24584275  9.38892514 14.41715479
   6.46082002  5.61970404  4.86207801  4.41672885]
 [20.93784797 14.99714053 15.42370057  9.87490368  9.08456492 14.23854816
   5.77994027  5.7865454   5.12142664  4.54379842]
 [20.57616019 15.66006804 15.47211504 10.35223049  9.43707198 15.20917654
   6.629116    6.46765152  5.1134333   4.90573183]
 [18.27013075 13.71529496 13.49499762  9.08657014  8.44496387 13.84872603
   5.79604709  5.11582452  4.55600423  4.19227239]
 [20.66749775 15.44666529 15.44334781 10.33395433  8.52392712 14.01574081
   6.86040598  5.30486457  4.74011889  4.37281601]
 [20.03064442 15.04184639 15.06405616  9.80709064  9.25621653 15.1606077
   5.95172897  5.88359162  5.10324079  4.33236632]
 [20.48790085 16.31737959 17.6027596  10.72374654  9.18334579 13.94381678
   7.4826985   6.10832635  5.47772723  4.64140004]
 [19.78877449 15.30330205 15.07176006 10.58650655  8.98424405 14.57560194
   6.2966885   5.8089093   4.84444857  5.00971884]
 [20.52989304 15.02443719 15.21414649  9.94425213  9.08963716 14.32929015
   6.83257133  6.33937618  5.5873509   4.31935802]]
Test accuracies per communication round for each client:  [[0.38027397 0.59105023 0.53954338 0.73589041 0.74246575 0.5596347
  0.83141553 0.84803653 0.86739726 0.87196347]
 [0.37168641 0.59541267 0.54126716 0.73604061 0.75051701 0.55555556
  0.82947923 0.84865576 0.86896033 0.87948863]
 [0.39032685 0.59644814 0.54260344 0.73398829 0.75174759 0.55431702
  0.83279804 0.8437559  0.87020593 0.87662951]
 [0.3718432  0.57500942 0.53222767 0.71899736 0.73803242 0.53562005
  0.82227667 0.84263098 0.85657746 0.8707124 ]
 [0.39462572 0.59865643 0.55278311 0.7378119  0.75259117 0.55239923
  0.83262956 0.85335893 0.86794626 0.87869482]
 [0.38833461 0.59286262 0.55046048 0.74136608 0.75613968 0.53818112
  0.83231005 0.84535687 0.86166539 0.87356101]
 [0.38865036 0.59678925 0.54806795 0.74108643 0.75844689 0.5549748
  0.83442225 0.85458279 0.87399664 0.87866343]
 [0.39386919 0.59864552 0.55212975 0.74389592 0.7570843  0.56246658
  0.83532347 0.85332383 0.87025486 0.87863126]
 [0.39361145 0.59224996 0.54791412 0.73258858 0.74707628 0.57828591
  0.83260604 0.8518066  0.86507244 0.87659277]
 [0.37037712 0.59992713 0.54545455 0.73547094 0.75150301 0.56166879
  0.82291856 0.84678448 0.86190563 0.87593369]]


Train losses per communication round:  [1.981672882224735, 1.719990270327282, 1.415875593555303, 1.1465039093193077, 0.9427196372947424, 0.7919805165205343, 0.6802562225193155, 0.5942514436604818, 0.5318388768250978, 0.4814324993730777]
Test losses per communication round:  [22.10618234872818, 20.70374319255352, 13.475175808370114, 11.193442341685294, 9.06516407430172, 7.849955709278584, 7.1242113903164865, 5.551983449235559, 5.105943100340665, 4.919744933024049]
Test weighted accuracies per communication round:  [0.2484911930454668, 0.32857405510755266, 0.6217051090286891, 0.7051294149691455, 0.7536941595520151, 0.7862822655988382, 0.8003808180738989, 0.8451091080640335, 0.8607383734021516, 0.8607899806216516]
Test losses per communication round for each client:  [[22.88255858 19.19230792 13.03913283 10.45951357  9.62195563  7.82915789
   6.9414987   5.15557841  5.79806605  5.37119606]
 [22.53977227 20.84922516 13.98285997 11.66898328  9.62801164  7.64082381
   7.19574052  5.69053605  4.85806361  4.84745076]
 [22.46654117 20.36345303 12.82180272 11.93084496  9.11374134  7.5209171
   7.3207069   5.62548488  4.8676549   5.83936393]
 [22.41323245 20.82436097 13.78277111 10.68387699  9.12895674  7.63082889
   7.40403235  5.67590371  5.50032884  5.0438889 ]
 [22.44170392 21.80696929 13.79162979 11.19507819  9.14881846  7.95660448
   6.71019866  6.23639125  5.03873248  4.79729761]
 [22.04570746 21.69183946 13.54671359 10.6640473   8.71412644  9.31621075
   7.10304582  5.43325135  5.87086442  4.77410874]
 [21.78132188 21.22162318 13.32462466 11.78684825  9.27953047  7.57519391
   7.00617743  5.53123528  4.76521228  4.60733847]
 [22.14299655 21.10875905 13.25503933 11.87596232  8.53334025  7.5826323
   8.0193997   5.13805219  4.65617536  4.60570963]
 [20.11964524 19.11618304 12.45095766 10.0742951   8.38916141  6.9569059
   6.59374237  5.02862471  4.62922531  4.55474809]
 [22.22834396 20.86271083 14.75622642 11.59497344  9.09399837  8.49028206
   6.94757146  6.00477666  5.07510775  4.75634715]]
Test accuracies per communication round for each client:  [[0.24533986 0.33534174 0.62944831 0.7128601  0.75578987 0.78892864
  0.80474487 0.84861608 0.86556204 0.87026925]
 [0.24335082 0.32440745 0.62095169 0.69875158 0.74633617 0.78197937
  0.79772028 0.84259092 0.86466437 0.85778904]
 [0.23610861 0.31810825 0.60852365 0.6966373  0.74968531 0.78582989
  0.79230354 0.84067614 0.85614098 0.85380327]
 [0.24963557 0.32999271 0.62044461 0.70900146 0.75491983 0.78043003
  0.80047376 0.83600583 0.85240525 0.85495627]
 [0.23972603 0.31229174 0.60496113 0.6960385  0.74509441 0.77656424
  0.7950759  0.84209552 0.85653462 0.85931137]
 [0.2391463  0.31758482 0.62385991 0.70448741 0.75300985 0.78547975
  0.80828165 0.84512951 0.86318862 0.86428311]
 [0.2690678  0.34514638 0.64541602 0.71590909 0.76367488 0.79429892
  0.8029661  0.84842065 0.86132512 0.86113251]
 [0.26290447 0.34476117 0.63058552 0.71456086 0.76309707 0.79969183
  0.80893683 0.85381356 0.8651772  0.86286595]
 [0.25574074 0.32981481 0.62444444 0.71111111 0.75962963 0.79148148
  0.79666667 0.84925926 0.86092593 0.86055556]
 [0.244265   0.32868416 0.60818499 0.69168655 0.74545788 0.77812443
  0.79665994 0.84455863 0.86162599 0.86272711]]


Train losses per communication round:  [2.0351442212105675, 1.6847429839103385, 1.3558040519900516, 1.0795524772230407, 0.8774588361509258, 0.7367928925541862, 0.6280706347631339, 0.5476610554307233, 0.4859579216575419, 0.43781605780670885]
Test losses per communication round:  [20.183886790275572, 16.522799527645113, 13.392970198392868, 9.998740704357624, 8.412467467784882, 7.566886106878519, 6.1472534943372015, 5.142486316710711, 4.701507282629609, 3.9897445693612097]
Test weighted accuracies per communication round:  [0.4295129955194139, 0.562247504281394, 0.6368508153160473, 0.7352474927598398, 0.7879302624751167, 0.7895326606903791, 0.8253525381804467, 0.8650434565865268, 0.8665597017821421, 0.8883000490422486]
Test losses per communication round for each client:  [[20.51838279 16.71038008 13.58098316 10.55445212  8.56764185  7.36010289
   6.13107097  5.16332364  4.58402848  4.31294331]
 [18.42840052 14.94585562 12.16953778  8.87860602  7.40014303  6.50503767
   5.47030067  4.50206545  4.20557293  3.62276357]
 [20.56435156 16.62795031 13.03045708 10.16137648  8.29090792  7.06382421
   6.15260038  4.71736372  4.54348827  3.74550833]
 [20.55114424 16.39939165 13.95418334 10.06803948  8.2634179   7.64761698
   6.11694892  5.28701943  4.64641501  4.06006823]
 [20.09548283 16.26563251 13.03727961 10.29024065 10.0843097   7.35138655
   6.50272241  5.28482342  5.21704146  4.35341346]
 [20.51797163 17.22573435 13.42958343  9.36044578  8.17824048  7.74668688
   5.8914418   5.43158823  4.55681292  3.84921254]
 [19.59296119 16.9642278  13.50161374  9.7303237   8.07013738  7.91034323
   6.03648272  5.52160579  4.63381371  4.03453889]
 [20.63231993 16.73919809 13.93792224 10.76701778  8.72911733  8.11268365
   6.58320034  5.23681578  4.68062509  4.14964771]
 [20.41657209 16.59119534 13.88642383 10.27294368  8.40424031  7.57871991
   6.3295365   5.16213694  5.12240621  3.86016485]
 [20.52128112 16.75842953 13.40171778  9.90396136  8.13651878  8.39245909
   6.25823024  5.11812076  4.82486874  3.90918478]]
Test accuracies per communication round for each client:  [[0.43765658 0.56022355 0.63923685 0.73867797 0.78936211 0.78627867
  0.82713432 0.86683369 0.86895356 0.89073039]
 [0.43735849 0.57150943 0.64528302 0.75622642 0.80301887 0.8054717
  0.84301887 0.87301887 0.87603774 0.89037736]
 [0.43188826 0.5584981  0.64066751 0.73154362 0.79140214 0.79140214
  0.82677308 0.86903682 0.87066933 0.89406857]
 [0.42919047 0.5550522  0.63777822 0.7331101  0.78589718 0.79318495
  0.82863896 0.8662596  0.8627142  0.88694111]
 [0.43042071 0.56742179 0.634484   0.7290543  0.77741819 0.77795757
  0.81859044 0.85472851 0.86084142 0.87918015]
 [0.43080486 0.56745802 0.63945184 0.73827446 0.78845783 0.79077398
  0.82628836 0.86218877 0.86315383 0.88708743]
 [0.42742349 0.56488289 0.63754488 0.72952641 0.78868183 0.78902376
  0.82082407 0.86835356 0.86903744 0.89314413]
 [0.41742222 0.55484444 0.62862222 0.72888889 0.77902222 0.78097778
  0.81404444 0.85617778 0.86133333 0.88693333]
 [0.42299678 0.55824967 0.63383217 0.73385111 0.78518659 0.78897518
  0.82364084 0.86588369 0.86645198 0.88558439]
 [0.42886104 0.56431994 0.63140435 0.73387394 0.79100627 0.79211205
  0.82491707 0.86804276 0.86656837 0.88868411]]



# federated baseline non-IID 10.0 with no pre-training
Train losses per communication round:  [1.9905428481798313, 1.7515049948608588, 1.5093976000005211, 1.2694229487462074, 1.0443856951571577, 0.8740198063633675, 0.7433681548989118, 0.6542355717307561, 0.5663559346263172, 0.5002148695705131]
Test losses per communication round:  [22.156473839282988, 19.978382563591005, 15.883579438924789, 13.234440624713898, 11.215153098106384, 9.461538845300675, 7.663314968347549, 11.079947900772094, 5.542846087180078, 4.913013952225446]
Test weighted accuracies per communication round:  [0.29325003897914537, 0.3205276016153249, 0.538555164777617, 0.6164876756313858, 0.7048747649619491, 0.72318559170122, 0.7970031660977034, 0.6726832271519523, 0.8567284399211118, 0.8677512391927956]
Test losses per communication round for each client:  [[20.9648689  18.09189177 15.23389769 12.18175095 10.15019464  8.95123208
   7.70416838 10.74720961  5.03309773  4.48749345]
 [23.53890586 21.94195008 16.39800924 15.21716511 12.07055885 11.16290867
   8.85295898 12.61722559  5.58471268  5.76052353]
 [22.7708056  19.49622297 16.43358934 13.75851941 11.54428047  9.00907576
   8.14666462 11.22379202  6.26502165  4.76257738]
 [22.31994808 20.33363903 16.0606972  13.22419184 11.34230179  9.20355415
   7.84429085 11.50945866  5.54585034  4.62755345]
 [20.99298167 19.17899501 15.00309134 12.15103495 10.83442932  9.18771374
   6.90651929  9.97118586  5.48602751  4.86588457]
 [21.99322665 20.12749231 16.54121923 13.90856981 11.1537714  10.24852312
   7.84789854 11.93396842  5.80045876  5.128948  ]
 [21.75893199 18.49676549 15.07735682 12.58616483 11.55258441  9.75362372
   7.01458776  9.59069109  4.85387891  4.56072016]
 [22.62371206 21.00440836 16.16001809 13.83631682 10.87721801  8.97060966
   7.56023514 10.97285616  5.21548975  5.40591046]
 [22.26725912 20.08967328 15.94179416 12.95655513 11.63681298  9.23847979
   7.12571567 11.55932534  5.74059698  4.80060667]
 [22.33409846 21.02278733 15.9861213  12.52413738 10.98937911  8.88966775
   7.63011044 10.67376626  5.90332657  4.72992185]]
Test accuracies per communication round for each client:  [[0.34241305 0.39212065 0.57248384 0.63096337 0.72837796 0.72237612
  0.80040012 0.69082795 0.86318867 0.87242228]
 [0.25868726 0.24989275 0.5019305  0.5967396  0.68918919 0.72436722
  0.78635779 0.65293865 0.84577435 0.85263835]
 [0.28205128 0.31566952 0.53903134 0.60474834 0.7002849  0.71035138
  0.79164292 0.67160494 0.85375119 0.86837607]
 [0.26961671 0.31501892 0.52130285 0.59861819 0.70291166 0.72824478
  0.79157756 0.66935351 0.85392334 0.8660964 ]
 [0.3166971  0.37269223 0.5674579  0.64049503 0.71616961 0.73280584
  0.8119294  0.69628728 0.86630148 0.87522824]
 [0.26606426 0.30739625 0.50853414 0.57697456 0.67620482 0.70783133
  0.7834672  0.63688086 0.85056894 0.8624498 ]
 [0.34146821 0.35957489 0.57291872 0.64652627 0.72151151 0.73332021
  0.80810864 0.69494194 0.86498721 0.87581185]
 [0.2790565  0.30321476 0.53395473 0.6079513  0.70363325 0.7192315
  0.79246719 0.67567053 0.85657219 0.86684421]
 [0.28851175 0.31483899 0.55744125 0.6227154  0.70300261 0.71583986
  0.79416884 0.66144473 0.84986945 0.86118364]
 [0.30075985 0.28255876 0.52076339 0.65364905 0.71638099 0.74341756
  0.81569182 0.68952112 0.86587736 0.87842375]]


Train losses per communication round:  [1.9876170361347192, 1.6762656083062943, 1.3698965434668324, 1.1098242990580158, 0.9266145380637176, 0.7889884175275278, 0.684618284489727, 0.6084178462651919, 0.5682800050496125, 0.515929072881607]
Test losses per communication round:  [20.159921598434448, 16.936543095111848, 13.440807521343231, 11.896211063861847, 11.991190713644027, 9.868520835042, 7.218380236625672, 6.384351527690887, 9.10990397632122, 11.114861379936338]
Test weighted accuracies per communication round:  [0.41711352270404467, 0.5089267536152247, 0.6346474881146346, 0.6657805461207479, 0.6470635813990457, 0.7062081267980188, 0.8155630763760946, 0.8194135222497836, 0.7295304978763015, 0.6408016445630363]
Test losses per communication round for each client:  [[20.45974004 17.32603943 13.73325294 12.79037929 12.70000499  9.94047272
   7.19157517  6.23575005  9.5329181  11.45739186]
 [19.41182947 15.81719804 12.49151915 11.82854956 11.52962095 10.35816902
   6.35298669  6.05736858  8.53720152 10.88621008]
 [20.51653945 17.27810895 14.05367589 11.7558105  11.60031819  9.92669803
   7.09806263  6.71658558  9.3493005  10.85435826]
 [20.57942283 17.25877035 13.97428727 12.5177784  12.47731054 10.261096
   8.31606656  6.37748504  9.3658691  11.35809946]
 [19.76539767 16.75572157 13.25598896 11.90380645 11.34619915  9.47615892
   7.85397631  7.17811418  8.53352532 11.49864435]
 [20.67031634 17.81829154 13.80488968 11.73615837 11.9882561   9.54198349
   7.32992125  6.33150572  8.50108045 10.84852153]
 [19.86767519 16.81259704 13.10235667 10.49573606 11.76391625  9.29702735
   6.7599929   5.40884086  8.64490938  9.97394836]
 [20.02775729 16.04016101 13.2110461  12.69393528 11.93908602 10.00951195
   7.82569665  6.19518623  9.59700364 10.66785519]
 [20.22992849 17.390082   13.66785657 11.7002036  12.42667091 10.61826009
   6.66063771  6.82497585  9.87325811 12.67854726]
 [20.07060921 16.86846101 13.11320198 11.53975314 12.14052403  9.25583079
   6.7948865   6.51770321  9.16397363 10.92503744]]
Test accuracies per communication round for each client:  [[0.38548185 0.48018356 0.60700876 0.65289946 0.63537756 0.7077597
  0.81497705 0.82227785 0.72069253 0.63099708]
 [0.45583405 0.53241141 0.64753673 0.67294728 0.65911841 0.71668107
  0.83509075 0.82990493 0.74140017 0.6494382 ]
 [0.39441469 0.48565417 0.62834736 0.65168324 0.63676358 0.69319051
  0.80738332 0.81293037 0.74579189 0.63255547]
 [0.39185625 0.47922849 0.62528849 0.65413782 0.62462908 0.68793274
  0.80036268 0.8013518  0.70969337 0.62875041]
 [0.422723   0.52450704 0.63399061 0.66197183 0.64807512 0.69934272
  0.8142723  0.81558685 0.72037559 0.63868545]
 [0.38517566 0.48243359 0.6180377  0.66366752 0.63924593 0.71165381
  0.80634105 0.81855184 0.73500428 0.65102828]
 [0.45687694 0.55201655 0.65294726 0.71602896 0.67280248 0.74146846
  0.82812823 0.84281282 0.74994829 0.69389866]
 [0.44523931 0.53363993 0.64605689 0.66308976 0.65389201 0.70652359
  0.81417135 0.81502299 0.71657299 0.6307273 ]
 [0.41702267 0.51347355 0.65428853 0.66217548 0.64541571 0.70095301
  0.82369372 0.82205061 0.72757148 0.61912586]
 [0.4154508  0.50355406 0.63093902 0.66105499 0.65693977 0.69846614
  0.81144781 0.81518893 0.73681257 0.64010475]]

Train losses per communication round:  [1.9915395621138974, 1.6939034335175915, 1.4733967594794593, 1.2472031247345228, 1.0317810516126475, 0.8600621715571671, 0.7409425333163819, 0.6511641270022066, 0.5870126534682987, 0.5283283241713953]
Test losses per communication round:  [20.01436675786972, 17.35294234752655, 14.822695922851562, 12.12910329401493, 10.014903050661086, 8.325630167126656, 7.545362603664398, 6.306780581921339, 5.413914228230714, 4.91821715682745]
Test weighted accuracies per communication round:  [0.40883077474621526, 0.48626348896459576, 0.5841203140917425, 0.679138425052507, 0.7389980712314758, 0.785683739542982, 0.8018985525222408, 0.8307281534887803, 0.851324484823983, 0.863111288551335]
Test losses per communication round for each client:  [[20.72619283 18.18621039 15.33367097 12.63511145 10.09803486  8.46945798
   7.84282362  6.78278977  5.52210227  5.4546124 ]
 [20.69733787 18.46260679 15.14882171 12.57231236 11.07766503  8.78462273
   8.02751714  7.03188539  5.98928133  5.53190815]
 [19.40414512 17.30617917 14.55003464 12.52415788  9.61255616  8.4218486
   7.40863633  6.34556133  5.27215657  4.9976947 ]
 [20.00889766 17.34484696 14.69809651 11.65607572  9.28241938  8.33829433
   7.22490454  5.42387754  4.79997702  4.56307659]
 [20.81823325 17.73909605 14.83806682 12.18633807 10.75068158  8.22946635
   7.49201483  6.37858641  5.4880065   4.97792289]
 [19.30014968 16.33175695 14.20690119 10.97677055  8.91877711  7.89999586
   6.88027996  5.81027889  4.99823801  4.80636239]
 [20.90237904 18.1396513  15.78713405 12.90420282 10.50894874  8.93646991
   8.18722785  7.31164664  5.35979689  5.02010098]
 [17.62240791 15.30315077 12.97015023 10.45987391  8.78742969  7.28215528
   6.51493096  5.55523717  4.67449364  4.21850717]
 [20.25041902 17.20220983 15.11007142 12.57953918 10.49013817  8.49717841
   8.08099949  6.34225222  6.20093066  4.75025782]
 [20.4135052  17.51371527 15.58401167 12.79665101 10.62237978  8.39681223
   7.79429132  6.08569046  5.8341594   4.86172847]]
Test accuracies per communication round for each client:  [[0.37795902 0.45991645 0.5581858  0.65645514 0.73542869 0.77939129
  0.79868709 0.82395067 0.84642928 0.8565745 ]
 [0.37070279 0.45588484 0.56172735 0.6592718  0.70855207 0.76477561
  0.78475868 0.81558002 0.83827265 0.86113463]
 [0.43021459 0.50575107 0.60240343 0.68995708 0.74781116 0.79141631
  0.81201717 0.83639485 0.85630901 0.86712446]
 [0.41627038 0.48420516 0.58576766 0.68733016 0.76579484 0.81063179
  0.81538723 0.8580163  0.86820652 0.88060462]
 [0.42006395 0.49240608 0.59032774 0.67326139 0.73261391 0.78017586
  0.79496403 0.82334133 0.84932054 0.85631495]
 [0.47452487 0.53983017 0.6219167  0.71087748 0.77072382 0.81014962
  0.82794177 0.84411646 0.86393045 0.87040032]
 [0.37182741 0.46301668 0.5668963  0.66569978 0.72751994 0.77592458
  0.79496012 0.82342277 0.84499637 0.85532995]
 [0.43913043 0.51187291 0.60919732 0.70518395 0.75501672 0.80200669
  0.81153846 0.84113712 0.86337793 0.8735786 ]
 [0.40754232 0.48917934 0.58474395 0.68030855 0.73301907 0.76837369
  0.78551532 0.81722734 0.84058282 0.85622456]
 [0.38036225 0.46024786 0.55786463 0.66348904 0.71630124 0.77483317
  0.79351764 0.82535748 0.84156339 0.85338418]]


Train losses per communication round:  [1.96573743155217, 1.622307905981082, 1.317228807116697, 1.0411505449221696, 0.8390021577973386, 0.7013529885783945, 0.6024908156448133, 0.534876690951237, 0.4800492654767609, 0.4389335707774878]
Test losses per communication round:  [19.870310533046723, 16.079942083358766, 25.866985583305357, 9.778372991085053, 8.38949488401413, 6.49546871483326, 5.873044142127037, 5.367938883602619, 4.515556409955025, 5.396656871959567]
Test weighted accuracies per communication round:  [0.4444482597989439, 0.5647114758573504, 0.21323789903831847, 0.7374616151390914, 0.7854104410691781, 0.8216969186295442, 0.8359662903885995, 0.8467048633226593, 0.8765872282955353, 0.8363500449259539]
Test losses per communication round for each client:  [[20.52248788 16.27360725 27.05225968 10.683146    9.4859308   6.71229541
   6.38720006  5.57757968  4.42273353  5.49860351]
 [19.9671694  16.07261074 27.14282942  9.91709667  8.57718092  6.69184205
   5.99393946  5.42909797  4.58688419  5.35295531]
 [20.74704337 16.42347908 27.12637544  9.37877071  7.8198446   6.46893597
   5.624461    5.13563846  4.43317685  4.91091366]
 [19.91707003 16.05641675 27.09039521  9.54668057  8.59502941  6.79467326
   5.68617144  5.52081612  4.44987446  5.84347975]
 [19.99275041 15.9643153  27.1021812   9.29616261  8.51956534  6.35440671
   6.05835295  5.3799628   4.5174256   5.45139807]
 [16.79869092 13.62800956 21.83996129  8.32543957  7.05337608  5.62201792
   4.91691756  4.76888403  3.86969927  4.5798077 ]
 [20.7900269  16.86959493 25.19019413 10.34430265  9.00171643  6.58005539
   6.35965562  5.44343752  4.69782841  5.62356591]
 [19.81759655 16.36797988 26.87861443 10.16422224  8.34839845  6.52623245
   5.95075014  5.76321879  5.00302264  5.48668972]
 [19.55788159 16.39334261 22.96132803  9.99001557  7.76837766  6.28048211
   5.69381884  5.27562147  4.34917599  5.12456523]
 [20.59238827 16.75006473 26.28571701 10.13789332  8.72552913  6.92374587
   6.05917436  5.385132    4.82574317  6.09458986]]
Test accuracies per communication round for each client:  [[0.40171738 0.53500093 0.2449132  0.72279261 0.76610043 0.81482173
  0.83404891 0.84450252 0.87586336 0.83386224]
 [0.46015693 0.57436792 0.21081081 0.74245859 0.77925022 0.81743679
  0.83574542 0.83940715 0.86643418 0.83051439]
 [0.4462887  0.57721    0.13800821 0.74132786 0.8000746  0.8306602
  0.83979858 0.85303991 0.88418501 0.84185006]
 [0.46364477 0.56910268 0.19962997 0.73950046 0.77835338 0.82164662
  0.83385754 0.84051804 0.87437558 0.82997225]
 [0.46709276 0.58973916 0.20521679 0.7496977  0.78960097 0.82484021
  0.83658663 0.8452237  0.8752807  0.83848679]
 [0.50280702 0.60982456 0.26982456 0.77       0.8        0.83964912
  0.85298246 0.85824561 0.89       0.85614035]
 [0.41337631 0.53545528 0.18452861 0.72461724 0.78706688 0.81466559
  0.82433521 0.84206285 0.87066882 0.83460919]
 [0.45590994 0.55993329 0.21992912 0.73379195 0.77965395 0.82197207
  0.83844069 0.84198457 0.87096102 0.83427142]
 [0.43814714 0.56385104 0.23978202 0.73860127 0.80145322 0.82615804
  0.84032698 0.8595822  0.88374205 0.84196185]
 [0.4011876  0.53553535 0.22174801 0.71404713 0.77175728 0.80515866
  0.82352941 0.84134348 0.87326035 0.82130265]]


Train losses per communication round:  [1.953258415785493, 1.598826683931166, 1.279374605590603, 1.0365845417735362, 0.8626231632081446, 0.7401335045446108, 0.6475753665380447, 0.5740742386107424, 0.5171579643537745, 0.47329386061754636]
Test losses per communication round:  [19.823675632476807, 15.614925312995911, 12.574470978975295, 9.956113755702972, 8.3948427811265, 7.069723796844483, 6.018978779762984, 5.672661304473877, 5.21105786729604, 4.762292912602424]
Test weighted accuracies per communication round:  [0.44569762061037027, 0.5823347700538224, 0.6719182934511978, 0.7325264552253488, 0.7780781779658305, 0.8091160263258561, 0.8376040343877141, 0.8511433445690296, 0.8587316822058152, 0.8769725658382826]
Test losses per communication round for each client:  [[19.61450803 15.98319113 12.14366573  9.63761002  8.61647874  6.85360563
   5.95128459  6.05586067  5.25483221  4.96830153]
 [20.69787669 16.15496385 13.38493812 10.65398228  8.90168166  7.74796742
   6.40969363  6.36438257  5.12710152  4.90256894]
 [19.37381303 15.52283895 12.35502696  9.98678559  8.20511013  7.55470377
   6.07825023  5.27662748  5.61856738  4.45090315]
 [19.2497071  15.13552248 12.37606394  9.76710618  8.22132045  7.13114494
   5.64086728  5.30925855  5.05526683  4.21450171]
 [20.08872843 15.57262623 13.52618861 10.40708029  9.43625903  6.79624435
   6.15459692  5.52394331  5.97162828  4.45658593]
 [19.46171427 15.03182912 12.3765471   9.61075276  7.80172223  6.62985852
   5.50446329  6.1633043   4.67491909  6.36887044]
 [19.71480882 15.13275266 12.15028584  9.60390091  7.98955297  6.89519221
   6.29284006  5.07983875  5.07415423  4.44884863]
 [20.3323282  15.9884249  12.68324471 10.20713896  8.77240157  7.03659868
   6.12421855  5.60695019  4.74356863  4.87814692]
 [19.31843829 15.69284177 12.26929581  9.59439158  7.9025532   6.78202075
   5.71806461  5.26495177  4.81137483  4.19751845]
 [20.38483346 15.93426204 12.47945297 10.09238899  8.10134782  7.26990169
   6.31550863  6.08149546  5.77916569  4.73668343]]
Test accuracies per communication round for each client:  [[0.45338039 0.60011144 0.68387816 0.74628529 0.78826152 0.82466568
  0.84268202 0.85698366 0.85958395 0.88150074]
 [0.40723188 0.54888538 0.63419344 0.71054941 0.75566087 0.78655433
  0.82885729 0.84289977 0.85290504 0.87168685]
 [0.44402246 0.57678336 0.66116248 0.72374505 0.77691546 0.80069353
  0.8322325  0.84544254 0.8588177  0.876321  ]
 [0.45067927 0.59204568 0.68556803 0.73380587 0.78814727 0.81275842
  0.8438669  0.86237448 0.86985627 0.89052963]
 [0.44757433 0.5764867  0.67077465 0.72887324 0.77445227 0.81122848
  0.8350939  0.84722222 0.85035211 0.86737089]
 [0.47323644 0.60067352 0.68592698 0.74565757 0.7967033  0.82098547
  0.85040766 0.86565048 0.8674229  0.8888692 ]
 [0.47593261 0.60930606 0.68933012 0.74508624 0.78399519 0.81708785
  0.84095467 0.85760128 0.86341757 0.87926193]
 [0.43169842 0.57721929 0.66680178 0.72800973 0.77442238 0.80299959
  0.83563032 0.84961492 0.86704499 0.87677341]
 [0.46579625 0.59580728 0.69069511 0.75137918 0.79330636 0.81831556
  0.84332475 0.85527768 0.86263332 0.87955131]
 [0.41321586 0.55207048 0.65585903 0.71506608 0.75259912 0.79859031
  0.82484581 0.83136564 0.8384141  0.85973568]]



# federated baseline non-IID 1.0 with no pre-training
Train losses per communication round:  [1.851730528632047, 1.5113939618692138, 1.2043960478245843, 0.9689051063408576, 0.8022104663917758, 0.6929513690092591, 0.6025879267529641, 0.547684582498172, 0.49308442758716103, 0.45195307015668335]
Test losses per communication round:  [20.636809825897217, 17.179190242290495, 13.29371958822012, 10.603130450844764, 8.68950221836567, 11.877573308348655, 9.787616834044456, 7.387718369066715, 6.413467761874199, 5.332502678595484]
Test weighted accuracies per communication round:  [0.4036034497781159, 0.5019324658598083, 0.6278227731071095, 0.7323544114829547, 0.7736829643773009, 0.6172916232194475, 0.7063916725217523, 0.7857795305098663, 0.8234899661589703, 0.8564368127917297]
Test losses per communication round for each client:  [[21.66525817 18.74936879 15.03943253 12.64589745 11.28895366  9.41462833
  13.23950931  6.46542507  5.91261247  4.94390392]
 [21.77857196 19.57876551 15.71137118 10.61408025  8.68675876 15.87346649
   8.09093684  9.48187876  7.70047468  6.80141985]
 [20.90468669 17.32810748 12.1629788  10.66879851  7.91204524 11.38321252
   8.43761176  6.96052882  5.97603539  5.01890182]
 [20.96573114 18.51379347 14.99036038 12.28330082 10.453183   12.22649288
  12.84080064  7.67716658  7.99570531  7.61766511]
 [22.25365067 17.20940495 13.19082582 12.02765673  8.97389191 11.81312776
   9.24845853  6.77251381  5.7703737   4.43688954]
 [19.83338368 15.65655077 11.50562119  8.03436109  6.76265016 12.44913006
   7.16823152  7.13184416  6.01065952  4.76428804]
 [17.55825377 13.3202486  10.14216101  8.31254977  6.97927344 10.31123245
   8.38691401  7.51215309  6.13512814  4.41306877]
 [21.9065243  18.19321179 14.57043064 10.59772235  8.84442019 12.95558178
   8.87520903  7.82769984  6.94356412  5.07369302]
 [17.50266719 13.72913873  9.33324857  8.28544974  6.32539093  8.79304357
   9.58173108  5.37775461  5.05973196  3.62729539]
 [21.99937069 19.51331234 16.29076576 12.56148779 10.66845489 13.55581725
  12.0067656   8.67021894  6.63039234  6.62790132]]
Test accuracies per communication round for each client:  [[0.30373989 0.41661051 0.56704852 0.64858491 0.7041779  0.71799191
  0.58406334 0.82665094 0.85309973 0.86590296]
 [0.29017857 0.3641183  0.51729911 0.70758929 0.75334821 0.49581473
  0.76395089 0.70340402 0.79436384 0.81473214]
 [0.44047428 0.53164557 0.67104631 0.79153982 0.8174972  0.6058324
  0.74539337 0.78577151 0.82566896 0.86460503]
 [0.3152     0.3904     0.52288    0.63424    0.69376    0.61152
  0.61408    0.77504    0.78624    0.82784   ]
 [0.3596268  0.49378004 0.65012723 0.72010178 0.75756291 0.6631326
  0.71020639 0.80831213 0.84605598 0.87206672]
 [0.49531208 0.59831235 0.70466113 0.80069649 0.83270828 0.60822395
  0.76024645 0.79493705 0.82909188 0.86873828]
 [0.57721953 0.67570654 0.77390808 0.82072509 0.84984299 0.63831002
  0.74992863 0.81273194 0.82786183 0.89095061]
 [0.31066494 0.43609672 0.58095855 0.70617444 0.75237478 0.59261658
  0.71653713 0.76446459 0.82879965 0.84736615]
 [0.55905512 0.66379438 0.74506017 0.81399495 0.83865696 0.70138167
  0.75709404 0.83642847 0.85009657 0.89808349]
 [0.29730203 0.35774352 0.46075683 0.62578837 0.69131044 0.55974071
  0.62701472 0.74351787 0.80903994 0.80466013]]


Train losses per communication round:  [1.8244164008676953, 1.4762717431952637, 1.205565117163063, 1.0131063999016696, 0.8792271724408277, 0.7749904700870159, 0.6966473099377373, 0.6290165629900988, 0.5740283076781341, 0.52650361986787]
Test losses per communication round:  [20.34921556711197, 16.877101987600327, 13.44547935128212, 11.582164108753204, 9.746981889009476, 9.768661391735076, 7.716278750449419, 6.877182702720165, 6.050247782003135, 6.453266802430153]
Test weighted accuracies per communication round:  [0.4400522582534801, 0.5272042896838264, 0.6375439749501978, 0.6941198334389164, 0.73664207788593, 0.7349793210383845, 0.7980501393481428, 0.8126095481730949, 0.8379738350624844, 0.8106093804798473]
Test losses per communication round for each client:  [[18.12591612 15.35810304 12.09707034 10.32990021  8.58036095  8.32028359
   6.37792271  5.62741011  4.95822636  5.87337118]
 [22.90053558 19.83596814 16.91435373 14.12036651 13.16050541  9.56574667
   9.07111919  8.36424726  7.36815101  8.56345785]
 [19.28501713 15.50160062 12.63431621 10.11082512  8.56657767 10.36784846
   8.03534973  6.35792118  5.69309229  5.75060874]
 [21.07607973 17.24661541 13.48664713 11.39873087 10.02149719  8.5770582
   7.4798587   6.43385881  7.35462344  6.30321449]
 [21.40866983 17.29964793 13.63428056 11.69088292  9.55735826 11.36210537
   7.90563995  7.58881855  6.25117391  6.69154292]
 [18.52318072 14.43027729 11.74247795  9.98977989  8.19464421  8.73537362
   6.6434167   5.90540415  5.132339    5.71932164]
 [19.30048883 16.52520978 11.55111182 10.94557625  8.43873513  9.69810623
   6.78284807  6.41204377  5.17682587  6.61214972]
 [20.54878569 17.70480371 14.09519291 13.00329995 10.02954489 10.39464015
   8.42202741  8.16655642  6.32803202  7.03858458]
 [20.59559834 16.60044026 13.77694607 11.96355969 10.70769131  9.10629189
   8.36049873  7.22261736  6.03891963  7.20881799]
 [21.7278837  18.2683537  14.5223968  12.26871967 10.21290386 11.55915976
   8.08410633  6.69294941  6.2010943   4.77159892]]
Test accuracies per communication round for each client:  [[0.55190744 0.61913696 0.70137586 0.74984365 0.77767355 0.78674171
  0.82801751 0.84115072 0.85146967 0.83270794]
 [0.21263808 0.28151397 0.43518519 0.51315789 0.57244964 0.72904483
  0.708577   0.73050682 0.77907732 0.72222222]
 [0.49755046 0.63786008 0.72525965 0.76210073 0.78679208 0.7579855
  0.8175583  0.83264746 0.85890653 0.81971389]
 [0.42802573 0.54101327 0.63268999 0.67973462 0.71893848 0.75613189
  0.79995979 0.81966224 0.83876156 0.80960997]
 [0.40932715 0.54558224 0.6573957  0.69756988 0.74546987 0.72187105
  0.7958983  0.80530973 0.83424638 0.78985813]
 [0.56069593 0.63364966 0.72123369 0.77441677 0.8054567  0.77224199
  0.83708976 0.84559114 0.86635034 0.83392645]
 [0.50325862 0.59752027 0.70243205 0.75504689 0.79335559 0.750914
  0.817835   0.8308695  0.85979971 0.82180893]
 [0.3954615  0.4645589  0.62927078 0.67899031 0.73865375 0.70601734
  0.78556859 0.78327384 0.82967874 0.79602244]
 [0.42148421 0.50943009 0.59573596 0.64452645 0.6896269  0.75481755
  0.76732267 0.78536285 0.82205822 0.77470275]
 [0.36688578 0.41454396 0.56820049 0.66379074 0.72213092 0.61955629
  0.7975897  0.81881676 0.83018351 0.86332512]]


Train losses per communication round:  [1.8482468030998376, 1.490981155154993, 1.2036978909344627, 0.9778186864460675, 0.803709615999843, 0.6790071912215397, 0.5862886754525218, 0.518481679478241, 0.46478436084685343, 0.4289370960978035]
Test losses per communication round:  [20.716274905204774, 16.79708735346794, 12.805662544071675, 10.66736592054367, 8.688485886529088, 7.262902206555009, 6.2198941394686695, 5.495500041544437, 4.510299646109343, 4.160241728345864]
Test weighted accuracies per communication round:  [0.3840054873093407, 0.5081098612985611, 0.6389425857885068, 0.7108089206503412, 0.7737899409723958, 0.8170950807997038, 0.8433063767552916, 0.8593113471740108, 0.873645081992721, 0.8880200744272624]
Test losses per communication round for each client:  [[18.15788019 12.92967159 10.6743145   8.08827096  6.3482158   5.08457512
   4.40464728  3.92622736  3.66454877  3.66509026]
 [20.5701828  16.33203077 12.73137069 10.44480503  8.66658595  7.42862123
   6.6346733   5.6906091   4.2135547   4.03572212]
 [21.00630784 17.92461634 13.29212135 11.03904587  8.90791592  7.41096967
   7.21024901  5.96896821  4.49090999  4.24576014]
 [22.19993556 18.30053067 13.71785533 11.20447314  9.37437952  7.39235139
   6.87931538  5.56192228  4.58855695  4.23943692]
 [21.09129167 17.59035671 13.608639   10.77817547  9.87957633  8.52958453
   7.24388182  6.29313141  4.51295618  4.20916866]
 [20.65867805 17.14558506 13.4964056  10.75597429  9.11907065  7.28705674
   6.00568692  5.30130555  5.53066829  4.3682878 ]
 [19.98559475 16.41386354 12.380234   10.75936162  8.98355675  6.70208216
   5.42820232  5.9587329   4.5001663   4.33297956]
 [21.02887416 17.20962    13.75685978 11.74444509  8.99280256  7.98307657
   6.18010184  5.56565395  5.08975852  4.66810465]
 [22.44935477 18.42890334 12.20993359 11.71367443  8.09198282  7.03194034
   5.69911265  5.23505759  4.58197963  3.77269118]
 [20.01464927 15.69569552 12.18889159 10.14543331  8.52077258  7.77876431
   6.51307088  5.45339206  3.92989713  4.06517598]]
Test accuracies per communication round for each client:  [[0.53625607 0.64942354 0.75121359 0.81037621 0.8443568  0.87135922
  0.88486044 0.89381068 0.90139563 0.91049757]
 [0.38984954 0.49764204 0.65349203 0.70761285 0.76150909 0.80485066
  0.83022681 0.85156075 0.88681788 0.89714799]
 [0.33876501 0.47577187 0.64086621 0.7056175  0.77058319 0.81067753
  0.83404803 0.84262436 0.87800172 0.88357633]
 [0.29006953 0.42770547 0.58459618 0.66250669 0.73685149 0.80370833
  0.83758246 0.86521662 0.8666429  0.88946336]
 [0.33512605 0.4312605  0.59663866 0.67731092 0.73042017 0.79563025
  0.82991597 0.84806723 0.86319328 0.88403361]
 [0.38019031 0.49394464 0.61872837 0.70198962 0.76838235 0.81120242
  0.83758651 0.85315744 0.8691609  0.88451557]
 [0.42533401 0.56993066 0.6580416  0.72365973 0.8012853  0.83747675
  0.85844749 0.87349907 0.86707255 0.88685946]
 [0.40018332 0.49587534 0.60678277 0.68579285 0.74867094 0.79358387
  0.82969753 0.84656279 0.85499542 0.87442713]
 [0.28791963 0.4690027  0.6238667  0.70301397 0.7858368  0.82651311
  0.85101691 0.87233521 0.8787062  0.88997795]
 [0.43295973 0.55614363 0.67735575 0.73827314 0.78860523 0.81973848
  0.84288086 0.85460772 0.88625986 0.8920714 ]]


Train losses per communication round:  [1.8223724050995684, 1.5268075700789343, 1.2629488886064528, 1.0737310988047404, 0.9132243945549993, 0.800734762036709, 0.7097973568973442, 0.6392384331259985, 0.5834021834498319, 0.5369035123138877]
Test losses per communication round:  [20.749318981170653, 18.67009584903717, 15.138847291469574, 16.363174307346345, 12.990710544586182, 129.49718379974365, 8.08212614953518, 7.441610296815634, 6.3543277636170385, 5.580979074537754]
Test weighted accuracies per communication round:  [0.40756651652976206, 0.43468657750087963, 0.5617891157871896, 0.49491468875924494, 0.6077014961120848, 0.09292315955583404, 0.7750236287325163, 0.7854934790073602, 0.822117401383089, 0.8503543626325005]
Test losses per communication round for each client:  [[ 17.98676658  16.01325321  12.96603215  12.66321898  10.18708032
  116.0327301    6.74193266   6.05830116   5.48263007   4.47537124]
 [ 22.943434    21.5498687   18.54612041  19.32063782  15.98885691
  107.86569595  10.42012095   9.93277031   9.40367222   6.88903198]
 [ 21.72850168  21.21651912  16.56762338  20.46832371  14.34970653
  119.90112638   8.74339515   7.19989222   5.9950476    5.93406576]
 [ 22.46757269  21.32763004  16.88882971  18.55240202  14.19467747
  122.65346527   9.12738031   8.61025563   7.18651158   5.79126358]
 [ 20.41670918  17.44396269  13.30661118  15.41042316  12.18272626
  140.02881432   6.79841489   6.74087059   5.53034988   4.45039779]
 [ 17.71161926  15.05421031  12.07246017  12.80908751  10.57909983
  139.48435211   6.48439425   6.02753142   4.97530617   4.53060532]
 [ 22.18285513  20.45588696  17.1814537   17.86320472  15.45959949
   93.58124304   9.42186797   9.36003184   7.45178753   6.7723656 ]
 [ 19.95355129  17.29959595  14.07902169  14.6835686   11.23885334
  154.29144573   7.53090936   6.89731306   5.86575681   5.47597259]
 [ 21.95085287  18.44744849  15.1922853   16.19084811  12.91498601
  169.27396107   7.87633979   7.27344686   6.27052152   6.2682988 ]
 [ 20.15132713  17.89258301  14.58803523  15.67002845  12.81151927
  131.85900402   7.67650616   6.31568987   5.38169426   5.22241808]]
Test accuracies per communication round for each client:  [[0.5379454  0.55784359 0.6552522  0.63419713 0.71008792 0.03725127
  0.81582601 0.82947709 0.86210088 0.88662656]
 [0.27309694 0.29830839 0.39476252 0.37166558 0.46161353 0.41232921
  0.65696161 0.68607677 0.72836695 0.7986337 ]
 [0.39189189 0.33783784 0.50225225 0.36998362 0.57022932 0.03910729
  0.78480753 0.80200655 0.8486896  0.8544226 ]
 [0.3312058  0.36812144 0.48093842 0.42159738 0.53372434 0.17198551
  0.72986027 0.73365534 0.79092634 0.83612213]
 [0.41973187 0.46373324 0.64609832 0.53248539 0.65658302 0.01323479
  0.81763493 0.80525954 0.84874527 0.87951186]
 [0.54450626 0.58901252 0.67663421 0.6416319  0.70166898 0.03036625
  0.82939268 0.8312471  0.86114975 0.88966157]
 [0.33691756 0.4248366  0.55176049 0.47775669 0.57600675 0.08180476
  0.74383302 0.75606156 0.78030782 0.81593928]
 [0.3830156  0.41005199 0.55268631 0.50086655 0.61473137 0.05129983
  0.78024263 0.79237435 0.82426343 0.84228769]
 [0.38270662 0.44951327 0.58331743 0.51116625 0.61958389 0.02175988
  0.78831838 0.80129796 0.82782974 0.84119107]
 [0.47177941 0.45827948 0.58178946 0.50552923 0.63952319 0.06836134
  0.80726698 0.81645842 0.84877208 0.85882522]]


Train losses per communication round:  [1.795528506826733, 1.415968368469454, 1.1183802754012675, 0.9060324128672693, 0.7631493856588485, 0.6591464707610116, 0.5812262536303436, 0.5187891006393737, 0.4712795887675497, 0.4328927881597699]
Test losses per communication round:  [21.79818186759949, 21.259338521957396, 11.967727088928223, 9.663238829374313, 8.615954431891442, 6.984268352389336, 5.916851995885372, 5.170217321813107, 4.60820676535368, 4.471346932649612]
Test weighted accuracies per communication round:  [0.3142336481386512, 0.3245494536305879, 0.6742275753596232, 0.7539452509892666, 0.7772777839003755, 0.8257930059667246, 0.8446850585647709, 0.8663628299740966, 0.8806959525017681, 0.8881095919529266]
Test losses per communication round for each client:  [[22.93566632 23.50789094 12.82408887 10.19814581 10.54761958  8.19683343
   7.17135304  6.14757183  5.83608061  5.33392611]
 [22.62578726 21.78565645 12.71752763 10.19556797  9.37564695  7.32316548
   6.14056164  5.3856211   4.98880181  4.5590215 ]
 [17.51559603 15.04169852 10.12767613  8.67810929  6.62852967  6.12741369
   4.88397366  4.41843407  3.92502809  3.68109   ]
 [23.27168107 21.66778541 11.9203459  10.03981286  8.34553987  6.74640572
   5.63742128  4.73481469  3.98509459  4.07440338]
 [23.27014089 24.74535251 13.37608922 11.07623976  9.3728174   7.35507613
   6.18952708  5.60526904  5.08600962  4.36439925]
 [21.94932878 20.5453862  11.54542965  8.95683512  7.60416982  6.5560137
   5.32106802  4.64762621  4.159823    4.16454682]
 [22.66504097 23.2088697  12.47041261  9.53816539  8.94576263  7.31669259
   5.52976026  4.74919094  4.41145019  4.21208805]
 [21.08032382 18.79306036 11.74745536  9.89656359  8.72407013  7.27524209
   6.44238439  6.42610875  5.07747211  5.10622546]
 [20.87044704 21.07623661 11.17044193  8.77976781  7.56282896  5.66859213
   5.78427339  4.58404878  4.03445221  4.57504392]
 [21.7978065  22.22144854 11.7778036   9.27318069  9.05255932  7.27724856
   6.06819721  5.00348781  4.57785542  4.64272484]]
Test accuracies per communication round for each client:  [[0.25287577 0.19037577 0.61560583 0.71568252 0.73408742 0.78968558
  0.81326687 0.83646472 0.84566718 0.85832055]
 [0.3595853  0.32611859 0.67369953 0.74663514 0.76300473 0.81465988
  0.83230266 0.85740269 0.87449982 0.88013823]
 [0.49939832 0.51805054 0.73826715 0.79602888 0.81708785 0.8465704
  0.87123947 0.8856799  0.90794224 0.90914561]
 [0.30149706 0.35721054 0.70418799 0.76293348 0.80197082 0.83702861
  0.8586318  0.88042448 0.89482661 0.89785863]
 [0.19343696 0.20184226 0.59009787 0.69545193 0.72976396 0.79907887
  0.83316062 0.86102476 0.8681635  0.88704663]
 [0.29674632 0.39894694 0.70568381 0.76616714 0.80167409 0.84433644
  0.85945727 0.87889834 0.8928041  0.90346969]
 [0.26029268 0.2302439  0.65678049 0.76156098 0.77346341 0.82946341
  0.84780488 0.87219512 0.87687805 0.89190244]
 [0.34576888 0.28717015 0.65186533 0.7477707  0.75505005 0.80527753
  0.81983621 0.84040036 0.86587807 0.86642402]
 [0.28664303 0.31294326 0.68055556 0.76152482 0.79875887 0.85106383
  0.86406619 0.88238771 0.88652482 0.90159574]
 [0.22584773 0.30310301 0.66314779 0.7431222  0.76503519 0.82037748
  0.83861164 0.86308381 0.87412028 0.87859885]]


# federated baseline non-IID 0.1 with no pre-training
Train losses per communication round:  [1.5481856553155586, 1.3420134503809258, 1.1962454968550935, 1.076551710541805, 0.9790170836245953, 0.8995058058777836, 0.8243771482570468, 0.7687435580062969, 0.7238419776245971, 0.6737502902137271]
Test losses per communication round:  [23.11053248643875, 21.99311215877533, 21.700608921051025, 20.841546773910522, 19.609623730182648, 20.417977976799012, 17.931463056802748, 16.839472752809524, 19.52667172551155, 16.25219210386276]
Test weighted accuracies per communication round:  [0.20705909187662744, 0.20038160765680169, 0.21266722480626093, 0.26559136304901965, 0.3501956086571617, 0.34869554640453, 0.44211059568566724, 0.5100739408858119, 0.4122654413016215, 0.5107688161676093]
Test losses per communication round for each client:  [[19.74248362 17.54022014 16.05530393 14.39214265 12.70582187 12.69000137
  12.57934654 10.66770416 12.28469086 10.36941385]
 [21.79743183 18.08491659 17.28058136 15.88358831 14.70624137 15.37559235
  14.45593655 13.89702737 15.34340537 14.7092638 ]
 [22.91358995 21.59827912 19.52365339 17.40812862 14.78177476 13.5288552
  11.63213038 10.80408084 12.47313219 10.90223545]
 [25.71183133 25.33321834 24.89343286 24.60330844 22.30190229 24.01343107
  19.89311254 18.84496951 22.09171486 16.48478997]
 [21.80445445 20.00055921 19.14859569 19.7590524  19.44165599 19.44640005
  18.22960895 16.41515338 18.00891578 15.28036642]
 [21.45140874 19.4437288  21.03341126 20.37355614 20.7696743  21.83276415
  18.93664539 18.55452394 21.68337965 17.88467038]
 [26.41409826 26.82044983 28.11340404 27.04994154 25.82649469 27.68707252
  23.65326357 22.73447561 25.70635784 20.75491774]
 [23.92744517 24.35717511 25.67892051 25.48988056 26.67691302 31.47217917
  25.91476011 25.37607062 33.91845107 29.1559186 ]
 [26.01383519 26.36668897 26.48432446 26.44103122 24.65279531 25.01923299
  22.97141743 20.49676025 21.6821965  17.00942349]
 [21.32874632 20.38588548 18.79446173 17.01483786 14.23296368 13.1142509
  11.0484091  10.60396183 12.07447314  9.97092134]]
Test accuracies per communication round for each client:  [[0.53905442 0.53896043 0.53501269 0.57965974 0.64225961 0.64573738
  0.6560767  0.75777799 0.68126704 0.75890591]
 [0.3917493  0.47896008 0.46770913 0.5226926  0.52447241 0.42295957
  0.52536232 0.61174676 0.46586575 0.54099924]
 [0.21290944 0.14932563 0.17533719 0.27745665 0.44412331 0.49710983
  0.63680154 0.73314066 0.57032755 0.65125241]
 [0.12353923 0.15692821 0.1836394  0.22036728 0.29716194 0.25542571
  0.36894825 0.40734558 0.31886477 0.51085142]
 [0.38383838 0.3986014  0.39121989 0.41491841 0.41802642 0.4036519
  0.41258741 0.5019425  0.44988345 0.499223  ]
 [0.32599942 0.32556802 0.32111015 0.3245614  0.32355479 0.32226057
  0.32988208 0.35763589 0.36381938 0.41745758]
 [0.04527645 0.04680017 0.04592947 0.050936   0.05594253 0.050936
  0.07771006 0.10296038 0.06573792 0.16042664]
 [0.04570325 0.04280657 0.02413904 0.03057612 0.02220792 0.00901191
  0.03121983 0.0460251  0.01062118 0.01931123]
 [0.0765559  0.11162108 0.14705342 0.17954838 0.26179548 0.20965669
  0.35432348 0.40205618 0.34183954 0.54947678]
 [0.13313253 0.07650602 0.10572289 0.19006024 0.4189759  0.50240964
  0.6436747  0.71686747 0.57439759 0.70210843]]


Train losses per communication round:  [1.4274574835196958, 1.1704836836483672, 0.9784320992084348, 0.8561872861649846, 0.7691916363100507, 0.7007480173962304, 0.6417193087652009, 0.5855127548655188, 0.5526121925351404, 0.5157658512520508]
Test losses per communication round:  [23.8325932264328, 23.17699726819992, 22.504796743392944, 22.971132230758666, 21.044856011867523, 24.444682133197784, 22.02507485151291, 20.514899456501006, 20.712762033939363, 21.685023456811905]
Test weighted accuracies per communication round:  [0.2607977974378585, 0.26609195502223537, 0.27873361791481266, 0.30278641382444244, 0.3213199274163267, 0.2585890793143065, 0.31810376198285717, 0.3429633657874276, 0.3470978949042309, 0.32579984045551585]
Test losses per communication round for each client:  [[24.43543363 24.39403343 23.57477546 23.40509248 22.91490149 26.00387883
  24.06745982 21.13321865 20.2610184  23.25973105]
 [23.93870544 24.33129478 23.09125233 23.0749259  23.06463861 25.31402946
  25.17313242 24.04186022 22.99761999 24.82407546]
 [24.27229571 24.44847703 23.96674418 23.5164597  22.869748   23.14678884
  22.59383762 23.03290772 21.31020546 22.87335026]
 [23.65277576 21.79978585 20.79850662 20.26418304 18.55504608 21.36607563
  18.91912103 17.63399529 17.90419137 18.44988382]
 [22.39138293 21.74459124 20.3154304  19.81653631 17.52806473 21.09284329
  17.63355815 15.46009946 16.36137378 15.61348414]
 [25.66968799 25.27443719 26.1508491  28.26089525 23.82906818 31.08441257
  26.65995193 24.9850502  27.28089452 29.50631905]
 [24.53666592 24.87221479 25.37541056 26.2624228  23.483145   27.6089108
  24.4258163  23.08420801 23.44836783 24.10644221]
 [21.14546847 19.47162378 19.5458951  20.43458927 18.15772808 22.05585814
  19.35770702 17.14745665 18.31640899 18.99035633]
 [25.21552706 24.95153928 24.74704909 26.25228918 23.80691504 29.01675224
  26.59019423 25.26312375 26.06392074 26.07023084]
 [23.06798935 20.48197532 17.48205459 18.42392838 16.2393049  17.75727153
  14.82997    13.36707461 13.18361926 13.1563614 ]]
Test accuracies per communication round for each client:  [[0.13844947 0.14577069 0.15936724 0.16302785 0.19963394 0.12825206
  0.1864296  0.25362793 0.30226173 0.20551706]
 [0.14300518 0.05215889 0.05492228 0.08048359 0.09533679 0.0134715
  0.02279793 0.04075993 0.07288428 0.03937824]
 [0.11840745 0.05032747 0.08066184 0.19320924 0.17442261 0.18476387
  0.27611169 0.2885212  0.27714581 0.29489831]
 [0.20928181 0.22110464 0.20963473 0.28198341 0.31462855 0.16146109
  0.22498677 0.25092642 0.23928004 0.21086995]
 [0.15641447 0.13240132 0.20707237 0.27088816 0.35032895 0.24901316
  0.39950658 0.43256579 0.35032895 0.43223684]
 [0.0990099  0.12871287 0.10891089 0.13861386 0.2029703  0.12376238
  0.20792079 0.23267327 0.22772277 0.25742574]
 [0.15056231 0.11521689 0.10626578 0.0817076  0.21230204 0.00619692
  0.11636447 0.19715401 0.16548084 0.16915309]
 [0.60183416 0.63469622 0.58253726 0.58215514 0.55741307 0.53792511
  0.591517   0.61024073 0.60460451 0.58062667]
 [0.19101951 0.24696356 0.34339345 0.35958778 0.32388664 0.37467795
  0.37835848 0.37909459 0.40559441 0.38093485]
 [0.38812002 0.53423148 0.67299449 0.61530925 0.6592774  0.58089406
  0.64947949 0.66246173 0.66674832 0.61555419]]

Train losses per communication round:  [1.5330234350104692, 1.313672592317912, 1.1474699519247218, 1.017472607839289, 0.9147317148624348, 0.8419087457886214, 0.7821633430070808, 0.7089674152670796, 0.6591993224937496, 0.6105757558094544]
Test losses per communication round:  [22.793992042541504, 21.712878930568696, 21.55785291194916, 20.851997196674347, 20.472040379047392, 18.453178584575653, 21.25330970287323, 17.02267767190933, 18.29704732298851, 25.28181278705597]
Test weighted accuracies per communication round:  [0.26726540501080764, 0.2627310585790257, 0.21755357661082353, 0.2186534011473972, 0.21893572599705363, 0.33609877835488355, 0.21537879986797925, 0.41972621728514053, 0.2601501493083335, 0.16362196723537917]
Test losses per communication round for each client:  [[24.56877899 22.55592442 19.42938256 18.34938085 18.30976546 18.43186426
  16.85551143 15.75792646 15.68945038 22.43490338]
 [24.13174915 24.88752294 25.57943225 25.65395856 26.08578324 28.32557273
  27.81862545 25.02387953 26.01775837 31.17799115]
 [21.48594117 20.6760838  22.88059163 21.47854495 20.40084195 13.98010743
  21.07610393 16.86864305 20.89961207 20.76278949]
 [21.74244452 20.06657302 19.13646519 18.88317645 18.77656662 17.03337121
  16.58774912 16.00299346 17.88892984 16.43674493]
 [22.31867063 19.40191483 19.98558712 17.79347706 16.98630238 14.48812091
  22.19159555 15.00826538 15.91540492 23.48073602]
 [24.17542028 24.51550937 27.35678649 26.90242219 26.49538684 21.92897034
  23.74141788 17.98569977 23.6076088  31.84039378]
 [20.47316134 19.2287147  17.12197256 17.566903   17.52964997 15.3687011
  20.88617706 14.94319773 14.89488173 32.03922439]
 [22.29598951 20.50058699 16.55817354 15.80840397 14.99272156 14.83798409
  17.13708448 13.31128168  9.579871   21.23329401]
 [23.47399855 23.17241073 24.34933901 24.22531581 23.69558454 19.88163519
  22.31377494 17.24902713 20.46304333 28.07709336]
 [23.27376628 22.12354851 23.18079877 21.85838914 21.44780123 20.25545859
  23.92505717 18.07586253 18.0139128  25.33495736]]
Test accuracies per communication round for each client:  [[0.17501746 0.39594972 0.50698324 0.53046439 0.50872905 0.50017458
  0.51361732 0.62063547 0.55281075 0.31267458]
 [0.09488256 0.07559496 0.0678177  0.06983979 0.06921761 0.07279515
  0.0629958  0.09457147 0.07232851 0.04308602]
 [0.27527778 0.28027778 0.24083333 0.22527778 0.24833333 0.61472222
  0.16944444 0.4325     0.31916667 0.39472222]
 [0.59820958 0.51711427 0.22538178 0.28225382 0.288924   0.46392838
  0.49991223 0.49605055 0.16745656 0.57556609]
 [0.50632911 0.64812449 0.46428986 0.50296133 0.53536175 0.66206016
  0.44594124 0.67193125 0.42457322 0.38566949]
 [0.22949389 0.10645724 0.         0.0008726  0.004363   0.20680628
  0.08987784 0.44415358 0.03490401 0.0095986 ]
 [0.459      0.466      0.5        0.413      0.396      0.527
  0.232      0.579      0.528      0.033     ]
 [0.21434263 0.36573705 0.60756972 0.58844622 0.60756972 0.62629482
  0.37848606 0.67250996 0.76693227 0.14342629]
 [0.34412619 0.26006642 0.14072229 0.14549606 0.14964716 0.34163553
  0.22810295 0.48879203 0.15338315 0.14051474]
 [0.19566265 0.18730924 0.10345382 0.14088353 0.14329317 0.17076305
  0.05301205 0.4        0.33381526 0.06987952]]


Train losses per communication round:  [1.3620098904868378, 1.1337155610862837, 0.9619315769975284, 0.8238912461734434, 0.7251545067407393, 0.6474300642270421, 0.5859620059266093, 0.544395253805641, 0.5114675295302739, 0.4771778172784276]
Test losses per communication round:  [23.65874288082123, 22.217949283123016, 21.449257946014406, 20.58688876628876, 20.132939642667772, 19.46319979429245, 18.889280074834822, 18.608470886945724, 19.5683114528656, 18.447385081648825]
Test weighted accuracies per communication round:  [0.2978936395225139, 0.3554510905900468, 0.3888782416280646, 0.43446468205100575, 0.44888799103012716, 0.45777009958594883, 0.4755493366164903, 0.47484453613784017, 0.4155369923659008, 0.46900619510377506]
Test losses per communication round for each client:  [[26.51447606 25.91648722 25.64306998 25.41530991 25.52363467 25.34381604
  24.34265327 24.19086862 28.11511326 26.38976336]
 [25.29503942 24.29270768 23.59905839 22.5439775  21.6820935  20.93761253
  20.75683594 20.85771322 22.48416185 21.09135866]
 [24.9508698  24.61570096 23.93005848 23.87222719 23.83020592 23.69638944
  23.42584682 22.81856132 24.10586023 22.87448597]
 [25.19637322 24.77074575 24.7554996  24.88889146 25.13960648 25.15999889
  24.63623667 24.55433846 24.66338921 24.14962029]
 [17.64639401 14.07304299 12.43834436 11.06933975  9.93791503  9.159747
   8.42714232  9.26377648  7.16521657  6.98624405]
 [22.12932658 19.98844945 19.1809541  17.74015915 17.01968896 15.74025333
  15.95040572 13.77999794 14.64627385 12.74604225]
 [23.54260588 22.43581307 21.43566537 20.28848195 19.42022264 17.93702745
  17.9579407  17.12649739 17.0753932  17.06259918]
 [22.89901471 21.1538552  20.76703918 20.11286497 20.24381542 19.39744127
  18.80443835 18.86098874 20.30610728 19.21906793]
 [24.46140409 22.38660502 20.66834831 19.66815543 18.13050616 17.2941364
  16.04198444 15.87632525 16.19594812 14.93461251]
 [23.95192504 22.54608548 22.07454169 20.26948035 20.40170765 19.96557558
  18.54931653 18.75564146 20.92565095 19.02005661]]
Test accuracies per communication round for each client:  [[0.04943274 0.07860616 0.089141   0.10291734 0.11102107 0.11264182
  0.12722853 0.12722853 0.05834684 0.08508914]
 [0.04018572 0.0975024  0.20172911 0.29394813 0.33957733 0.34870317
  0.37944284 0.3310919  0.23791226 0.29939161]
 [0.10595201 0.09052664 0.06653163 0.07073855 0.06061078 0.06731069
  0.09037083 0.09379869 0.06154565 0.09488937]
 [0.06541381 0.06577521 0.06270329 0.06776292 0.06848572 0.07083484
  0.07932779 0.08221901 0.06794362 0.08709794]
 [0.84765935 0.85559376 0.86537953 0.87542978 0.87754562 0.88706691
  0.89076964 0.88653795 0.88944724 0.88971172]
 [0.62036185 0.66942656 0.70193192 0.72431769 0.74609016 0.74854339
  0.7457835  0.78769294 0.69375447 0.80680773]
 [0.22602321 0.26389737 0.37477092 0.42623702 0.47800855 0.53420892
  0.50381796 0.58766035 0.56459988 0.58246793]
 [0.34046223 0.34529148 0.35857192 0.35322525 0.3580545  0.36098655
  0.36081407 0.37116247 0.35184546 0.36098655]
 [0.23247329 0.40526453 0.4640344  0.565546   0.60972114 0.63161324
  0.66731822 0.64034402 0.58835027 0.63031014]
 [0.26064909 0.37322515 0.38742394 0.47870183 0.46348884 0.45233266
  0.51419878 0.46957404 0.35091278 0.47464503]]


Train losses per communication round:  [1.5531335364485714, 1.3100863680633559, 1.1557514380875151, 1.0328327655549576, 0.9644841706412848, 0.8930021685108009, 0.8355780168455034, 0.7786685345299528, 0.7612378833932891, 0.7033267266512734]
Test losses per communication round:  [22.989403879642488, 20.490299260616304, 19.095124745368956, 17.22931877076626, 16.898397785425185, 16.128042513132094, 16.339275777339935, 15.748994582891465, 14.696726459264756, 14.692475581169129]
Test weighted accuracies per communication round:  [0.15947633838561062, 0.41155084691525207, 0.45189670128804027, 0.5231204988675427, 0.5344214645725376, 0.5631070642465392, 0.559215310347452, 0.5769012594138127, 0.6035646892938069, 0.5982671250523421]
Test losses per communication round for each client:  [[23.38784432 19.63273156 18.08892488 16.40349388 16.12012064 15.66026568
  16.01646698 15.34910369 14.26880586 14.74537098]
 [23.8754065  20.77013171 18.7662195  17.45986474 16.37789333 15.27197015
  15.8876822  14.61180556 13.9382515  12.10878026]
 [24.37858367 20.12995768 17.87056732 16.51004899 16.6809324  15.85696077
  16.06067741 15.40744925 14.96276903 14.10848314]
 [23.63264155 19.48205507 16.26255417 14.08770692 12.21228474 12.38878348
  13.07954824 12.48487753 12.24164855 11.05744511]
 [23.72914481 21.06385756 19.22259462 17.21982169 16.59453356 14.44157875
  14.6096108  14.18507075 12.7877984  11.92891717]
 [25.35154438 25.27615261 26.19492745 24.46306634 24.90337014 25.68370891
  26.16726303 26.82855225 23.31506842 27.10112071]
 [23.93948936 23.94768822 23.9993459  21.90113676 21.15272129 22.03209472
  21.96880281 20.61408353 19.31720304 20.63228977]
 [20.78267503 18.34716082 18.20193446 17.47049785 17.76608348 16.60242045
  17.02797365 17.04665339 16.30496705 16.19990706]
 [21.86515892 20.94538581 18.18638968 15.46872997 13.87502372 13.05800033
  11.32534897 10.53291649  9.68533945  9.27428973]
 [18.95155025 15.30787158 14.15778947 11.30882058 13.30101454 10.28464189
  11.24938369 10.42943341 10.14541328  9.76815188]]
Test accuracies per communication round for each client:  [[0.06521739 0.36086957 0.40869565 0.48695652 0.47391304 0.5173913
  0.51304348 0.53478261 0.55652174 0.53478261]
 [0.09468945 0.27095749 0.33187657 0.42020924 0.45662826 0.52668521
  0.53357171 0.56230963 0.60045027 0.60336379]
 [0.09955268 0.40401637 0.44684496 0.51584658 0.52812411 0.53830779
  0.53954507 0.55248882 0.57475968 0.56505187]
 [0.21996272 0.48127436 0.55753262 0.62582613 0.65954923 0.64870361
  0.62311473 0.6387053  0.66158278 0.67056431]
 [0.16538593 0.31847678 0.36825478 0.453125   0.4755806  0.56062158
  0.56728142 0.59153005 0.63063525 0.62969604]
 [0.07602339 0.21832359 0.19103314 0.25925926 0.2417154  0.21637427
  0.22417154 0.21637427 0.26120858 0.18908382]
 [0.08450704 0.06338028 0.11267606 0.23239437 0.30985915 0.30985915
  0.3943662  0.40140845 0.43661972 0.41549296]
 [0.21658031 0.36062176 0.34352332 0.35492228 0.34507772 0.37564767
  0.34870466 0.34559585 0.37098446 0.38031088]
 [0.12684284 0.06675939 0.13435327 0.37468707 0.49874826 0.59554937
  0.70292072 0.76105702 0.79276773 0.77663421]
 [0.38475088 0.63026338 0.60459654 0.65114914 0.6473746  0.68939775
  0.68855897 0.7052508  0.73200805 0.7478611 ]]


# federated baseline non-IID 0.01 with no pre-training
Train losses per communication round:  [1.4912765818558174, 1.325710021298606, 1.2269752892960444, 1.1382890287046212, 1.0714300432451935, 1.0293282082762256, 0.9794226919137836, 0.9540042666323046, 0.9173856609952352, 0.9135762844416838]
Test losses per communication round:  [24.62762668132782, 24.292891788482667, 24.254913771152495, 23.493170976638794, 23.21373106241226, 22.91600831747055, 23.12302005290985, 22.84311532974243, 21.30061075091362, 20.729787409305573]
Test weighted accuracies per communication round:  [0.07310907402868345, 0.08064125362873766, 0.0911062867723247, 0.09086783036479053, 0.09145474575586675, 0.0916796546571738, 0.09188170339050361, 0.10380121837294441, 0.13377658724831015, 0.16220911334423996]
Test losses per communication round for each client:  [[28.35051656 26.53347039 26.96169233 27.05443192 26.41935205 25.82791328
  26.40945721 26.61938667 20.77170193 19.77025926]
 [23.22045434 26.278687   26.98692536 27.98805618 28.61899996 28.28259206
  28.09914255 25.58695078 22.71802008 21.38857114]
 [22.14915347 21.25479221 20.3914001  19.79566872 19.3690412  19.02446723
  18.51677239 17.74020684 16.1725291  15.51876318]
 [27.57582426 28.95020294 30.12577248 28.59276843 28.20287991 27.67999315
  28.67917323 28.23541903 29.06140471 28.67915583]
 [25.09969139 26.38172197 27.78927779 26.15949798 25.78179598 24.85640097
  26.00617504 25.22186756 25.61575675 25.09483981]
 [21.32465231 16.76011336 15.19316208 13.87950754 13.47418451 13.98963165
  14.19762361 14.0108273  11.90160626 11.86438084]
 [27.58170342 28.77500677 30.25793958 28.70636392 28.30519962 27.51460695
  28.76533866 28.14832497 28.59245944 27.67283773]
 [23.7581737  22.56877661 20.84735262 19.35511196 19.72981656 20.45585608
  19.05451798 21.83144355 18.52907789 17.65919411]
 [21.72484517 19.56712139 18.22064269 17.37233233 16.75516391 16.48079646
  16.51015377 15.94944918 13.90415978 13.51464093]
 [25.49125218 25.85902524 25.77497268 26.02797079 25.48087692 25.04782534
  24.99184608 25.08727741 25.73939157 26.13523126]]
Test accuracies per communication round for each client:  [[0.00000000e+00 7.51879699e-03 2.25563910e-02 2.25563910e-02
  4.51127820e-02 6.01503759e-02 4.51127820e-02 6.01503759e-02
  2.10526316e-01 2.33082707e-01]
 [1.80555556e-01 1.38888889e-02 5.55555556e-02 1.38888889e-02
  1.38888889e-02 1.38888889e-02 2.77777778e-02 5.55555556e-02
  2.50000000e-01 3.19444444e-01]
 [7.26958525e-02 1.62557604e-01 2.55299539e-01 3.09792627e-01
  3.42972350e-01 3.48502304e-01 3.53110599e-01 3.53456221e-01
  4.12903226e-01 4.62211982e-01]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  3.28839198e-04 3.28839198e-04 3.28839198e-04 9.86517593e-04
  1.64419599e-03 2.63071358e-02]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 1.66666667e-02
  0.00000000e+00 3.33333333e-02]
 [3.03568290e-01 6.81314818e-01 6.66666667e-01 6.49264663e-01
  6.22370657e-01 5.99929689e-01 5.88738501e-01 5.96355540e-01
  6.80611707e-01 7.01001934e-01]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 3.36927224e-04 0.00000000e+00 3.70619946e-03
  6.73854447e-04 2.79649596e-02]
 [1.30157851e-01 2.45638327e-01 2.57269454e-01 2.78593187e-01
  2.78454722e-01 3.34810302e-01 3.47410690e-01 3.09471061e-01
  4.14012739e-01 4.22459153e-01]
 [2.80735931e-01 3.06168831e-01 3.57034632e-01 3.93398268e-01
  4.08008658e-01 4.16125541e-01 4.11363636e-01 4.28571429e-01
  5.09956710e-01 5.17316017e-01]
 [1.81159420e-04 1.81159420e-04 9.05797101e-04 7.24637681e-04
  5.43478261e-04 3.26086957e-03 4.52898551e-03 1.21376812e-02
  7.97101449e-03 7.06521739e-03]]


Train losses per communication round:  [1.3795093170269528, 1.1525162749134892, 0.9848313617128716, 0.9351492811618426, 0.7601214455708616, 0.6588523754118223, 0.5782164141399181, 0.5238041478882604, 0.4842957065473564, 0.4509193183986203]
Test losses per communication round:  [25.188884127140046, 24.457218945026398, 24.718196761608123, 24.225055289268493, 23.55267697572708, 23.376289498806, 22.939043152332307, 23.318501937389374, 23.055428278446197, 22.35125043988228]
Test weighted accuracies per communication round:  [0.16929240830067308, 0.1792990315030601, 0.15103780047503426, 0.10966285938502227, 0.16976714485655062, 0.21486644543379835, 0.23427075684760792, 0.22098493082792672, 0.23948237617688797, 0.29651610343687257]
Test losses per communication round for each client:  [[21.21182215 21.32799709 22.12213421 24.05034804 23.94266987 24.61920309
  23.17570174 24.77622437 23.86896348 23.8597194 ]
 [27.56272888 26.76483679 26.31432462 26.00516891 25.71861243 25.69686866
  25.64777684 26.53248787 26.2923789  25.88152742]
 [23.24388552 22.81060386 22.34663737 21.51529372 22.26877153 23.48028445
  23.34670472 23.59749365 23.64421916 23.44972014]
 [26.91857743 25.03779912 24.86091876 25.49147844 25.5097518  25.3981297
  25.77718639 25.25418949 24.94592476 24.14122748]
 [24.48033142 25.18677258 25.65178514 24.57574582 23.14914417 22.32216191
  21.61654365 21.58130062 21.51270652 20.69326997]
 [29.05943799 25.51375604 26.96616101 24.48969197 22.33626699 21.49216008
  20.95720994 23.46469569 23.28530216 19.72217411]
 [26.99673867 26.8589654  28.46186185 28.28149462 28.24344325 28.47351623
  28.6912086  29.23425293 29.34639096 29.39504313]
 [24.72647834 25.33083582 25.7564671  24.75185466 23.06104422 22.36509299
  21.48548388 21.80108321 21.63867438 21.11546135]
 [24.14628315 22.091187   22.25378847 22.09728003 20.50480652 19.47459698
  19.30140662 18.05720186 17.94865096 17.16765571]
 [23.54255772 23.64943576 22.44788909 20.99219668 20.79225898 20.44088089
  19.39120913 18.88608968 18.07107151 18.08670568]]
Test accuracies per communication round for each client:  [[6.52173913e-01 6.60869565e-01 5.04347826e-01 1.91304348e-01
  1.56521739e-01 1.13043478e-01 2.00000000e-01 9.56521739e-02
  1.39130435e-01 2.08695652e-01]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 3.80445121e-03
  9.13068290e-03 1.65493628e-02 1.65493628e-02 3.23378353e-03
  9.13068290e-03 1.50275823e-02]
 [3.93395879e-01 4.86203091e-01 4.69554820e-01 4.57873436e-01
  3.83186166e-01 2.66648271e-01 1.92696836e-01 1.56456954e-01
  1.39072848e-01 1.75036792e-01]
 [1.64663264e-04 3.29326527e-04 4.93989791e-04 4.93989791e-04
  6.58653055e-04 3.29326527e-04 1.48196937e-03 9.87979582e-04
  2.60167957e-02 8.54602338e-02]
 [8.62068966e-03 1.43678161e-02 5.74712644e-03 7.75862069e-02
  2.44252874e-01 3.73563218e-01 3.41954023e-01 3.85057471e-01
  3.87931034e-01 4.56896552e-01]
 [2.24466891e-03 6.17283951e-02 5.61167228e-02 1.18967452e-01
  3.01907969e-01 3.25476992e-01 4.01795735e-01 2.46913580e-01
  2.31200898e-01 3.49046016e-01]
 [0.00000000e+00 4.09920066e-04 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [1.33393624e-02 1.04001809e-02 4.74790866e-03 8.54623559e-02
  2.29256161e-01 3.59484513e-01 3.59484513e-01 3.68980330e-01
  3.86163238e-01 4.44042505e-01]
 [4.08745247e-03 1.90019011e-01 1.61596958e-01 1.22053232e-01
  2.81463878e-01 4.03041825e-01 3.84505703e-01 4.66825095e-01
  4.46768061e-01 4.92870722e-01]
 [3.91734137e-01 2.82244398e-01 3.55582753e-01 3.66597628e-01
  4.09903973e-01 4.69026549e-01 5.63264922e-01 4.90962154e-01
  5.44247788e-01 6.15514969e-01]]


Train losses per communication round:  [1.280741516436353, 1.0792704036471397, 0.9349003636131297, 0.8274901272629268, 0.7427256250804976, 0.6890003234106917, 0.635027988690282, 0.6030438621098551, 0.5850233797503195, 0.5610709922232385]
Test losses per communication round:  [24.20116444826126, 22.954607558250427, 22.532166767120362, 22.119925367832185, 22.26535748243332, 22.411047917604446, 22.118591499328613, 23.771653091907503, 22.931830680370332, 23.23902930021286]
Test weighted accuracies per communication round:  [0.13909222644200406, 0.1976254029750667, 0.1918919907018582, 0.200093629763007, 0.16946775435767905, 0.16935938566067626, 0.20214078997464824, 0.1389631156828707, 0.19151415752155604, 0.16676256003371684]
Test losses per communication round for each client:  [[25.65547895 22.21187603 21.50067103 20.64434636 20.77194774 21.57634008
  19.52096462 22.23358285 19.06522965 20.5556618 ]
 [25.8792572  22.28048539 21.76638436 20.86674869 21.07823908 21.55435193
  19.8527478  22.62016904 19.15124142 20.94658303]
 [25.52015185 25.03186798 24.99403286 24.63694859 24.7152307  24.52324128
  24.85681629 25.95471478 25.13950229 25.85615468]
 [24.27943301 25.38582158 25.09012961 25.04784036 25.47849679 25.38959193
  25.37488437 26.49650216 26.43889189 26.47386575]
 [24.9504807  24.94883156 24.80863285 24.1311655  24.16526723 23.74135089
  24.31507707 26.02162766 24.28925943 24.7814548 ]
 [21.0527457  17.30838609 16.52126813 16.28346574 17.12742686 18.16443646
  17.17756736 19.33151293 18.62582159 19.7649821 ]
 [24.04640341 25.60022211 25.35290432 25.25888038 25.49451756 25.37901258
  25.67750621 26.72990942 26.47264838 26.70187354]
 [23.63279819 21.08582389 20.72686982 19.83977854 19.47633111 19.47250003
  21.06510985 21.91403306 24.89128137 20.95923448]
 [23.94843483 23.11447191 22.21016967 21.91767085 21.19545555 21.04473352
  19.92560828 21.27901816 20.17589593 21.30110967]
 [23.04646063 22.57828903 22.35060501 22.57240868 23.15066218 23.26492047
  23.41963315 25.13546085 25.06853485 25.04937315]]
Test accuracies per communication round for each client:  [[1.28205128e-02 1.47435897e-01 1.31410256e-01 1.92307692e-01
  1.08974359e-01 1.02564103e-01 1.98717949e-01 6.73076923e-02
  2.14743590e-01 1.44230769e-01]
 [1.22484689e-02 1.32983377e-01 1.15485564e-01 1.39107612e-01
  9.97375328e-02 9.01137358e-02 2.05599300e-01 5.94925634e-02
  2.28346457e-01 1.67104112e-01]
 [3.65559473e-02 7.42252737e-03 5.56689553e-03 1.98552607e-02
  3.17313045e-02 6.21636667e-02 5.47411394e-02 6.29059195e-02
  9.24104658e-02 9.05548339e-02]
 [6.36550308e-02 1.23203285e-02 8.21355236e-03 8.21355236e-03
  4.10677618e-03 2.25872690e-02 3.08008214e-02 2.46406571e-02
  3.49075975e-02 4.72279261e-02]
 [6.75545262e-03 3.86025864e-03 2.89519398e-03 5.98340089e-03
  1.73711639e-02 6.83265779e-02 8.72418452e-02 1.12140513e-01
  1.39548350e-01 1.88380622e-01]
 [5.74605938e-01 7.60758147e-01 7.27202398e-01 7.00222416e-01
  5.96267286e-01 5.10395513e-01 5.60003868e-01 2.99487477e-01
  2.92138091e-01 2.02398221e-01]
 [6.72105672e-02 6.41025641e-03 2.91375291e-03 2.71950272e-03
  2.33100233e-03 2.52525253e-03 2.71950272e-03 1.74825175e-03
  3.88500389e-04 1.16550117e-03]
 [3.09049516e-01 5.26275849e-01 5.47903624e-01 5.45247581e-01
  5.44868146e-01 5.44298994e-01 5.40884083e-01 5.35856574e-01
  5.34623411e-01 5.38702334e-01]
 [2.09717915e-01 1.85201595e-01 1.74124945e-01 1.37055088e-01
  1.05597401e-01 1.12538768e-01 1.47984050e-01 1.05745089e-01
  1.99232019e-01 1.76192586e-01]
 [2.40506329e-02 7.76754891e-02 8.04372842e-02 8.68814730e-02
  6.20253165e-02 6.16800921e-02 1.13463751e-01 3.78596087e-02
  1.15420023e-01 8.66513234e-02]]


Train losses per communication round:  [1.2148142083928204, 0.9041560523412524, 0.7320131117276304, 0.630410739923766, 0.5726858667272272, 0.5275880599931123, 0.5004157486284007, 0.4930500994136152, 0.4776355445150373, 0.4592928731255725]
Test losses per communication round:  [24.51427569389343, 23.570989537239075, 23.448844456672667, 23.101749432086944, 22.85395427942276, 23.00005304813385, 22.92969516515732, 22.819428753852844, 23.31787297129631, 22.842028975486755]
Test weighted accuracies per communication round:  [0.24472138763570042, 0.28471263334799246, 0.2585988234144594, 0.26352039911965597, 0.2545838277705889, 0.24196145038313574, 0.24741114398000935, 0.24578066150719557, 0.22919333814308276, 0.2480148851495025]
Test losses per communication round for each client:  [[24.0493387  22.49357796 21.45331824 19.46475351 17.99610996 16.54248869
  15.85061765 14.59490919 14.97688538 13.13482988]
 [23.91362667 21.65154278 21.2017405  18.89207554 17.37982523 16.13814223
  15.22833836 13.72315919 14.0975517  12.72518957]
 [23.12254322 19.65806806 20.05413055 19.57663679 19.73989689 21.18715894
  21.0610435  20.50359416 23.21511281 22.81677449]
 [21.86926568 21.17733824 21.47393417 22.22803688 22.33112741 23.49008203
  23.62031364 24.31107593 24.32324779 25.10299325]
 [26.65945196 25.75671911 25.52897263 25.6619873  25.5615654  25.97054982
  26.26073146 26.35126448 27.17940307 26.62466693]
 [25.08758211 25.04554009 25.11510825 25.90392733 26.15299869 26.72203016
  27.57391763 27.49194551 28.09999371 27.48701239]
 [25.66361713 25.86185765 26.09569931 26.51431108 27.00326824 27.31126451
  27.59275007 27.86677933 27.93007255 27.9872613 ]
 [26.33021617 27.00303841 27.07024145 27.17661047 27.11801457 26.96696162
  26.92562008 27.36995196 27.28586102 27.2255981 ]
 [26.18813181 27.36173487 28.0047338  28.18279552 28.10909033 28.43244767
  28.47227001 29.04571748 29.34622741 28.74132991]
 [22.25898349 19.7004782  18.49056566 17.4163599  17.14764607 17.2394048
  16.71134925 16.93589032 16.72437429 16.57463396]]
Test accuracies per communication round for each client:  [[4.03846154e-01 4.23076923e-01 4.03846154e-01 5.19230769e-01
  5.76923077e-01 6.15384615e-01 6.34615385e-01 7.30769231e-01
  6.53846154e-01 8.26923077e-01]
 [4.87781036e-01 5.22319974e-01 5.14825676e-01 5.79341805e-01
  6.20723363e-01 6.41902900e-01 6.78396872e-01 7.49429782e-01
  6.52003910e-01 7.91137178e-01]
 [6.53846154e-01 7.17948718e-01 6.28205128e-01 6.02564103e-01
  5.12820513e-01 4.61538462e-01 4.61538462e-01 4.10256410e-01
  3.97435897e-01 4.10256410e-01]
 [2.05318491e-01 4.17263009e-01 3.08331125e-01 3.38192420e-01
  4.29631593e-01 3.91200636e-01 4.36257620e-01 4.52866861e-01
  4.43678770e-01 4.07279795e-01]
 [3.35758254e-03 1.86532363e-04 2.23838836e-03 5.40943854e-03
  7.64782690e-03 7.08822981e-03 4.10371199e-03 5.78250326e-03
  2.79798545e-03 4.47677672e-03]
 [2.04043076e-02 2.73946722e-02 5.15775553e-02 5.76232760e-02
  3.09843189e-02 4.93104100e-02 3.81636123e-02 4.77989798e-02
  4.77989798e-02 7.16040053e-02]
 [2.91043247e-02 1.20926419e-02 2.04960033e-03 1.02480016e-03
  1.02480016e-03 2.66448043e-03 8.19840131e-04 1.63968026e-03
  3.07440049e-03 1.43472023e-03]
 [1.67785235e-03 1.11856823e-03 2.42356450e-03 2.05070843e-03
  9.32140194e-04 1.11856823e-03 9.32140194e-04 9.32140194e-04
  3.72856078e-04 1.86428039e-04]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.87476565e-04
  1.87476565e-04 1.87476565e-04 1.87476565e-04 1.87476565e-04
  1.87476565e-04 1.87476565e-04]
 [5.78832227e-01 6.49290887e-01 6.85048280e-01 6.77127339e-01
  6.57966204e-01 6.20926373e-01 6.10365118e-01 5.90298733e-01
  5.45337960e-01 5.98823174e-01]]


Train losses per communication round:  [1.1794700902045456, 0.9384418294735264, 0.73901942976803, 0.6116775427083104, 0.5277679941357658, 0.4673671253001198, 0.43263607567525497, 0.4374212755953888, 0.37476212382705376, 0.35026754063447474]
Test losses per communication round:  [24.174764025211335, 23.162766349315643, 22.54772926568985, 22.29463083744049, 22.891915321350098, 21.792169737815858, 22.627668619155884, 22.17416281104088, 21.130489701032637, 22.08997756242752]
Test weighted accuracies per communication round:  [0.1631995487864492, 0.2417676823202458, 0.29934858690894317, 0.32053406188835376, 0.18283433203738295, 0.35119276759038226, 0.26074497133500657, 0.30097992872190665, 0.3494571424888907, 0.25255365445750066]
Test losses per communication round for each client:  [[22.26000237 21.9444437  21.00805092 20.59379435 18.90349329 20.97840858
  23.33592987 22.60475755 20.66215277 20.95163488]
 [24.88022304 24.69762111 24.74164963 25.31654119 27.11397934 26.54601789
  28.23492455 26.69288588 26.99574494 27.7744689 ]
 [25.21427941 22.9820199  20.38851082 18.76408279 22.81148553 18.92969191
  26.48736191 19.88296151 20.41555905 18.40645182]
 [25.987257   26.28285789 26.92550611 26.18954754 26.08874393 26.66055393
  29.13452148 26.96693945 27.19244289 27.74079204]
 [24.71463466 23.307693   22.46279311 23.72258639 26.356848   23.30080557
  18.77828968 24.89712405 22.69379747 25.66665435]
 [22.36543131 23.16744757 21.52258468 21.41894746 18.47644222 19.07000744
  23.46198916 20.1384995  17.45543897 15.80321801]
 [25.43151522 23.86364198 22.61761117 23.47225833 23.64391375 20.28380454
  13.87516189 20.08403671 16.8353498  22.16669846]
 [25.24182177 25.43462896 25.70863867 26.13351989 28.18129683 27.10289192
  28.74025679 28.07177448 27.89098454 29.09014082]
 [19.19447052 15.7824055  16.19394255 15.21498632 14.1721251  14.05299854
   9.11253083 10.18328303 10.64069432 11.46954632]
 [26.45800495 24.16490388 23.908005   22.12004411 23.17082524 20.99651706
  25.11572003 22.21936595 20.52273226 21.83017004]]
Test accuracies per communication round for each client:  [[4.05874499e-02 1.37249666e-01 3.52069426e-01 3.04539386e-01
  4.79572764e-01 2.09746328e-01 1.45527370e-02 1.26435247e-01
  1.38985314e-01 1.37783712e-01]
 [3.51569844e-02 1.15435232e-01 9.66347058e-02 3.57210002e-03
  0.00000000e+00 5.64015792e-04 3.76010528e-04 7.52021057e-04
  1.88005264e-04 1.88005264e-04]
 [1.08349267e-02 2.76290631e-01 6.45952836e-01 8.23454430e-01
  8.38113448e-02 6.95028681e-01 2.96367113e-02 4.66857871e-01
  4.51561504e-01 3.72211600e-01]
 [1.80897250e-04 5.42691751e-04 3.61794501e-04 1.80897250e-04
  1.13965268e-02 9.04486252e-04 9.04486252e-04 9.04486252e-04
  9.04486252e-04 1.08538350e-03]
 [4.70067411e-01 4.84455177e-01 4.50548345e-01 3.90884395e-01
  3.90985009e-01 4.19156857e-01 5.24901902e-01 4.74293188e-01
  4.59502968e-01 4.16339672e-01]
 [1.06285714e-01 1.36095238e-01 1.56476190e-01 1.20666667e-01
  5.02476190e-01 3.33428571e-01 4.20000000e-01 2.69714286e-01
  5.05619048e-01 6.68857143e-01]
 [1.12903226e-01 2.74193548e-01 2.58064516e-01 1.82795699e-01
  1.82795699e-01 4.94623656e-01 8.06451613e-01 5.00000000e-01
  7.41935484e-01 3.65591398e-01]
 [7.03689616e-03 1.14111830e-03 4.56447318e-03 1.80677064e-02
  9.12894637e-03 2.68162800e-02 1.42639787e-02 1.12209966e-02
  2.70064663e-02 2.47242297e-03]
 [9.78060863e-01 9.76645435e-01 8.75442321e-01 8.06086341e-01
  8.36518047e-01 8.57041755e-01 9.58244869e-01 9.70276008e-01
  9.53290870e-01 8.69780609e-01]
 [0.00000000e+00 8.22336967e-03 5.87110346e-02 2.63147829e-01
  1.25836680e-01 3.45572767e-01 1.51462995e-01 1.41135972e-01
  3.48250143e-01 3.36584433e-02]]
